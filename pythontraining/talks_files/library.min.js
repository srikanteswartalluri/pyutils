(function(){var a;a=(function(){function b(){this.options_index=0;this.parsed=[]}b.prototype.add_node=function(d){if(d.nodeName==="OPTGROUP"){return this.add_group(d)}else{return this.add_option(d)}};b.prototype.add_group=function(k){var j,f,h,e,g,d;j=this.parsed.length;this.parsed.push({array_index:j,group:true,label:k.label,children:0,disabled:k.disabled});g=k.childNodes;d=[];for(h=0,e=g.length;h<e;h++){f=g[h];d.push(this.add_option(f,j,k.disabled))}return d};b.prototype.add_option=function(e,f,d){if(e.nodeName==="OPTION"){if(e.text!==""){if(f!=null){this.parsed[f].children+=1}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:d===true?d:e.disabled,group_array_index:f,classes:e.className,style:e.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true})}return this.options_index+=1}};return b})();a.select_to_array=function(b){var h,g,f,d,e;g=new a();e=b.childNodes;for(f=0,d=e.length;f<d;f++){h=e[f];g.add_node(h)}return g.parsed};this.SelectParser=a}).call(this);(function(){var b,a;a=this;b=(function(){function d(e,f){this.form_field=e;this.options=f!=null?f:{};this.set_default_values();this.is_multiple=this.form_field.multiple;this.default_text_default=this.is_multiple?"Select Some Options":"Select an Option";this.setup();this.set_up_html();this.register_observers();this.finish_setup()}d.prototype.set_default_values=function(){var e=this;this.click_test_action=function(f){return e.test_active_click(f)};this.activate_action=function(f){return e.activate_field(f)};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.result_single_selected=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.search_contains=this.options.search_contains||false;this.choices=0;return this.results_none_found=this.options.no_results_text||"No results match"};d.prototype.mouse_enter=function(){return this.mouse_on_container=true};d.prototype.mouse_leave=function(){return this.mouse_on_container=false};d.prototype.input_focus=function(e){var f=this;if(!this.active_field){return setTimeout((function(){return f.container_mousedown()}),50)}};d.prototype.input_blur=function(e){var f=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout((function(){return f.blur_test()}),100)}};d.prototype.result_add_option=function(g){var e,f;if(!g.disabled){g.dom_id=this.container_id+"_o_"+g.array_index;e=g.selected&&this.is_multiple?[]:["active-result"];if(g.selected){e.push("result-selected")}if(g.group_array_index!=null){e.push("group-option")}if(g.classes!==""){e.push(g.classes)}f=g.style.cssText!==""?' style="'+g.style+'"':"";return'<li id="'+g.dom_id+'" class="'+e.join(" ")+'"'+f+">"+g.html+"</li>"}else{return""}};d.prototype.results_update_field=function(){this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};d.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};d.prototype.results_search=function(e){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};d.prototype.keyup_checker=function(e){var g,f;g=(f=e.which)!=null?f:e.keyCode;this.search_field_scale();switch(g){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0){return this.keydown_backstroke()}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}}break;case 13:e.preventDefault();if(this.results_showing){return this.result_select(e)}break;case 27:if(this.results_showing){this.results_hide()}return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};d.prototype.generate_field_id=function(){var e;e=this.generate_random_id();this.form_field.id=e;return e};d.prototype.generate_random_char=function(){var g,f,e;g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ";e=Math.floor(Math.random()*g.length);return f=g.substring(e,e+1)};return d})();a.AbstractChosen=b}).call(this);(function(){var f,g,e,a,b=Object.prototype.hasOwnProperty,d=function(l,j){for(var h in j){if(b.call(j,h)){l[h]=j[h]}}function k(){this.constructor=l}k.prototype=j.prototype;l.prototype=new k;l.__super__=j.prototype;return l};a=this;f=jQuery;f.fn.extend({chosen:function(h){if(f.browser.msie&&(f.browser.version==="6.0")){return this}return f(this).each(function(j){if(!(f(this)).hasClass("chzn-done")){return new g(this,h)}})}});g=(function(h){d(j,h);function j(){j.__super__.constructor.apply(this,arguments)}j.prototype.setup=function(){this.form_field_jq=f(this.form_field);return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};j.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")};j.prototype.set_up_html=function(){var n,m,l,k;this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id();this.container_id+="_chzn";this.f_width=this.form_field_jq.outerWidth();this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default;n=f("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"});if(this.is_multiple){n.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>')}else{n.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>')}this.form_field_jq.hide().after(n);this.container=f("#"+this.container_id);this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single"));this.dropdown=this.container.find("div.chzn-drop").first();m=this.container.height();l=this.f_width-e(this.dropdown);this.dropdown.css({width:l+"px",top:m+"px"});this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chzn-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chzn-search").first();this.selected_item=this.container.find(".chzn-single").first();k=l-e(this.search_container)-e(this.search_field);this.search_field.css({width:k+"px"})}this.results_build();this.set_tab_index();return this.form_field_jq.trigger("liszt:ready",{chosen:this})};j.prototype.register_observers=function(){var k=this;this.container.mousedown(function(l){return k.container_mousedown(l)});this.container.mouseup(function(l){return k.container_mouseup(l)});this.container.mouseenter(function(l){return k.mouse_enter(l)});this.container.mouseleave(function(l){return k.mouse_leave(l)});this.search_results.mouseup(function(l){return k.search_results_mouseup(l)});this.search_results.mouseover(function(l){return k.search_results_mouseover(l)});this.search_results.mouseout(function(l){return k.search_results_mouseout(l)});this.form_field_jq.bind("liszt:updated",function(l){return k.results_update_field(l)});this.search_field.blur(function(l){return k.input_blur(l)});this.search_field.keyup(function(l){return k.keyup_checker(l)});this.search_field.keydown(function(l){return k.keydown_checker(l)});if(this.is_multiple){this.search_choices.click(function(l){return k.choices_click(l)});return this.search_field.focus(function(l){return k.input_focus(l)})}else{return this.container.click(function(l){return l.preventDefault()})}};j.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chzn-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus",this.activate_action)}return this.close_field()}else{this.container.removeClass("chzn-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus",this.activate_action)}}};j.prototype.container_mousedown=function(k){var l;if(!this.is_disabled){l=k!=null?(f(k.target)).hasClass("search-choice-close"):false;if(k&&k.type==="mousedown"&&!this.results_showing){k.stopPropagation()}if(!this.pending_destroy_click&&!l){if(!this.active_field){if(this.is_multiple){this.search_field.val("")}f(document).click(this.click_test_action);this.results_show()}else{if(!this.is_multiple&&k&&((f(k.target)[0]===this.selected_item[0])||f(k.target).parents("a.chzn-single").length)){k.preventDefault();this.results_toggle()}}return this.activate_field()}else{return this.pending_destroy_click=false}}};j.prototype.container_mouseup=function(k){if(k.target.nodeName==="ABBR"){return this.results_reset(k)}};j.prototype.blur_test=function(k){if(!this.active_field&&this.container.hasClass("chzn-container-active")){return this.close_field()}};j.prototype.close_field=function(){f(document).unbind("click",this.click_test_action);if(!this.is_multiple){this.selected_item.attr("tabindex",this.search_field.attr("tabindex"));this.search_field.attr("tabindex",-1)}this.active_field=false;this.results_hide();this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};j.prototype.activate_field=function(){if(!this.is_multiple&&!this.active_field){this.search_field.attr("tabindex",this.selected_item.attr("tabindex"));this.selected_item.attr("tabindex",-1)}this.container.addClass("chzn-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};j.prototype.test_active_click=function(k){if(f(k.target).parents("#"+this.container_id).length){return this.active_field=true}else{return this.close_field()}};j.prototype.results_build=function(){var l,o,n,k,m;this.parsing=true;this.results_data=a.SelectParser.select_to_array(this.form_field);if(this.is_multiple&&this.choices>0){this.search_choices.find("li.search-choice").remove();this.choices=0}else{if(!this.is_multiple){this.selected_item.find("span").text(this.default_text);if(this.form_field.options.length<=this.disable_search_threshold){this.container.addClass("chzn-container-single-nosearch")}else{this.container.removeClass("chzn-container-single-nosearch")}}}l="";m=this.results_data;for(n=0,k=m.length;n<k;n++){o=m[n];if(o.group){l+=this.result_add_group(o)}else{if(!o.empty){l+=this.result_add_option(o);if(o.selected&&this.is_multiple){this.choice_build(o)}else{if(o.selected&&!this.is_multiple){this.selected_item.removeClass("chzn-default").find("span").text(o.text);if(this.allow_single_deselect){this.single_deselect_control_build()}}}}}}this.search_field_disabled();this.show_search_field_default();this.search_field_scale();this.search_results.html(l);return this.parsing=false};j.prototype.result_add_group=function(k){if(!k.disabled){k.dom_id=this.container_id+"_g_"+k.array_index;return'<li id="'+k.dom_id+'" class="group-result">'+f("<div />").text(k.label).html()+"</li>"}else{return""}};j.prototype.result_do_highlight=function(l){var q,o,m,n,k;if(l.length){this.result_clear_highlight();this.result_highlight=l;this.result_highlight.addClass("highlighted");m=parseInt(this.search_results.css("maxHeight"),10);k=this.search_results.scrollTop();n=m+k;o=this.result_highlight.position().top+this.search_results.scrollTop();q=o+this.result_highlight.outerHeight();if(q>=n){return this.search_results.scrollTop((q-m)>0?q-m:0)}else{if(o<k){return this.search_results.scrollTop(o)}}}};j.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted")}return this.result_highlight=null};j.prototype.results_show=function(){var k;if(!this.is_multiple){this.selected_item.addClass("chzn-single-with-drop");if(this.result_single_selected){this.result_do_highlight(this.result_single_selected)}}k=this.is_multiple?this.container.height():this.container.height()-1;this.dropdown.css({top:k+"px",left:0});this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};j.prototype.results_hide=function(){if(!this.is_multiple){this.selected_item.removeClass("chzn-single-with-drop")}this.result_clear_highlight();this.dropdown.css({left:"-9000px"});return this.results_showing=false};j.prototype.set_tab_index=function(l){var k;if(this.form_field_jq.attr("tabindex")){k=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);if(this.is_multiple){return this.search_field.attr("tabindex",k)}else{this.selected_item.attr("tabindex",k);return this.search_field.attr("tabindex",-1)}}};j.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};j.prototype.search_results_mouseup=function(k){var l;l=f(k.target).hasClass("active-result")?f(k.target):f(k.target).parents(".active-result").first();if(l.length){this.result_highlight=l;return this.result_select(k)}};j.prototype.search_results_mouseover=function(k){var l;l=f(k.target).hasClass("active-result")?f(k.target):f(k.target).parents(".active-result").first();if(l){return this.result_do_highlight(l)}};j.prototype.search_results_mouseout=function(k){if(f(k.target).hasClass("active-result"||f(k.target).parents(".active-result").first())){return this.result_clear_highlight()}};j.prototype.choices_click=function(k){k.preventDefault();if(this.active_field&&!(f(k.target).hasClass("search-choice"||f(k.target).parents(".search-choice").first))&&!this.results_showing){return this.results_show()}};j.prototype.choice_build=function(m){var k,l,n=this;k=this.container_id+"_c_"+m.array_index;this.choices+=1;this.search_container.before('<li class="search-choice" id="'+k+'"><span>'+m.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+m.array_index+'"></a></li>');l=f("#"+k).find("a").first();return l.click(function(o){return n.choice_destroy_link_click(o)})};j.prototype.choice_destroy_link_click=function(k){k.preventDefault();if(!this.is_disabled){this.pending_destroy_click=true;return this.choice_destroy(f(k.target))}else{return k.stopPropagation}};j.prototype.choice_destroy=function(k){this.choices-=1;this.show_search_field_default();if(this.is_multiple&&this.choices>0&&this.search_field.val().length<1){this.results_hide()}this.result_deselect(k.attr("rel"));return k.parents("li").first().remove()};j.prototype.results_reset=function(k){this.form_field.options[0].selected=true;this.selected_item.find("span").text(this.default_text);if(!this.is_multiple){this.selected_item.addClass("chzn-default")}this.show_search_field_default();f(k.target).remove();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide()}};j.prototype.result_select=function(l){var o,n,m,k;if(this.result_highlight){o=this.result_highlight;n=o.attr("id");this.result_clear_highlight();if(this.is_multiple){this.result_deactivate(o)}else{this.search_results.find(".result-selected").removeClass("result-selected");this.result_single_selected=o;this.selected_item.removeClass("chzn-default")}o.addClass("result-selected");k=n.substr(n.lastIndexOf("_")+1);m=this.results_data[k];m.selected=true;this.form_field.options[m.options_index].selected=true;if(this.is_multiple){this.choice_build(m)}else{this.selected_item.find("span").first().text(m.text);if(this.allow_single_deselect){this.single_deselect_control_build()}}if(!(l.metaKey&&this.is_multiple)){this.results_hide()}this.search_field.val("");this.form_field_jq.trigger("change");return this.search_field_scale()}};j.prototype.result_activate=function(k){return k.addClass("active-result")};j.prototype.result_deactivate=function(k){return k.removeClass("active-result")};j.prototype.result_deselect=function(m){var k,l;l=this.results_data[m];l.selected=false;this.form_field.options[l.options_index].selected=false;k=f("#"+this.container_id+"_o_"+m);k.removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change");return this.search_field_scale()};j.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1){return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}};j.prototype.winnow_results=function(){var r,u,y,x,m,v,q,B,w,A,z,s,n,l,k,C,D,o;this.no_results_clear();w=0;A=this.search_field.val()===this.default_text?"":f("<div/>").text(f.trim(this.search_field.val())).html();v=this.search_contains?"":"^";m=new RegExp(v+A.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");n=new RegExp(A.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");o=this.results_data;for(l=0,C=o.length;l<C;l++){u=o[l];if(!u.disabled&&!u.empty){if(u.group){f("#"+u.dom_id).css("display","none")}else{if(!(this.is_multiple&&u.selected)){r=false;B=u.dom_id;q=f("#"+B);if(m.test(u.html)){r=true;w+=1}else{if(u.html.indexOf(" ")>=0||u.html.indexOf("[")===0){x=u.html.replace(/\[|\]/g,"").split(" ");if(x.length){for(k=0,D=x.length;k<D;k++){y=x[k];if(m.test(y)){r=true;w+=1}}}}}if(r){if(A.length){z=u.html.search(n);s=u.html.substr(0,z+A.length)+"</em>"+u.html.substr(z+A.length);s=s.substr(0,z)+"<em>"+s.substr(z)}else{s=u.html}q.html(s);this.result_activate(q);if(u.group_array_index!=null){f("#"+this.results_data[u.group_array_index].dom_id).css("display","list-item")}}else{if(this.result_highlight&&B===this.result_highlight.attr("id")){this.result_clear_highlight()}this.result_deactivate(q)}}}}}if(w<1&&A.length){return this.no_results(A)}else{return this.winnow_results_set_highlight()}};j.prototype.winnow_results_clear=function(){var k,n,o,m,l;this.search_field.val("");n=this.search_results.find("li");l=[];for(o=0,m=n.length;o<m;o++){k=n[o];k=f(k);if(k.hasClass("group-result")){l.push(k.css("display","auto"))}else{if(!this.is_multiple||!k.hasClass("result-selected")){l.push(this.result_activate(k))}else{l.push(void 0)}}}return l};j.prototype.winnow_results_set_highlight=function(){var k,l;if(!this.result_highlight){l=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];k=l.length?l.first():this.search_results.find(".active-result").first();if(k!=null){return this.result_do_highlight(k)}}};j.prototype.no_results=function(k){var l;l=f('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');l.find("span").first().html(k);return this.search_results.append(l)};j.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};j.prototype.keydown_arrow=function(){var l,k;if(!this.result_highlight){l=this.search_results.find("li.active-result").first();if(l){this.result_do_highlight(f(l))}}else{if(this.results_showing){k=this.result_highlight.nextAll("li.active-result").first();if(k){this.result_do_highlight(k)}}}if(!this.results_showing){return this.results_show()}};j.prototype.keyup_arrow=function(){var k;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else{if(this.result_highlight){k=this.result_highlight.prevAll("li.active-result");if(k.length){return this.result_do_highlight(k.first())}else{if(this.choices>0){this.results_hide()}return this.result_clear_highlight()}}}};j.prototype.keydown_backstroke=function(){if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{this.pending_backstroke=this.search_container.siblings("li.search-choice").last();return this.pending_backstroke.addClass("search-choice-focus")}};j.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}return this.pending_backstroke=null};j.prototype.keydown_checker=function(k){var m,l;m=(l=k.which)!=null?l:k.keyCode;this.search_field_scale();if(m!==8&&this.pending_backstroke){this.clear_backstroke()}switch(m){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple){this.result_select(k)}this.mouse_on_container=false;break;case 13:k.preventDefault();break;case 38:k.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow();break}};j.prototype.search_field_scale=function(){var u,k,n,l,r,s,q,m,o;if(this.is_multiple){n=0;q=0;r="position:absolute; left: -1000px; top: -1000px; display:none;";s=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(m=0,o=s.length;m<o;m++){l=s[m];r+=l+":"+this.search_field.css(l)+";"}k=f("<div />",{style:r});k.text(this.search_field.val());f("body").append(k);q=k.width()+25;k.remove();if(q>this.f_width-10){q=this.f_width-10}this.search_field.css({width:q+"px"});u=this.container.height();return this.dropdown.css({top:u+"px"})}};j.prototype.generate_random_id=function(){var k;k="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while(f("#"+k).length>0){k+=this.generate_random_char()}return k};return j})(AbstractChosen);e=function(h){var j;return j=h.outerWidth()-h.width()};a.get_side_border_padding=e}).call(this);(function(e){e.fn.jCarouselLite=function(f){f=e.extend({btnPrev:null,btnNext:null,btnGo:null,mouseWheel:false,auto:null,speed:200,easing:null,vertical:false,circular:true,visible:3,start:0,scroll:1,beforeStart:null,afterEnd:null},f||{});this.pause=function(g){f.pause=g};return this.each(function(){var q=false,n=f.vertical?"top":"left",h=f.vertical?"height":"width";var g=e(this),s=g.find("ul:first"),k=s.children("li"),y=k.size(),x=f.visible;var A=false;g.hover(function(){A=true},function(){A=false});if(f.circular){s.prepend(k.slice(y-x-1+1).clone()).append(k.slice(0,x).clone());f.start+=x}var w=s.children("li"),r=w.size(),z=f.start;g.css("visibility","visible");w.hide().show().css({"float":f.vertical?"none":"left"});s.css({margin:"0",padding:"0",position:"relative","list-style-type":"none","z-index":"1"});g.css({overflow:"hidden",position:"relative","z-index":"2",left:"0px"});var m=f.vertical?a(w):d(w);var u=m*r;var o=m*x;w.css({width:w.width(),height:w.height()});s.css(h,u+"px").css(n,-(z*m));g.css(h,o+"px");if(f.btnPrev){e(f.btnPrev).click(function(){return l(z-f.scroll)})}if(f.btnNext){e(f.btnNext).click(function(){return l(z+f.scroll)})}if(f.btnGo){e.each(f.btnGo,function(v,B){e(B).click(function(){return l(f.circular?f.visible+v:v)})})}if(f.mouseWheel&&g.mousewheel){g.mousewheel(function(v,B){return B>0?l(z-f.scroll):l(z+f.scroll)})}if(f.auto){setInterval(function(){if(A==false){l(z+f.scroll)}},f.auto+f.speed)}function j(){return w.slice(z).slice(0,x)}function l(v){if(!q){if(f.beforeStart){f.beforeStart.call(this,j())}if(f.circular){if(v<=f.start-x-1){s.css(n,-((r-(x*2))*m)+"px");z=v==f.start-x-1?r-(x*2)-1:r-(x*2)-f.scroll}else{if(v>=r-x+1){s.css(n,-((x)*m)+"px");z=v==r-x+1?x+1:x+f.scroll}else{z=v}}}else{if(v<0||v>r-x){return}else{z=v}}q=true;s.animate(n=="left"?{left:-(z*m)}:{top:-(z*m)},f.speed,f.easing,function(){if(f.afterEnd){f.afterEnd.call(this,j())}q=false});if(!f.circular){e(f.btnPrev+","+f.btnNext).removeClass("disabled");e((z-f.scroll<0&&f.btnPrev)||(z+f.scroll>r-x&&f.btnNext)||[]).addClass("disabled")}}return false}})};function b(f,g){return parseInt(e.css(f[0],g))||0}function d(f){return f[0].offsetWidth+b(f,"marginLeft")+b(f,"marginRight")}function a(f){return f[0].offsetHeight+b(f,"marginTop")+b(f,"marginBottom")}})(jQuery);(function($){function Timepicker(singleton){if(typeof(singleton)==="boolean"&&singleton==true){this.regional=[];this.regional[""]={currentText:"Now",ampm:false,timeFormat:"hh:mm tt",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second"};this.defaults={showButtonPanel:true,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showTime:true,stepHour:0.05,stepMinute:0.05,stepSecond:0.05,hour:0,minute:0,second:0,hourMin:0,minuteMin:0,secondMin:0,hourMax:23,minuteMax:59,secondMax:59,alwaysSetTime:true};$.extend(this.defaults,this.regional[""])}else{this.defaults=$.extend({},$.timepicker.defaults)}}Timepicker.prototype={$input:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,hour:0,minute:0,second:0,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",addTimePicker:function(dp_inst){var tp_inst=this;var currDT=this.$input.val();var regstr=this.defaults.timeFormat.toString().replace(/h{1,2}/ig,"(\\d?\\d)").replace(/m{1,2}/ig,"(\\d?\\d)").replace(/s{1,2}/ig,"(\\d?\\d)").replace(/t{1,2}/ig,"(am|pm|a|p)?").replace(/\s/g,"\\s?")+"$";if(!this.defaults.timeOnly){var dp_dateFormat=$.datepicker._get(dp_inst,"dateFormat");regstr=".{"+dp_dateFormat.length+",}\\s+"+regstr}var order=this.getFormatPositions();var treg=currDT.match(new RegExp(regstr,"i"));if(treg){if(order.t!==-1){this.ampm=((treg[order.t]===undefined||treg[order.t].length===0)?"":(treg[order.t].charAt(0).toUpperCase()=="A")?"AM":"PM").toUpperCase()}if(order.h!==-1){if(this.ampm=="AM"&&treg[order.h]=="12"){this.hour=0}else{if(this.ampm=="PM"&&treg[order.h]!="12"){this.hour=(parseFloat(treg[order.h])+12).toFixed(0)}else{this.hour=treg[order.h]}}}if(order.m!==-1){this.minute=treg[order.m]}if(order.s!==-1){this.second=treg[order.s]}}tp_inst.timeDefined=(treg)?true:false;if(typeof(dp_inst.stay_open)!=="boolean"||dp_inst.stay_open===false){setTimeout(function(){tp_inst.injectTimePicker(dp_inst,tp_inst)},10)}else{tp_inst.injectTimePicker(dp_inst,tp_inst)}},getFormatPositions:function(){var finds=this.defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|t{1,2})/g);var orders={h:-1,m:-1,s:-1,t:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]==-1){orders[finds[i].toString().charAt(0)]=i+1}}}return orders},injectTimePicker:function(dp_inst,tp_inst){var $dp=dp_inst.dpDiv;var opts=tp_inst.defaults;var hourMax=opts.hourMax-(opts.hourMax%opts.stepHour);var minMax=opts.minuteMax-(opts.minuteMax%opts.stepMinute);var secMax=opts.secondMax-(opts.secondMax%opts.stepSecond);if($dp.find("div#ui-timepicker-div-"+dp_inst.id).length===0){var noDisplay=' style="display:none;"';var html='<div class="ui-timepicker-div" id="ui-timepicker-div-'+dp_inst.id+'"><dl><dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+dp_inst.id+'"'+((opts.showTime)?"":noDisplay)+">"+opts.timeText+'</dt><dd class="ui_tpicker_time" id="ui_tpicker_time_'+dp_inst.id+'"'+((opts.showTime)?"":noDisplay)+'></dd><dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+dp_inst.id+'"'+((opts.showHour)?"":noDisplay)+">"+opts.hourText+'</dt><dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+dp_inst.id+'"'+((opts.showHour)?"":noDisplay)+'></dd><dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+dp_inst.id+'"'+((opts.showMinute)?"":noDisplay)+">"+opts.minuteText+'</dt><dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+dp_inst.id+'"'+((opts.showMinute)?"":noDisplay)+'></dd><dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+dp_inst.id+'"'+((opts.showSecond)?"":noDisplay)+">"+opts.secondText+'</dt><dd class="ui_tpicker_second" id="ui_tpicker_second_'+dp_inst.id+'"'+((opts.showSecond)?"":noDisplay)+"></dd></dl></div>";$tp=$(html);if(opts.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+opts.timeOnlyTitle+"</div></div>");$dp.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()}tp_inst.hour_slider=$tp.find("#ui_tpicker_hour_"+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.hour,min:opts.hourMin,max:hourMax,step:opts.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst)}});tp_inst.minute_slider=$tp.find("#ui_tpicker_minute_"+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.minute,min:opts.minuteMin,max:minMax,step:opts.stepMinute,slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst)}});tp_inst.second_slider=$tp.find("#ui_tpicker_second_"+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.second,min:opts.secondMin,max:secMax,step:opts.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst)}});$dp.find(".ui-datepicker-calendar").after($tp);tp_inst.$timeObj=$("#ui_tpicker_time_"+dp_inst.id);if(dp_inst!==null){var timeDefined=tp_inst.timeDefined;tp_inst.onTimeChange(dp_inst,tp_inst);tp_inst.timeDefined=timeDefined}}},onTimeChange:function(dp_inst,tp_inst){var hour=tp_inst.hour_slider.slider("value");var minute=tp_inst.minute_slider.slider("value");var second=tp_inst.second_slider.slider("value");var ampm=(hour<12)?"AM":"PM";var hasChanged=false;if(tp_inst.hour!=hour||tp_inst.minute!=minute||tp_inst.second!=second||(tp_inst.ampm.length>0&&tp_inst.ampm!=ampm)){hasChanged=true}tp_inst.hour=parseFloat(hour).toFixed(0);tp_inst.minute=parseFloat(minute).toFixed(0);tp_inst.second=parseFloat(second).toFixed(0);tp_inst.ampm=ampm;tp_inst.formatTime(tp_inst);tp_inst.$timeObj.text(tp_inst.formattedTime);if(hasChanged){tp_inst.updateDateTime(dp_inst,tp_inst);tp_inst.timeDefined=true}},formatTime:function(tp_inst){var tmptime=tp_inst.defaults.timeFormat.toString();var hour12=((tp_inst.ampm=="AM")?(tp_inst.hour):(tp_inst.hour%12));hour12=(hour12===0)?12:hour12;if(tp_inst.defaults.ampm===true){tmptime=tmptime.toString().replace(/hh/g,((hour12<10)?"0":"")+hour12).replace(/h/g,hour12).replace(/mm/g,((tp_inst.minute<10)?"0":"")+tp_inst.minute).replace(/m/g,tp_inst.minute).replace(/ss/g,((tp_inst.second<10)?"0":"")+tp_inst.second).replace(/s/g,tp_inst.second).replace(/TT/g,tp_inst.ampm.toUpperCase()).replace(/tt/g,tp_inst.ampm.toLowerCase()).replace(/T/g,tp_inst.ampm.charAt(0).toUpperCase()).replace(/t/g,tp_inst.ampm.charAt(0).toLowerCase())}else{tmptime=tmptime.toString().replace(/hh/g,((tp_inst.hour<10)?"0":"")+tp_inst.hour).replace(/h/g,tp_inst.hour).replace(/mm/g,((tp_inst.minute<10)?"0":"")+tp_inst.minute).replace(/m/g,tp_inst.minute).replace(/ss/g,((tp_inst.second<10)?"0":"")+tp_inst.second).replace(/s/g,tp_inst.second);tmptime=$.trim(tmptime.replace(/t/gi,""))}tp_inst.formattedTime=tmptime;return tp_inst.formattedTime},updateDateTime:function(dp_inst,tp_inst){var dt=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);var dateFmt=$.datepicker._get(dp_inst,"dateFormat");var formatCfg=$.datepicker._getFormatConfig(dp_inst);this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;var timeAvailable=dt!==null&&tp_inst.timeDefined;if(this.defaults.timeOnly===true){formattedDateTime=this.formattedTime}else{if(this.defaults.timeOnly!==true&&(this.defaults.alwaysSetTime||timeAvailable)){formattedDateTime+=" "+this.formattedTime}}this.formattedDateTime=formattedDateTime;this.$input.val(formattedDateTime);this.$input.trigger("change")},setDefaults:function(settings){extendRemove(this.defaults,settings||{});return this}};jQuery.fn.datetimepicker=function(o){var opts=(o===undefined?{}:o);var input=$(this);var tp=new Timepicker();var inlineSettings={};for(var attrName in tp.defaults){var attrValue=input.attr("time:"+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}tp.defaults=$.extend(tp.defaults,inlineSettings);var beforeShowFunc=function(input,inst){tp.hour=tp.defaults.hour;tp.minute=tp.defaults.minute;tp.second=tp.defaults.second;tp.ampm="";tp.$input=$(input);tp.inst=inst;tp.addTimePicker(inst);if($.isFunction(opts.beforeShow)){opts.beforeShow(input,inst)}};var onChangeMonthYearFunc=function(year,month,inst){tp.updateDateTime(inst,tp);if($.isFunction(opts.onChangeMonthYear)){opts.onChangeMonthYear(year,month,inst)}};var onCloseFunc=function(dateText,inst){if(tp.timeDefined===true&&input.val()!=""){tp.updateDateTime(inst,tp)}if($.isFunction(opts.onClose)){opts.onClose(dateText,inst)}};tp.defaults=$.extend({},tp.defaults,opts,{beforeShow:beforeShowFunc,onChangeMonthYear:onChangeMonthYearFunc,onClose:onCloseFunc,timepicker:tp});$(this).datepicker(tp.defaults)};jQuery.fn.timepicker=function(opts){opts=$.extend(opts,{timeOnly:true});$(this).datetimepicker(opts)};$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);var tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){inst.inline=true;inst.stay_open=true;$.datepicker._base_selectDate(id,dateStr);inst.stay_open=false;inst.inline=false;this._notifyChange(inst);this._updateDatepicker(inst)}else{$.datepicker._base_selectDate(id,dateStr)}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){if(typeof(inst.stay_open)!=="boolean"||inst.stay_open===false){this._base_updateDatepicker(inst);this._beforeShow(inst.input,inst)}};$.datepicker._beforeShow=function(input,inst){var beforeShow=this._get(inst,"beforeShow");if(beforeShow){inst.stay_open=true;beforeShow.apply((inst.input?inst.input[0]:null),[inst.input,inst]);inst.stay_open=false}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target);var tp_inst=$.datepicker._get(inst,"timepicker");if(tp_inst){if($.datepicker._get(inst,"constrainInput")){var dateChars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);var chrl=chr.toLowerCase();return event.ctrlKey||(chr<" "||!dateChars||dateChars.indexOf(chr)>-1||event.keyCode==58||event.keyCode==32||chr==":"||chr==" "||chrl=="a"||chrl=="p"||charl=="m")}}else{return $.datepicker._base_doKeyPress(event)}};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){$.datepicker._base_gotoToday(id);var target=$(id);var dp_inst=this._getInst(target[0]);var tp_inst=$.datepicker._get(dp_inst,"timepicker");if(tp_inst){var date=new Date();var hour=date.getHours();var minute=date.getMinutes();var second=date.getSeconds();if((hour<tp_inst.defaults.hourMin||hour>tp_inst.defaults.hourMax)||(minute<tp_inst.defaults.minuteMin||minute>tp_inst.defaults.minuteMax)||(second<tp_inst.defaults.secondMin||second>tp_inst.defaults.secondMax)){hour=tp_inst.defaults.hourMin;minute=tp_inst.defaults.minuteMin;second=tp_inst.defaults.secondMin}tp_inst.hour_slider.slider("value",hour);tp_inst.minute_slider.slider("value",minute);tp_inst.second_slider.slider("value",second);tp_inst.onTimeChange(dp_inst,tp_inst)}};function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}$.timepicker=new Timepicker(true)})(jQuery);(function(a){a.fn.extend({autocomplete:function(b,d){var e=typeof b=="string";d=a.extend({},a.Autocompleter.defaults,{url:e?b:null,data:e?null:b,delay:e?a.Autocompleter.defaults.delay:10,max:d&&!d.scroll?10:150},d);d.highlight=d.highlight||function(f){return f};d.formatMatch=d.formatMatch||d.formatItem;return this.each(function(){new a.Autocompleter(this,d)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(n,h){var d={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(n).attr("autocomplete","off").addClass(h.inputClass);var l;var s="";var o=a.Autocompleter.Cache(h);var f=0;var y;var B={mouseDownOnSelect:false};var v=a.Autocompleter.Select(h,n,e,B);var A;if(a.browser.opera){a(n.form).bind("submit.autocomplete",function(){if(A){A=false;return false}})}b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(C){f=1;y=C.keyCode;switch(C.keyCode){case d.UP:C.preventDefault();if(v.visible()){v.prev()}else{x(0,true)}break;case d.DOWN:C.preventDefault();if(v.visible()){v.next()}else{x(0,true)}break;case d.PAGEUP:C.preventDefault();if(v.visible()){v.pageUp()}else{x(0,true)}break;case d.PAGEDOWN:C.preventDefault();if(v.visible()){v.pageDown()}else{x(0,true)}break;case h.multiple&&a.trim(h.multipleSeparator)==","&&d.COMMA:case d.TAB:case d.RETURN:if(e()){C.preventDefault();A=true;return false}break;case d.ESC:v.hide();break;default:clearTimeout(l);l=setTimeout(x,h.delay);break}}).focus(function(){f++}).blur(function(){f=0;if(!B.mouseDownOnSelect){w()}}).click(function(){if(f++>1&&!v.visible()){x(0,true)}}).bind("search",function(){var C=(arguments.length>1)?arguments[1]:null;function D(H,G){var E;if(G&&G.length){for(var F=0;F<G.length;F++){if(G[F].result.toLowerCase()==H.toLowerCase()){E=G[F];break}}}if(typeof C=="function"){C(E)}else{b.trigger("result",E&&[E.data,E.value])}}a.each(j(b.val()),function(E,F){g(F,D,D)})}).bind("flushCache",function(){o.flush()}).bind("setOptions",function(){a.extend(h,arguments[1]);if("data" in arguments[1]){o.populate()}}).bind("unautocomplete",function(){v.unbind();b.unbind();a(n.form).unbind(".autocomplete")});function e(){var F=v.selected();if(!F){return false}var C=F.result;s=C;if(h.multiple){var I=j(b.val());if(I.length>1){var E=h.multipleSeparator.length;var H=a(n).selection().start;var G,D=0;a.each(I,function(J,K){D+=K.length;if(H<=D){G=J;return false}D+=E});I[G]=C;C=I.join(h.multipleSeparator)}C+=h.multipleSeparator}b.val(C);z();b.trigger("result",[F.data,F.value]);return true}function x(E,D){if(y==d.DEL){v.hide();return}var C=b.val();if(!D&&C==s){return}s=C;C=k(C);if(C.length>=h.minChars){b.addClass(h.loadingClass);if(!h.matchCase){C=C.toLowerCase()}g(C,m,z)}else{q();v.hide()}}function j(C){if(!C){return[""]}if(!h.multiple){return[a.trim(C)]}return a.map(C.split(h.multipleSeparator),function(D){return a.trim(C).length?a.trim(D):null})}function k(C){if(!h.multiple){return C}var E=j(C);if(E.length==1){return E[0]}var D=a(n).selection().start;if(D==C.length){E=j(C)}else{E=j(C.replace(C.substring(D),""))}return E[E.length-1]}function u(C,D){if(h.autoFill&&(k(b.val()).toLowerCase()==C.toLowerCase())&&y!=d.BACKSPACE){b.val(b.val()+D.substring(k(s).length));a(n).selection(s.length,s.length+D.length)}}function w(){clearTimeout(l);l=setTimeout(z,200)}function z(){var C=v.visible();v.hide();clearTimeout(l);q();if(h.mustMatch){b.search(function(D){if(!D){if(h.multiple){var E=j(b.val()).slice(0,-1);b.val(E.join(h.multipleSeparator)+(E.length?h.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function m(D,C){if(C&&C.length&&C[0].value.toLowerCase&&f){q();v.display(C,D);u(D,C[0].value);v.show()}else{z()}}function g(D,F,C){if(!h.matchCase){D=D.toLowerCase()}var E=o.load(D);if(E&&E.length){F(D,E)}else{if((typeof h.url=="string")&&(h.url.length>0)){var G={timestamp:+new Date()};a.each(h.extraParams,function(H,I){G[H]=typeof I=="function"?I():I});a.ajax({mode:"abort",port:"autocomplete"+n.name,dataType:h.dataType,url:h.url,data:a.extend({q:k(D),limit:h.max},G),success:function(I){var H=h.parse&&h.parse(I)||r(I);o.add(D,H);F(D,H)}})}else{v.emptyList();C(D)}}}function r(F){var C=[];var E=F.split("\n");for(var D=0;D<E.length;D++){var G=a.trim(E[D]);if(G){G=G.split("|");C[C.length]={data:G,value:G[0],result:h.formatResult&&h.formatResult(G,G[0])||G[0]}}}return C}function q(){b.removeClass(h.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(d,b){return d.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(d){var g={};var e=0;function j(m,l){if(!m.toLowerCase){return false}if(!d.matchCase){m=m.toLowerCase()}var k=m.indexOf(l);if(d.matchContains=="word"){k=m.toLowerCase().search("\\b"+l.toLowerCase())}if(k==-1){return false}return k==0||d.matchContains}function h(l,k){if(e>d.cacheLength){b()}if(!g[l]){e++}g[l]=k}function f(){if(!d.data){return false}var l={},k=0;if(!d.url){d.cacheLength=1}l[""]=[];for(var n=0,m=d.data.length;n<m;n++){var r=d.data[n];r=(typeof r=="string")?[r]:r;var q=d.formatMatch(r,n+1,d.data.length);if(q===false){continue}var o=q.charAt(0).toLowerCase();if(!l[o]){l[o]=[]}var s={value:q,data:r,result:d.formatResult&&d.formatResult(r)||q};l[o].push(s);if(k++<d.max){l[""].push(s)}}a.each(l,function(u,v){d.cacheLength++;h(u,v)})}setTimeout(f,25);function b(){g={};e=0}return{flush:b,add:h,populate:f,load:function(o){if(!d.cacheLength||!e){return null}if(!d.url&&d.matchContains){var n=[];for(var l in g){if(l.length>0){var r=g[l];a.each(r,function(q,k){if(j(k.value,o)){n.push(k)}})}}return n}else{if(g[o]){return g[o]}else{if(d.matchSubset){for(var m=o.length-1;m>=d.minChars;m--){var r=g[o.substr(0,m)];if(r){var n=[];a.each(r,function(q,k){if(j(k.value,o)){n[n.length]=k}});return n}}}}}return null}}};a.Autocompleter.Select=function(f,l,n,s){var k={ACTIVE:"ac_over"};var m,g=-1,v,o="",w=true,d,r;function q(){if(!w){return}d=a("<div/>").hide().addClass(f.resultsClass).css("position","absolute").appendTo(document.body);r=a("<ul/>").appendTo(d).mouseover(function(x){if(u(x).nodeName&&u(x).nodeName.toUpperCase()=="LI"){g=a("li",r).removeClass(k.ACTIVE).index(u(x));a(u(x)).addClass(k.ACTIVE)}}).click(function(x){a(u(x)).addClass(k.ACTIVE);n();l.focus();return false}).mousedown(function(){s.mouseDownOnSelect=true}).mouseup(function(){s.mouseDownOnSelect=false});if(f.width>0){d.css("width",f.width)}w=false}function u(y){var x=y.target;while(x&&x.tagName!="LI"){x=x.parentNode}if(!x){return[]}return x}function j(x){m.slice(g,g+1).removeClass(k.ACTIVE);h(x);var z=m.slice(g,g+1).addClass(k.ACTIVE);if(f.scroll){var y=0;m.slice(0,g).each(function(){y+=this.offsetHeight});if((y+z[0].offsetHeight-r.scrollTop())>r[0].clientHeight){r.scrollTop(y+z[0].offsetHeight-r.innerHeight())}else{if(y<r.scrollTop()){r.scrollTop(y)}}}}function h(x){g+=x;if(g<0){g=m.size()-1}else{if(g>=m.size()){g=0}}}function b(x){return f.max&&f.max<x?f.max:x}function e(){r.empty();var y=b(v.length);for(var z=0;z<y;z++){if(!v[z]){continue}var A=f.formatItem(v[z].data,z+1,y,v[z].value,o);if(A===false){continue}var x=a("<li/>").html(f.highlight(A,o)).addClass(z%2==0?"ac_even":"ac_odd").appendTo(r)[0];a.data(x,"ac_data",v[z])}m=r.find("li");if(f.selectFirst){m.slice(0,1).addClass(k.ACTIVE);g=0}if(a.fn.bgiframe){r.bgiframe()}}return{display:function(y,x){q();v=y;o=x;e()},next:function(){j(1)},prev:function(){j(-1)},pageUp:function(){if(g!=0&&g-8<0){j(-g)}else{j(-8)}},pageDown:function(){if(g!=m.size()-1&&g+8>m.size()){j(m.size()-1-g)}else{j(8)}},hide:function(){d&&d.hide();m&&m.removeClass(k.ACTIVE);g=-1},visible:function(){return d&&d.is(":visible")},current:function(){return this.visible()&&(m.filter("."+k.ACTIVE)[0]||f.selectFirst&&m[0])},show:function(){var z=a(l).offset();d.css({width:typeof f.width=="string"||f.width>0?f.width:a(l).width(),top:z.top+l.offsetHeight,left:z.left}).show();if(f.scroll){r.scrollTop(0);r.css({maxHeight:f.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var x=0;m.each(function(){x+=this.offsetHeight});var y=x>f.scrollHeight;r.css("height",y?f.scrollHeight:x);if(!y){m.width(r.width()-parseInt(m.css("padding-left"))-parseInt(m.css("padding-right")))}}}},selected:function(){var x=m&&m.filter("."+k.ACTIVE).removeClass(k.ACTIVE);return x&&x.length&&a.data(x[0],"ac_data")},emptyList:function(){r&&r.empty()},unbind:function(){d&&d.remove()}}};a.fn.selection=function(k,b){if(k!==undefined){return this.each(function(){if(this.createTextRange){var l=this.createTextRange();if(b===undefined||k==b){l.move("character",k);l.select()}else{l.collapse(true);l.moveStart("character",k);l.moveEnd("character",b);l.select()}}else{if(this.setSelectionRange){this.setSelectionRange(k,b)}else{if(this.selectionStart){this.selectionStart=k;this.selectionEnd=b}}}})}var h=this[0];if(h.createTextRange){var d=document.selection.createRange(),j=h.value,g="<->",e=d.text.length;d.text=g;var f=h.value.indexOf(g);h.value=j;this.selection(f,f+e);return{start:f,end:f+e}}else{if(h.selectionStart!==undefined){return{start:h.selectionStart,end:h.selectionEnd}}}}})(jQuery);(function(h,e,g){var f=/\s+/;g.unwhite=function(a){a=a&&g.trim(a);return a.length?a.split(f):[]};g.eventProxy=function(a,b){var d=g.proxy.apply(null,arguments);return function(){return d.apply(null,Array.prototype.slice.call(arguments,1))}};g.bindable=function(a,b){if(!(a instanceof Object)){b=a;a={}}a=g.isFunction(a)?a.prototype:a;g.each(["bind","one","unbind"],function(j,d){a[d]=function(m,l,n){if(arguments.length===2||l===false){g(this)[d](m,l);return this}g(this)[d](m,l,n);return this}});a.trigger=function(l,d){var k=new g.Event(l);var m=new g.Event(k);k.preventDefault();m.type="*";if(k.type!==m.type){g.event.trigger(k,d,this)}g.event.trigger(m,d,this);return this};if(typeof b==="string"){g.each(g.unwhite(b),function(j,d){a[d]=function(k,l){return arguments.length?this.bind(d,k,l):this.trigger(d)}})}return a}})(this,this.document,jQuery);jQuery.cookie=function(b,k,n){if(typeof k!="undefined"){n=n||{};if(k===null){k="";n.expires=-1}var f="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var g;if(typeof n.expires=="number"){g=new Date();g.setTime(g.getTime()+(n.expires*24*60*60*1000))}else{g=n.expires}f="; expires="+g.toUTCString()}var m=n.path?"; path="+(n.path):"";var h=n.domain?"; domain="+(n.domain):"";var a=n.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(k),f,m,h,a].join("")}else{var e=null;if(document.cookie&&document.cookie!=""){var l=document.cookie.split(";");for(var j=0;j<l.length;j++){var d=jQuery.trim(l[j]);if(d.substring(0,b.length+1)==(b+"=")){e=decodeURIComponent(d.substring(b.length+1));break}}}return e}};jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,m,l){var j=1.70158;var k=0;var g=m;if(h==0){return e}if((h/=l)==1){return e+m}if(!k){k=l*0.3}if(g<Math.abs(m)){g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*l-j)*(2*Math.PI)/k))+e},easeOutElastic:function(f,h,e,m,l){var j=1.70158;var k=0;var g=m;if(h==0){return e}if((h/=l)==1){return e+m}if(!k){k=l*0.3}if(g<Math.abs(m)){g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}return g*Math.pow(2,-10*h)*Math.sin((h*l-j)*(2*Math.PI)/k)+m+e},easeInOutElastic:function(f,h,e,m,l){var j=1.70158;var k=0;var g=m;if(h==0){return e}if((h/=l/2)==2){return e+m}if(!k){k=l*(0.3*1.5)}if(g<Math.abs(m)){g=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*l-j)*(2*Math.PI)/k))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*l-j)*(2*Math.PI)/k)*0.5+m+e},easeInBack:function(e,f,a,j,h,g){if(g==undefined){g=1.70158}return j*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,j,h,g){if(g==undefined){g=1.70158}return j*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,j,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return j/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return j/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});jQuery.extend(jQuery.easing,{easeIn:function(e,f,a,h,g){return jQuery.easing.easeInQuad(e,f,a,h,g)},easeOut:function(e,f,a,h,g){return jQuery.easing.easeOutQuad(e,f,a,h,g)},easeInOut:function(e,f,a,h,g){return jQuery.easing.easeInOutQuad(e,f,a,h,g)},expoin:function(e,f,a,h,g){return jQuery.easing.easeInExpo(e,f,a,h,g)},expoout:function(e,f,a,h,g){return jQuery.easing.easeOutExpo(e,f,a,h,g)},expoinout:function(e,f,a,h,g){return jQuery.easing.easeInOutExpo(e,f,a,h,g)},bouncein:function(e,f,a,h,g){return jQuery.easing.easeInBounce(e,f,a,h,g)},bounceout:function(e,f,a,h,g){return jQuery.easing.easeOutBounce(e,f,a,h,g)},bounceinout:function(e,f,a,h,g){return jQuery.easing.easeInOutBounce(e,f,a,h,g)},elasin:function(e,f,a,h,g){return jQuery.easing.easeInElastic(e,f,a,h,g)},elasout:function(e,f,a,h,g){return jQuery.easing.easeOutElastic(e,f,a,h,g)},elasinout:function(e,f,a,h,g){return jQuery.easing.easeInOutElastic(e,f,a,h,g)},backin:function(e,f,a,h,g){return jQuery.easing.easeInBack(e,f,a,h,g)},backout:function(e,f,a,h,g){return jQuery.easing.easeOutBack(e,f,a,h,g)},backinout:function(e,f,a,h,g){return jQuery.easing.easeInOutBack(e,f,a,h,g)}});jQuery(function($){$.fn.fcbkcomplete=function(opt){return this.each(function(){function init(){createFCBK();preSet();addInput(0);if(options.pre_cache){preCache()}}function createFCBK(){element.hide();element.attr("multiple","multiple");if(element.attr("name").indexOf("[]")==-1){element.attr("name",element.attr("name")+"[]")}holder=$(document.createElement("ul"));holder.attr("class","holder");if(options.attachto){if(typeof(options.attachto)=="object"){options.attachto.append(holder)}else{$(options.attachto).append(holder)}}else{element.after(holder)}complete=$(document.createElement("div"));complete.addClass("facebook-auto");complete.append('<div class="default">'+options.complete_text+"</div>");complete.hover(function(){complete_hover=0},function(){complete_hover=1});feed=$(document.createElement("ul"));feed.attr("id",elemid+"_feed");complete.prepend(feed);holder.after(complete);feed.css("width",complete.width())}function preSet(){element.children("option").each(function(i,option){option=$(option);if(option.attr("selected")){addItem(option.text(),option.val(),true,option.hasClass("locked"));option.addClass("selected","selected")}cache.push({key:option.text(),value:option.val()});search_string+=""+(cache.length-1)+":"+option.text()+";"})}function preCache(){$.getJSON(options.json_url,function(data){addMembers("",data);json_cache=true})}$(this).bind("addItem",function(event,data){addItem(data.title,data.value,0,0,0)});$(this).bind("removeItem",function(event,data){var item=holder.children("li[rel='"+htmlspecial(data.value)+"']");if(item.length){removeItem(item)}});$(this).bind("destroy",function(event,data){holder.remove();complete.remove();element.show()});function addItem(title,value,preadded,locked,focusme){if(!maxItems()){return false}var li=document.createElement("li");var txt=document.createTextNode(title);var aclose=document.createElement("a");var liclass="bit-box"+(locked?" locked":"");$(li).attr({"class":liclass,rel:value});$(li).prepend(txt);$(aclose).attr({"class":"closebutton",href:"#"});li.appendChild(aclose);holder.append(li);$(aclose).click(function(){removeItem($(this).parent("li"));return false});if(!preadded){$("#"+elemid+"_annoninput").remove();var _item;addInput(focusme);if(element.children("option[value='"+htmlspecial(value)+"']").length){_item=element.children("option[value='"+htmlspecial(value)+"']");_item.get(0).setAttribute("selected","selected");_item.attr("selected","selected");if(!_item.hasClass("selected")){_item.addClass("selected")}}else{var _item=$(document.createElement("option"));_item.attr("value",value).get(0).setAttribute("selected","selected");_item.attr("value",value).attr("selected","selected");_item.attr("value",value).addClass("selected");_item.text(title);element.append(_item)}if(options.onselect){funCall(options.onselect,_item)}element.change()}holder.children("li.bit-box.deleted").removeClass("deleted");feed.hide()}function removeItem(item){if(!item.hasClass("locked")){item.fadeOut("fast");if(options.onremove){var _item=element.children("option[value='"+htmlspecial(item.attr("rel"))+"']");funCall(options.onremove,_item)}element.children("option[value='"+htmlspecial(item.attr("rel"))+"']").removeAttr("selected").removeClass("selected");item.remove();element.change();deleting=0}}function addInput(focusme){var li=$(document.createElement("li"));var input=$(document.createElement("input"));var getBoxTimeout=0;li.attr({"class":"bit-input",id:elemid+"_annoninput"});input.attr({type:"text","class":"maininput",size:"1"});if(options.max_length){input.attr("maxlength",options.max_length)}holder.append(li.append(input));input.focus(function(){complete.fadeIn("fast")});input.blur(function(){if(complete_hover){complete.fadeOut("fast")}else{input.focus()}});holder.click(function(){input.focus();if(feed.length&&input.val().length){feed.show()}else{feed.hide();complete.children(".default").show()}});input.keypress(function(event){if(event.keyCode==13){return false}input.attr("size",input.val().length+1)});input.keydown(function(event){if(event.keyCode==191){event.preventDefault();return false}});input.keyup(function(event){var etext=xssPrevent(input.val());if(event.keyCode==8&&etext.length==0){feed.hide();if(!holder.children("li.bit-box:last").hasClass("locked")){if(holder.children("li.bit-box.deleted").length==0){holder.children("li.bit-box:last").addClass("deleted");return false}else{if(deleting){return}deleting=1;holder.children("li.bit-box.deleted").fadeOut("fast",function(){removeItem($(this));return false})}}}if(event.keyCode!=40&&event.keyCode!=38&&event.keyCode!=37&&event.keyCode!=39&&etext.length!=0){counter=0;if(options.json_url){if(options.cache&&json_cache){addMembers(etext);bindEvents()}else{getBoxTimeout++;var getBoxTimeoutValue=getBoxTimeout;setTimeout(function(){if(getBoxTimeoutValue!=getBoxTimeout){return}var q={};q[options.search_string]=etext;$.getJSON(options.json_url,$.extend({},options.extra_params,q),function(data){var data=options.parser&&options.parser(data)||data;addMembers(etext,data);json_cache=true;bindEvents()})},options.delay)}}else{addMembers(etext);bindEvents()}complete.children(".default").hide();feed.show()}});if(focusme){setTimeout(function(){input.focus();complete.children(".default").show()},1)}}function addMembers(etext,data){feed.html("");if(!options.cache&&data!=null){cache=new Array();search_string=""}addTextItem(etext);if(data!=null&&data.length){$.each(data,function(i,val){cache.push({key:val.key,value:val.value});search_string+=""+(cache.length-1)+":"+val.key+";"})}var maximum=options.maxshownitems<cache.length?options.maxshownitems:cache.length;var filter="i";if(options.filter_case){filter=""}var myregexp,match;try{myregexp=eval("/(?:^|;)\\s*(\\d+)\\s*:[^;]*?"+etext.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")+"[^;]*/g"+filter);match=myregexp.exec(search_string)}catch(ex){}var content="";while(match!=null&&maximum>0){var id=match[1];var object=cache[id];if(options.filter_selected&&element.children("option[value='"+htmlspecial(object.value)+"']").hasClass("selected")){}else{content+="<li rel='"+htmlspecial(object.value)+"'>"+itemIllumination(object.key,etext)+"</li>";counter++;maximum--}match=myregexp.exec(search_string)}feed.append(content);if(options.firstselected){focuson=feed.children("li:visible:first");focuson.addClass("auto-focus")}if(counter>options.height){feed.css({height:(options.height*24)+"px",overflow:"auto"})}else{feed.css("height","auto")}}function itemIllumination(text,etext){if(options.filter_case){try{eval("var text = text.replace(/(.*)("+etext.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")+")(.*)/gi,'$1<em>$2</em>$3');")}catch(ex){}}else{try{eval("var text = text.replace(/(.*)("+etext.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&").toLowerCase()+")(.*)/gi,'$1<em>$2</em>$3');")}catch(ex){}}return text}function bindFeedEvent(){feed.children("li").mouseover(function(){feed.children("li").removeClass("auto-focus");$(this).addClass("auto-focus");focuson=$(this)});feed.children("li").mouseout(function(){$(this).removeClass("auto-focus");focuson=null})}function removeFeedEvent(){feed.children("li").unbind("mouseover");feed.children("li").unbind("mouseout");feed.mousemove(function(){bindFeedEvent();feed.unbind("mousemove")})}function bindEvents(){var maininput=$("#"+elemid+"_annoninput").children(".maininput");bindFeedEvent();feed.children("li").unbind("mousedown");feed.children("li").mousedown(function(){var option=$(this);addItem(option.text(),option.attr("rel"),0,0,1);feed.hide();complete.hide()});maininput.unbind("keydown");maininput.keydown(function(event){if(event.keyCode==191){event.preventDefault();return false}if(event.keyCode==jQuery.ui.keyCode.ESCAPE){feed.hide();complete.hide()}if(event.keyCode!=jQuery.ui.keyCode.BACKSPACE){holder.children("li.bit-box.deleted").removeClass("deleted")}if((event.keyCode==jQuery.ui.keyCode.ENTER||event.keyCode==jQuery.ui.keyCode.TAB||event.keyCode==188)&&checkFocusOn()){var option=focuson;addItem(option.text(),option.attr("rel"),0,0,1);complete.hide();event.preventDefault();focuson=null;return false}if((event.keyCode==jQuery.ui.keyCode.ENTER||event.keyCode==jQuery.ui.keyCode.TAB||event.keyCode==188)&&!checkFocusOn()){if(options.newel){var value=xssPrevent($(this).val());addItem(value,value,0,0,1);complete.hide();event.preventDefault();focuson=null;return false}if(options.addontab||event.keyCode==188){focuson=feed.children("li:visible:first");var option=focuson;addItem(option.text(),option.attr("rel"),0,0,1);complete.hide();event.preventDefault();focuson=null;return false}}if(event.keyCode==jQuery.ui.keyCode.DOWN){removeFeedEvent();if(focuson==null||focuson.length==0){focuson=feed.children("li:visible:first");feed.get(0).scrollTop=0}else{focuson.removeClass("auto-focus");focuson=focuson.nextAll("li:visible:first");var prev=parseInt(focuson.prevAll("li:visible").length,10);var next=parseInt(focuson.nextAll("li:visible").length,10);if((prev>Math.round(options.height/2)||next<=Math.round(options.height/2))&&typeof(focuson.get(0))!="undefined"){feed.get(0).scrollTop=parseInt(focuson.get(0).scrollHeight,10)*(prev-Math.round(options.height/2))}}feed.children("li").removeClass("auto-focus");focuson.addClass("auto-focus")}if(event.keyCode==jQuery.ui.keyCode.UP){removeFeedEvent();if(focuson==null||focuson.length==0){focuson=feed.children("li:visible:last");feed.get(0).scrollTop=parseInt(focuson.get(0).scrollHeight,10)*(parseInt(feed.children("li:visible").length,10)-Math.round(options.height/2))}else{focuson.removeClass("auto-focus");focuson=focuson.prevAll("li:visible:first");var prev=parseInt(focuson.prevAll("li:visible").length,10);var next=parseInt(focuson.nextAll("li:visible").length,10);if((next>Math.round(options.height/2)||prev<=Math.round(options.height/2))&&typeof(focuson.get(0))!="undefined"){feed.get(0).scrollTop=parseInt(focuson.get(0).scrollHeight,10)*(prev-Math.round(options.height/2))}}feed.children("li").removeClass("auto-focus");focuson.addClass("auto-focus")}})}function maxItems(){if(options.maxitems!=0){if(holder.children("li.bit-box").length<options.maxitems){return true}else{return false}}}function addTextItem(value){if(options.newel&&maxItems()){feed.children("li[fckb=1]").remove();if(value.length==0){return}var li=$(document.createElement("li"));li.attr({rel:value,fckb:"1"}).html(value);feed.prepend(li);counter++}else{return}}function funCall(func,item){var _object="";for(i=0;i<item.get(0).attributes.length;i++){if(item.get(0).attributes[i].nodeValue!=null){_object+='"_'+item.get(0).attributes[i].nodeName+'": "'+item.get(0).attributes[i].nodeValue+'",'}}_object="{"+_object+" notinuse: 0}";func.call(func,_object)}function checkFocusOn(){if(focuson==null){return false}if(focuson.length==0){return false}return true}function xssPrevent(string){string=string.replace(/[\"\'][\s]*javascript:(.*)[\"\']/g,'""');string=string.replace(/script(.*)/g,"");string=string.replace(/eval\((.*)\)/g,"");string=string.replace("/([\x00-\x08,\x0b-\x0c,\x0e-\x19])/","");return string}function htmlspecialchars(string){string=String(string);string=string.replace(/&/g,"&amp;");string=string.replace(/"/g,"&quot;");string=string.replace(/'/g,"&#039;");string=string.replace(/</g,"&lt;");string=string.replace(/>/g,"&gt;");return string}function htmlspecialchars_decode(string){string=String(string);string=string.replace(/&gt;/g,">");string=string.replace(/&lt;/g,"<");string=string.replace(/&#0*39;/g,"'");string=string.replace(/&quot;/g,'"');string=string.replace(/&amp;/g,"&");return string}function htmlspecial(string){return htmlspecialchars(htmlspecialchars_decode(string))}var options=$.extend({json_url:null,cache:false,height:"10",newel:false,addontab:false,firstselected:false,filter_case:false,filter_selected:false,complete_text:"Start to type...",maxshownitems:30,maxitems:10,onselect:null,onremove:null,attachto:null,delay:350,pre_cache:false,search_string:"q",extra_params:{},parser:null},opt);var holder=null;var feed=null;var complete=null;var counter=0;var cache=new Array();var json_cache=false;var search_string="";var focuson=null;var deleting=0;var complete_hover=1;var element=$(this);var elemid=element.attr("id");init();return this})}});
/*
 * jQuery imagesLoaded plugin v2.0.1
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */
(function(a,b){var d="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";a.fn.imagesLoaded=function(m){var j=this,o=a.isFunction(a.Deferred)?a.Deferred():0,n=a.isFunction(o.notify),f=j.find("img").add(j.filter("img")),g=[],l=[],h=[];function k(){var q=a(l),r=a(h);if(o){if(h.length){o.reject(f,q,r)}else{o.resolve(f)}}if(a.isFunction(m)){m.call(j,f,q,r)}}function e(q,r){if(q.src===d||a.inArray(q,g)!==-1){return}g.push(q);if(r){h.push(q)}else{l.push(q)}a.data(q,"imagesLoaded",{isBroken:r,src:q.src});if(n){o.notifyWith(a(q),[r,f,a(l),a(h)])}if(f.length===g.length){setTimeout(k);f.unbind(".imagesLoaded")}}if(!f.length){k()}else{f.bind("load.imagesLoaded error.imagesLoaded",function(q){e(q.target,q.type==="error")}).each(function(q,s){var u=s.src;var r=a.data(s,"imagesLoaded");if(r&&r.src===u){e(s,r.isBroken);return}if(s.complete&&s.naturalWidth!==b){e(s,s.naturalWidth===0||s.naturalHeight===0);return}if(s.readyState||s.complete){s.src=d;s.src=u}})}return o?o.promise(j):j}})(jQuery);
/* jCarousel - v0.3.0-beta - 2012-10-11
* http://sorgalla.com/jcarousel/
* Copyright 2012 Jan Sorgalla
* Released under the MIT license */
(function(b){var a=b.jCarousel={};a.version="0.3.0-beta";var d=/^([+\-]=)?(.+)$/;a.parseTarget=function(h){var f=!1,g=typeof h!="object"?d.exec(h):null;return g?(h=parseInt(g[2],10)||0,g[1]&&(f=!0,g[1]==="-="&&(h*=-1))):typeof h!="object"&&(h=parseInt(h,10)||0),{target:h,relative:f}},a.detectCarousel=function(g){var f;while(g.size()>0){f=g.filter("[data-jcarousel]");if(f.size()>0){return f}f=g.find("[data-jcarousel]");if(f.size()>0){return f}g=g.parent()}return null},a.base=function(e){return{version:a.version,_options:{},_element:null,_carousel:null,_init:b.noop,_create:b.noop,_destroy:b.noop,_reload:b.noop,create:function(){return this._element.attr("data-"+e.toLowerCase(),!0).data(e,this),!1===this._trigger("create")?this:(this._create(),this._trigger("createend"),this)},destroy:function(){return !1===this._trigger("destroy")?this:(this._destroy(),this._trigger("destroyend"),this._element.removeData(e).removeAttr("data-"+e.toLowerCase()),this)},reload:function(f){return !1===this._trigger("reload")?this:(f&&this.options(f),this._reload(),this._trigger("reloadend"),this)},element:function(){return this._element},options:function(f,g){if(arguments.length===0){return b.extend({},this._options)}if(typeof f=="string"){if(typeof g=="undefined"){return typeof this._options[f]=="undefined"?null:this._options[f]}this._options[f]=g}else{this._options=b.extend({},this._options,f)}return this},carousel:function(){return this._carousel||(this._carousel=a.detectCarousel(this.options("carousel")||this._element),this._carousel||b.error('Could not detect carousel for plugin "'+e+'"')),this._carousel},_trigger:function(g,j,f){var h=b.Event((g+"."+e).toLowerCase());return(j||this._element).trigger(h,[this].concat(f||[])),!h.isDefaultPrevented()}}},a.plugin=function(g,f){var e=b[g]=function(h,j){this._element=b(h),this.options(j),this._init(),this.create()};return e.fn=e.prototype=b.extend({},a.base(g),f),b.fn[g]=function(h){var k=Array.prototype.slice.call(arguments,1),j=this;return typeof h=="string"?this.each(function(){var l=b(this).data(g);if(!l){return b.error("Cannot call methods on "+g+' prior to initialization; attempted to call method "'+h+'"')}if(!b.isFunction(l[h])||h.charAt(0)==="_"){return b.error('No such method "'+h+'" for '+g+" instance")}var m=l[h].apply(l,k);if(m!==l&&typeof m!="undefined"){return j=m,!1}}):this.each(function(){var l=b(this).data(g);l?l.reload(h):new e(this,h)}),j},e}})(jQuery),function(b,a){var d=function(f){return parseFloat(f)||0};b.jCarousel.plugin("jcarousel",{animating:!1,tail:0,inTail:!1,resizeTimer:null,lt:null,vertical:!1,rtl:!1,circular:!1,_options:{list:function(){return this.element().children().eq(0)},items:function(){return this.list().children()},animation:400,wrap:null,vertical:null,rtl:null,center:!1},_list:null,_items:null,_target:null,_first:null,_last:null,_visible:null,_fullyvisible:null,_init:function(){var e=this;return this.onWindowResize=function(){e.resizeTimer&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.reload()},100)},this.onAnimationComplete=function(g){e.animating=!1;var f=e.list().find("[data-jcarousel-clone]");f.size()>0&&(f.remove(),e._reload()),e._trigger("animateend"),b.isFunction(g)&&g.call(e,!0)},this},_create:function(){this._reload(),b(a).bind("resize.jcarousel",this.onWindowResize)},_destroy:function(){b(a).unbind("resize.jcarousel",this.onWindowResize)},_reload:function(){this.vertical=this.options("vertical"),this.vertical==null&&(this.vertical=this.list().height()>this.list().width()),this.rtl=this.options("rtl"),this.rtl==null&&(this.rtl=function(f){if((""+f.attr("dir")).toLowerCase()==="rtl"){return !0}var g=!1;return f.parents("[dir]").each(function(){if(/rtl/i.test(b(this).attr("dir"))){return g=!0,!1}}),g}(this._element)),this.lt=this.vertical?"top":"left",this._items=null;var e=this._target||this.closest();return this.circular=this.options("wrap")==="circular",e.size()>0?(this._prepare(e),this.list().find("[data-jcarousel-clone]").remove(),this._items=null,this.circular=this.options("wrap")==="circular"&&this._fullyvisible.size()<this.items().size(),this.list().css(this.lt,this._position(e)+"px")):this.list().css({left:0,top:0}),this},list:function(){if(this._list===null){var e=this.options("list");this._list=b.isFunction(e)?e.call(this):this._element.find(e)}return this._list},items:function(){if(this._items===null){var e=this.options("items");this._items=(b.isFunction(e)?e.call(this):this.list().find(e)).not("[data-jcarousel-clone]")}return this._items},closest:function(){var g=this,j=this.list().position()[this.lt],f=b(),h=!1,k=this.vertical?"bottom":this.rtl?"left":"right",e;return this.rtl&&!this.vertical&&(j=(j+this.list().width()-this.clipping())*-1),this.items().each(function(){f=b(this);if(h){return !1}var l=g.dimension(f);j+=l;if(j>=0){e=l-d(f.css("margin-"+k));if(!(Math.abs(j)-l+e/2<=0)){return !1}h=!0}}),f},target:function(){return this._target},first:function(){return this._first},last:function(){return this._last},visible:function(){return this._visible},fullyvisible:function(){return this._fullyvisible},hasNext:function(){if(!1===this._trigger("hasnext")){return !0}var g=this.options("wrap"),f=this.items().size()-1;return f>=0&&(g&&g!=="first"||this._last.index()<f||this.tail&&!this.inTail)?!0:!1},hasPrev:function(){if(!1===this._trigger("hasprev")){return !0}var f=this.options("wrap");return this.items().size()>0&&(f&&f!=="last"||this._first.index()>0||this.tail&&this.inTail)?!0:!1},clipping:function(){return this._element["inner"+(this.vertical?"Height":"Width")]()},dimension:function(f){return f["outer"+(this.vertical?"Height":"Width")](!0)},scroll:function(B,e,m){if(this.animating){return this}if(!1===this._trigger("scroll",null,[B,e])){return this}b.isFunction(e)&&(m=e,e=!0);var C=b.jCarousel.parseTarget(B);if(C.relative){var j=this.items().size()-1,A=Math.abs(C.target),y=this.options("wrap"),q,k,x,n;if(C.target>0){var g=this._last.index();if(g>=j&&this.tail){this.inTail?y==="both"||y==="last"?this._scroll(0,e,m):this._scroll(Math.min(this._target.index()+A,j),e,m):this._scrollTail(e,m)}else{if(g!==j||y!=="both"&&y!=="last"){q=this._target.index(),k=q+A;if(this.circular&&k>j){n=j,x=this.items().get(-1);while(n++<k){x=this.items().eq(0),x.after(x.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(x),this._items=null}this._scroll(x,e,m)}else{this._scroll(Math.min(k,j),e,m)}}else{this._scroll(0,e,m)}}}else{if(this.inTail){this._scroll(Math.max(this._first.index()-A+1,0),e,m)}else{q=this._first.index(),k=q-A;if(q!==0||y!=="both"&&y!=="first"){if(this.circular&&k<0){n=k,x=this.items().get(0);while(n++<0){x=this.items().eq(-1),x.after(x.clone(!0).attr("data-jcarousel-clone",!0)),this.list().prepend(x),this._items=null;var w=d(this.list().css(this.lt)),z=this.dimension(x);this.rtl&&!this.vertical?w+=z:w-=z,this.list().css(this.lt,w+"px")}this._scroll(x,e,m)}else{this._scroll(Math.max(q-A,0),e,m)}}else{this._scroll(j,e,m)}}}}else{this._scroll(C.target,e,m)}return this._trigger("scrollend"),this},_scroll:function(g,j,f){if(this.animating){return b.isFunction(f)&&f.call(this,!1),this}typeof g!="object"?g=this.items().eq(g):typeof g.jquery=="undefined"&&(g=b(g));if(g.size()===0){return b.isFunction(f)&&f.call(this,!1),this}this.inTail=!1,this._prepare(g);var h=this._position(g),k=d(this.list().css(this.lt));if(h===k){return b.isFunction(f)&&f.call(this,!1),this}var e={};return e[this.lt]=h+"px",this._animate(e,j,f),this},_scrollTail:function(f,h){if(this.animating||!this.tail){return b.isFunction(h)&&h.call(this,!1),this}var g=this.list().position()[this.lt];this.rtl?g+=this.tail:g-=this.tail,this.inTail=!0;var e={};return e[this.lt]=g+"px",this._update({target:this._target.next(),fullyvisible:this._fullyvisible.slice(1).add(this._visible.last())}),this._animate(e,f,h),this},_animate:function(g,l,j){if(!1===this._trigger("animate")){return b.isFunction(j)&&j.call(this,!1),this}this.animating=!0;var f=this.options("animation");if(!f||l===!1){this.list().css(g),this.onAnimationComplete(j)}else{var h=this;if(b.isFunction(f)){f.call(this,g,function(){h.onAnimationComplete(j)})}else{var k=typeof f=="object"?f:{duration:f},e=k.complete;k.complete=function(){h.onAnimationComplete(j),b.isFunction(e)&&e.call(this)},this.list().animate(g,k)}}return this},_prepare:function(q){var e=q.index(),j=e,v=this.dimension(q),g=this.clipping(),n=this.vertical?"bottom":this.rtl?"left":"right",m={target:q,first:q,last:q,visible:q,fullyvisible:v<=g?q:b()},k,h;this.options("center")&&(v/=2,g/=2);if(v<g){for(;;){k=this.items().eq(++j);if(k.size()===0){if(!this.circular){break}k=this.items().eq(0);if(q.get(0)===k.get(0)){break}k.after(k.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(k),this._items=null}v+=this.dimension(k),m.last=k,m.visible=m.visible.add(k),h=d(k.css("margin-"+n)),v-h<=g&&(m.fullyvisible=m.fullyvisible.add(k));if(v>=g){break}}}if(!this.circular&&v<g){j=e;for(;;){if(--j<0){break}k=this.items().eq(j);if(k.size()===0){break}v+=this.dimension(k),m.first=k,m.visible=m.visible.add(k),h=d(k.css("margin-"+n)),v-h<=g&&(m.fullyvisible=m.fullyvisible.add(k));if(v>=g){break}}}return this._update(m),this.tail=0,this.options("wrap")!=="circular"&&this.options("wrap")!=="custom"&&m.last.index()===this.items().size()-1&&(v-=d(m.last.css("margin-"+n)),v>g&&(this.tail=v-g)),this},_position:function(g){var f=this._first,h=f.position()[this.lt];return this.rtl&&!this.vertical&&(h-=this.clipping()-this.dimension(f)),this.options("center")&&(h-=this.clipping()/2-this.dimension(f)/2),(g.index()>f.index()||this.inTail)&&this.tail?(h=this.rtl?h-this.tail:h+this.tail,this.inTail=!0):this.inTail=!1,-h},_update:function(f){var k=this,h={target:this._target||b(),first:this._first||b(),last:this._last||b(),visible:this._visible||b(),fullyvisible:this._fullyvisible||b()},e=(f.first||h.first).index()<h.first.index(),g,j=function(m){var n=[],l=[];f[m].each(function(){h[m].index(this)<0&&n.push(this)}),h[m].each(function(){f[m].index(this)<0&&l.push(this)}),e?n=n.reverse():l=l.reverse(),k._trigger("item"+m+"in",b(n)),k._trigger("item"+m+"out",b(l)),k["_"+m]=f[m]};for(g in f){j(g)}return this}})}(jQuery,window),function(a){a.jcarousel.fn.scrollIntoView=function(v,e,b){var h=this.items(),w=typeof v!="object"?v:h.index(v),d=this._fullyvisible.first().index();if(w<d){return this.scroll(w,e,b)}if(w>=d&&w<=this._fullyvisible.last().index()){return a.isFunction(b)&&b.call(this,!1),this}var q=this.clipping(),m=this.vertical?"bottom":this.rtl?"left":"right",j=0,g;for(;;){g=h.eq(w);if(g.size()===0){break}j+=this.dimension(g);if(j>=q){var k=parseFloat(g.css("margin-"+m))||0;j-k!==q&&w++;break}if(w<=0){break}w--}return this.scroll(w,e,b)}}(jQuery),function(a){a.jCarousel.plugin("jcarouselControl",{_options:{target:"+=1",event:"click"},_active:null,_init:function(){this.onDestroy=a.proxy(function(){this._destroy(),this.carousel().one("createend.jcarousel",a.proxy(this._create,this))},this),this.onReload=a.proxy(this._reload,this),this.onEvent=a.proxy(function(b){b.preventDefault(),this.carousel().jcarousel("scroll",this.options("target"))},this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy).bind("reloadend.jcarousel scrollend.jcarousel",this.onReload),this._element.bind(this.options("event")+".jcarouselcontrol",this.onEvent),this._reload()},_destroy:function(){this._element.unbind(".jcarouselcontrol",this.onEvent),this.carousel().unbind("destroy.jcarousel",this.onDestroy).unbind("reloadend.jcarousel scrollend.jcarousel",this.onReload)},_reload:function(){var d=a.jCarousel.parseTarget(this.options("target")),f=this.carousel(),e;if(d.relative){e=f.jcarousel(d.target>0?"hasNext":"hasPrev")}else{var b=typeof d.target!="object"?f.jcarousel("items").eq(d.target):d.target;e=f.jcarousel("target").index(b)>=0}return this._active!==e&&(this._trigger(e?"active":"inactive"),this._active=e),this}})}(jQuery),function(a){a.jCarousel.plugin("jcarouselPagination",{_options:{perPage:null,item:function(b){return'<a href="#'+b+'">'+b+"</a>"}},_pages:{},_items:{},_init:function(){this.onDestroy=a.proxy(function(){this._destroy(),this.carousel().one("createend.jcarousel",a.proxy(this._create,this))},this),this.onReload=a.proxy(this._reload,this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy).bind("reloadend.jcarousel",this.onReload),this._reload()},_destroy:function(){a.fn.jcarouselControl&&a.each(this._items,function(d,b){b.jcarouselControl("destroy")}),this._element.empty(),this.carousel().unbind("destroy.jcarousel",this.onDestroy).unbind("reloadend.jcarousel",this.onReload)},_reload:function(){var l=this.options("perPage");this._pages={},this._items={},a.isFunction(l)&&(l=l.call(this));if(l==null){this._pages=this._calculatePages()}else{var e=parseInt(l,10)||0,b=this.carousel().jcarousel("items"),g=1,m=0,d;for(;;){d=b.eq(m++);if(d.size()===0){break}this._pages[g]?this._pages[g]=this._pages[g].add(d):this._pages[g]=d,m%e===0&&g++}}var k=this,j=this._element.empty(),h=this.options("item");a.each(this._pages,function(f,q){var o=k._items[f]=a(h.call(k,f,q));j.append(o),a.fn.jcarouselControl&&o.jcarouselControl({carousel:k.carousel(),target:q.eq(0)})})},items:function(){return this._items},_calculatePages:function(){var j=this.carousel().data("jcarousel"),f=j.items(),l=j.clipping(),h=0,d=0,g=1,k={},b;for(;;){b=f.eq(d++);if(b.size()===0){break}k[g]?k[g]=k[g].add(b):k[g]=b,h+=j.dimension(b),h>=l&&(g++,h=0)}return k}})}(jQuery),function(a){a.jCarousel.plugin("jcarouselAutoscroll",{_options:{target:"+=1",interval:3000,autostart:!0},_timer:null,_init:function(){this.onDestroy=a.proxy(function(){this._destroy(),this.carousel().one("createend.jcarousel",a.proxy(this._create,this))},this),this.onAnimateEnd=a.proxy(this.start,this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy),this.options("autostart")&&this.start()},_destroy:function(){this.stop(),this.carousel().unbind("destroy.jcarousel",this.onDestroy)},start:function(){return this.stop(),this.carousel().one("animateend.jcarousel",this.onAnimateEnd),this._timer=setTimeout(a.proxy(function(){this.carousel().jcarousel("scroll",this.options("target"))},this),this.options("interval")),this},stop:function(){return this._timer&&(this._timer=clearTimeout(this._timer)),this.carousel().unbind("animateend.jcarousel",this.onAnimateEnd),this}})}(jQuery);(function($){$.fn.editable=function(target,options){if("disable"==target){$(this).data("disabled.editable",true);return}if("enable"==target){$(this).data("disabled.editable",false);return}if("destroy"==target){$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");return}var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types.defaults.buttons;var content=$.editable.types[settings.type].content||$.editable.types.defaults.content;var element=$.editable.types[settings.type].element||$.editable.types.defaults.element;var reset=$.editable.types[settings.type].reset||$.editable.types.defaults.reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr("title",settings.tooltip)}settings.autowidth="auto"==settings.width;settings.autoheight="auto"==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data("event.editable",settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder)}$(this).bind(settings.event,function(e){if(true===$(this).data("disabled.editable")){return}if(self.editing){return}if(false===onedit.apply(this,[settings,self])){return}e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr("title")}if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight}else{if(settings.width!="none"){settings.width=settings.autowidth?$(self).width():settings.width}if(settings.height!="none"){settings.height=settings.autoheight?$(self).height():settings.height}}if($(this).html().toLowerCase().replace(/(;|")/g,"")==settings.placeholder.toLowerCase().replace(/(;|")/g,"")){$(this).html("")}self.editing=true;self.revert=$(self).html();$(self).html("");var form=$("<form />");if(settings.cssclass){if("inherit"==settings.cssclass){form.attr("class",$(self).attr("class"))}else{form.attr("class",settings.cssclass)}}if(settings.style){if("inherit"==settings.style){form.attr("style",$(self).attr("style"));form.css("display",$(self).css("display"))}else{form.attr("style",settings.style)}}var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self])},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]))}else{$.extend(loaddata,settings.loaddata)}$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false}})}else{if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings])}}else{input_content=self.revert}}content.apply(form,[input_content,settings,self]);input.attr("name",settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(":input:visible:enabled:first",form).focus();if(settings.select){input.select()}input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self])}});var t;if("cancel"==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self])},500)})}else{if("submit"==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit()},200)})}else{if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings])})}else{input.blur(function(e){})}}}form.submit(function(e){if(t){clearTimeout(t)}e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]))}else{$.extend(submitdata,settings.submitdata)}if("PUT"==settings.method){submitdata._method="put"}$(self).html(settings.indicator);var ajaxoptions={type:"POST",data:submitdata,dataType:"html",url:settings.target,success:function(result,status){if(ajaxoptions.dataType=="html"){$(self).html(result)}self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr])}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions)}}}$(self).attr("title",settings.tooltip);return false})});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder)}if(settings.tooltip){$(self).attr("title",settings.tooltip)}}}}})};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input)},content:function(string,settings,original){$(":input:first",this).val(string)},reset:function(settings,original){original.reset(this)},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit()}})}else{var submit=$('<button type="submit" />');submit.html(settings.submit)}$(this).append(submit)}if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel)}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel)}$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset}else{var reset=$.editable.types.defaults.reset}reset.apply(form,[settings,original]);return false})}}},text:{element:function(settings,original){var input=$("<input />");if(settings.width!="none"){input.width(settings.width)}if(settings.height!="none"){input.height(settings.height)}input.attr("autocomplete","off");$(this).append(input);return(input)}},textarea:{element:function(settings,original){var textarea=$("<textarea />");if(settings.rows){textarea.attr("rows",settings.rows)}else{if(settings.height!="none"){textarea.height(settings.height)}}if(settings.cols){textarea.attr("cols",settings.cols)}else{if(settings.width!="none"){textarea.width(settings.width)}}$(this).append(textarea);return(textarea)}},select:{element:function(settings,original){var select=$("<select />");$(this).append(select);return(select)},content:function(data,settings,original){if(String==data.constructor){eval("var json = "+data)}else{var json=data}for(var key in json){if(!json.hasOwnProperty(key)){continue}if("selected"==key){continue}var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){if($(this).val()==json.selected||$(this).text()==$.trim(original.revert)){$(this).attr("selected","selected")}})}}},addInputType:function(name,input){$.editable.types[name]=input}};$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}})(jQuery);(function(j){var f={bgChange:true,bgColors:["fuchsia","lime","yellow","aqua"],bgReset:true,dest:null,fName:"jLog",logPHP:"/~lib/jLog.php",outline:true,tLen:40,wantHTML:true,wantTime:false};var b=f;var g=0;var d=2;var e=[];var o={outline:"2px dotted fuchsia"};var n={outline:"2px dotted lime"};var m={outline:"2px dotted yellow"};var l={outline:"2px dotted aqua"};e[0]=o;e[1]=n;e[2]=m;e[3]=l;j.fn.jLog=function(r){b=j.extend(f,r);dest=b.dest;console.log(b);work="$('"+this.selector+"').jLog(";if(r){work+=k(r)+");"}else{work+=");"}if(dest=="file"){a(work,"new")}else{j.log(work,"war",dest)}return this.each(function(){q(this,dest)})};function k(r){var v="{";var u=0;for(var s in r){if(u>0){v+=", "}v+='"'+s+'":"'+r[s]+'"';u++}v+="}";return v}function q(v,J){var K=v.tagName.toLowerCase();var s=" #"+v.id;var G=" ."+v.className;var B=j(v).parent();p=" #parent:"+j(B).attr("id");var A=j(v).offset();var H=" x:"+A.left;var F=" y:"+A.top;var I=" w:"+j(v).css("width");var D=" z:"+j(v).css("z-index");var E=" pos:"+j(v).css("position");var C=" zp:"+j(B).css("z-index");var L=j(v).text().substr(0,20);txt=" txt:"+L;work=K+s+G+H+F+I+D+E+txt+p;if(b.wantHTML){j.log(work,"group",J);sHTML=j("<div>").append(j(v).clone()).html();j.log("html","group-",J);j.log(sHTML,"gre",J)}else{j.log(work,"",J)}j.log("","gre",J);if(b.bgChange){if(j(v).css("background-color")!=b.bgColors[g]){j(v).css("background-color",b.bgColors[g])}else{j(v).css("background-color","")}var u=" bg:"+b.bgColors[g];g++;if(g>=b.bgColors.length){g=0}}else{var u=" bg:"+j(v).css("background-color")}var r=" fg:"+j(v).css("color");if(b.outline){j(v).css(e[d]);d++;if(d>=b.bgColors.length){d=0}}}jQuery.log=function(w,s,r,v){t=h();if(!r&&window.console&&console.log){var u;if(s){s=s.toLowerCase();u=s.substr(0,3)}switch(u){case"war":console.warn(w);break;case"err":console.error(w);break;case"inf":console.info(w);break;case"tra":console.trace(w);break;case"tim":if(console.time){console.time(w)}break;case"ten":if(console.timeEnd){console.timeEnd(w)}break;case"tab":if(console.table){console.group("table");console.table(w);console.groupEnd("table")}else{console.log(w)}break;case"clr":if(console.clear){console.clear()}console.log(w);break;case"gro":if(console.group){if(s=="group-"){console.groupCollapsed(w)}else{console.group(w)}}else{console.log(w)}if(console.time){console.time(w)}break;case"gre":if(w){console.log(w)}if(console.groupEnd){console.groupEnd()}break;default:if(b.wantTime&&(typeof(w)!="object")){w="{"+t+"} "+w}console.log(w)}if(v){alert(v)}}else{if(r=="file"){if(b.wantTime){w="{"+t+"} "+w}a(w)}else{if(b.wantTime&&(typeof(w)!="object")){w="{"+t+"} "+w}w+="<br>";j(r).append(w)}}return};function a(r,s){if(s){t="_"+h("_");t="";s=t+".txt:init="+s}else{s=".txt:init=x"}jLogParms="jlog="+b.fName+s+":msg="+r;console.log(jLogParms);j.ajax({type:"POST",data:jLogParms,url:b.logPHP,error:function(u){console.error(u)},success:function(u){if(u.substr(0,4)!="~OK:"){console.error(u)}else{}}})}function h(y){if(!y){y=":"}var x=new Date();var w=x.getHours();var r=x.getMinutes()+"";if(r.length==1){r="0"+r}var v=x.getSeconds()+"";if(v.length==1){v="0"+v}var u=w+y+r+y+v;return u}})(jQuery);(function(a){a.fn.jTruncate=function(b){var d={length:300,minTrail:20,moreText:"more",lessText:"less",ellipsisText:"...",moreAni:"",lessAni:""};var b=a.extend(d,b);return this.each(function(){obj=a(this);var e=obj.html();if(e.length>b.length+b.minTrail){var j=e.indexOf(" ",b.length);if(j!=-1){var j=e.indexOf(" ",b.length);var h=e.substring(0,j);var g=e.substring(j,e.length-1);obj.html(h+'<span class="truncate_ellipsis">'+b.ellipsisText+'</span><span class="truncate_more">'+g+"</span>");obj.find(".truncate_more").css("display","none");obj.append('<div class="clearboth"><a href="#" class="truncate_more_link">'+b.moreText+"</a></div>");var l=a(".truncate_more_link",obj);var k=a(".truncate_more",obj);var f=a(".truncate_ellipsis",obj);l.click(function(){if(l.text()==b.moreText){k.show(b.moreAni);l.text(b.lessText);f.css("display","none")}else{k.hide(b.lessAni);l.text(b.moreText);f.css("display","inline")}return false})}}})}})(jQuery);(function($){var conf={},numMSG=20;containerDiv="juitterContainer",loadMSG="Loading messages...",imgName="loader.gif",readMore="Read it on Twitter",nameUser="image",announce_style=false;live:"live-20",aURL="";msgNb=1;var mode,param,time,lang,contDiv,loadMSG,gifName,numMSG,readMore,fromID,ultID,filterWords,announce_style;var running=false;apifMultipleUSER="http://search.twitter.com/search.json?from%3A";apifUSER="http://search.twitter.com/search.json?q=from%3A";apitMultipleUSER="http://search.twitter.com/search.json?to%3A";apitUSER="http://search.twitter.com/search.json?q=to%3A";apiSEARCH="http://search.twitter.com/search.json?q=";$.Juitter={registerVar:function(opt){mode=opt.searchType;param=opt.searchObject;timer=opt.live;lang=opt.lang?opt.lang:"";contDiv=opt.placeHolder?opt.placeHolder:containerDiv;loadMSG=opt.loadMSG?opt.loadMSG:loadMSG;gifName=opt.imgName?opt.imgName:imgName;numMSG=opt.total?opt.total:numMSG;readMore=opt.readMore?opt.readMore:readMore;fromID=opt.nameUser?opt.nameUser:nameUser;filterWords=opt.filter;announce_style=opt.announce_style;openLink=opt.openExternalLinks?"target='_blank'":""},start:function(opt){ultID=0;if($("#"+contDiv)){this.registerVar(opt);this.loading();aURL=this.createURL();this.conectaTwitter(1);if(timer!=undefined&&!running){this.temporizador()}}},update:function(){this.conectaTwitter(2);if(timer!=undefined){this.temporizador()}},loading:function(){if(loadMSG=="image/gif"){$("<img></img>").attr("src",gifName).appendTo("#"+contDiv)}else{$("#"+contDiv).html(loadMSG)}},createURL:function(){var url="";jlg=lang.length>0?"&lang="+lang:jlg="";var seachMult=param.search(/,/);if(seachMult>0){param="&ors="+param.replace(/,/g,"+")}if(mode=="fromUser"&&seachMult<=0){url=apifUSER+param}else{if(mode=="fromUser"&&seachMult>=0){url=apifMultipleUSER+param}else{if(mode=="toUser"&&seachMult<=0){url=apitUSER+param}else{if(mode=="toUser"&&seachMult>=0){url=apitMultipleUSER+param}else{if(mode=="searchWord"){url=apiSEARCH+param+jlg}}}}}url+="&rpp="+numMSG;return url},delRegister:function(){if(msgNb>=numMSG){$(".twittLI").each(function(o,elemLI){if(o>=numMSG){$(this).hide("slow")}})}},conectaTwitter:function(e){$.ajax({url:aURL,type:"GET",dataType:"jsonp",timeout:1000,error:function(){$("#"+contDiv).html("fail#")},success:function(json){if(e==1){$("#"+contDiv).html("")}$.each(json.results,function(i,item){if(e==1||(i<numMSG&&item.id>ultID)){if(i==0){tultID=item.id;$("<ul></ul>").attr("id","twittList"+ultID).attr("class","twittList").prependTo("#"+contDiv)}var dateObj=new Date(item.created_at);if(item.text!="undefined"){var link="http://twitter.com/"+item.from_user+"/status/"+item.id;var tweet=$.Juitter.filter(item.text);if(announce_style){mHTML="<span class='time'>"+dateObj.toLocaleDateString()+" "+dateObj.toLocaleTimeString()+"</span> <span class='tweet'>"+$.Juitter.textFormat(tweet)+"</span>"}else{if(fromID=="image"){mHTML="<a href='http://www.twitter.com/"+item.from_user+"'><img src='"+item.profile_image_url+"' alt='"+item.from_user+"' class='juitterAvatar' /></a> "+$.Juitter.textFormat(tweet)+" -| <span class='time'>"+item.created_at+"</span> |- <a href='"+link+"' class='JRM' "+openLink+">"+readMore+"</a>"}else{mHTML="<a href='http://www.twitter.com/"+item.from_user+"'>@"+item.from_user+":</a> "+$.Juitter.textFormat(tweet)+" -| <span class='time'>"+item.created_at+"</span> |-  <a href='"+link+"' "+openLink+">"+readMore+"</a>"}}$("<li></li>").html(mHTML).attr("id","twittLI"+msgNb).attr("class","twittLI").appendTo("#twittList"+ultID);$("#twittLI"+msgNb).hide();$("#twittLI"+msgNb).show("slow");$.Juitter.delRegister();msgNb++}}});ultID=tultID}})},filter:function(s){if(filterWords){searchWords=filterWords.split(",");if(searchWords.length>0){cleanHTML=s;$.each(searchWords,function(i,item){sW=item.split("->").length>0?item.split("->")[0]:item;rW=item.split("->").length>0?item.split("->")[1]:"";regExp=eval("/"+sW+"/gi");cleanHTML=cleanHTML.replace(regExp,rW)})}else{cleanHTML=s}return cleanHTML}else{return s}},textFormat:function(texto){var exp=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;texto=texto.replace(exp,"<a href='$1' class='extLink' "+openLink+">$1</a>");var exp=/[\@]+([A-Za-z0-9-_]+)/ig;texto=texto.replace(exp,"<a href='http://twitter.com/$1' class='profileLink'>@$1</a>");var exp=/[\#]+([A-Za-z0-9-_]+)/ig;texto=texto.replace(exp,"<a href='http://juitter.com/#$1' onclick='$.Juitter.start({searchType:\"searchWord\",searchObject:\"$1\"});return false;' class='hashLink'>#$1</a>");if(mode=="searchWord"){tempParam=param.replace(/&ors=/,"");arrParam=tempParam.split("+");$.each(arrParam,function(i,item){regExp=eval("/"+item+"/gi");newString=new String(" <b>"+item+"</b> ");texto=texto.replace(regExp,newString)})}return texto},temporizador:function(){running=true;aTim=timer.split("-");if(aTim[0]=="live"&&aTim[1].length>0){tempo=aTim[1]*1000;setTimeout("$.Juitter.update()",tempo)}}}})(jQuery);(function(a){a.fn.lightBox=function(s){s=jQuery.extend({overlayBgColor:"#000",overlayOpacity:0.8,fixedNavigation:false,imageLoading:"images/lightbox-ico-loading.gif",imageBtnPrev:"images/lightbox-btn-prev.gif",imageBtnNext:"images/lightbox-btn-next.gif",imageBtnClose:"images/lightbox-btn-close.gif",imageBlank:"images/lightbox-blank.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},s);var k=this;function v(){r(this,k);return false}function r(z,y){a("embed, object, select").css({visibility:"hidden"});d();s.imageArray.length=0;s.activeImage=0;if(y.length==1){s.imageArray.push(new Array(z.getAttribute("href"),z.getAttribute("title")))}else{for(var x=0;x<y.length;x++){s.imageArray.push(new Array(y[x].getAttribute("href"),y[x].getAttribute("title")))}}while(s.imageArray[s.activeImage][0]!=z.getAttribute("href")){s.activeImage++}n()}function d(){a("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+s.imageLoading+'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnClose"><img src="'+s.imageBtnClose+'"></a></div></div></div></div>');var x=g();a("#jquery-overlay").css({backgroundColor:s.overlayBgColor,opacity:s.overlayOpacity,width:x[0],height:x[1]}).fadeIn();var y=j();a("#jquery-lightbox").css({top:y[1]+(x[3]/10),left:y[0]}).show();a("#jquery-overlay,#jquery-lightbox").click(function(){b()});a("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){b();return false});a(window).resize(function(){var z=g();a("#jquery-overlay").css({width:z[0],height:z[1]});var A=j();a("#jquery-lightbox").css({top:A[1]+(z[3]/10),left:A[0]})})}function n(){a("#lightbox-loading").show();if(s.fixedNavigation){a("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide()}else{a("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide()}var x=new Image();x.onload=function(){a("#lightbox-image").attr("src",s.imageArray[s.activeImage][0]);l(x.width,x.height);x.onload=function(){}};x.src=s.imageArray[s.activeImage][0]}function l(A,D){var x=a("#lightbox-container-image-box").width();var C=a("#lightbox-container-image-box").height();var B=(A+(s.containerBorderSize*2));var z=(D+(s.containerBorderSize*2));var y=x-B;var E=C-z;a("#lightbox-container-image-box").animate({width:B,height:z},s.containerResizeSpeed,function(){h()});if((y==0)&&(E==0)){if(a.browser.msie){q(250)}else{q(100)}}a("#lightbox-container-image-data-box").css({width:A});a("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:D+(s.containerBorderSize*2)})}function h(){a("#lightbox-loading").hide();a("#lightbox-image").fadeIn(function(){m();w()});u()}function m(){a("#lightbox-container-image-data-box").slideDown("fast");a("#lightbox-image-details-caption").hide();if(s.imageArray[s.activeImage][1]){a("#lightbox-image-details-caption").html(s.imageArray[s.activeImage][1]).show()}if(s.imageArray.length>1){a("#lightbox-image-details-currentNumber").html(s.txtImage+" "+(s.activeImage+1)+" "+s.txtOf+" "+s.imageArray.length).show()}}function w(){a("#lightbox-nav").show();a("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url("+s.imageBlank+") no-repeat"});if(s.activeImage!=0){if(s.fixedNavigation){a("#lightbox-nav-btnPrev").css({background:"url("+s.imageBtnPrev+") left 15% no-repeat"}).unbind().bind("click",function(){s.activeImage=s.activeImage-1;n();return false})}else{a("#lightbox-nav-btnPrev").unbind().hover(function(){a(this).css({background:"url("+s.imageBtnPrev+") left 15% no-repeat"})},function(){a(this).css({background:"transparent url("+s.imageBlank+") no-repeat"})}).show().bind("click",function(){s.activeImage=s.activeImage-1;n();return false})}}if(s.activeImage!=(s.imageArray.length-1)){if(s.fixedNavigation){a("#lightbox-nav-btnNext").css({background:"url("+s.imageBtnNext+") right 15% no-repeat"}).unbind().bind("click",function(){s.activeImage=s.activeImage+1;n();return false})}else{a("#lightbox-nav-btnNext").unbind().hover(function(){a(this).css({background:"url("+s.imageBtnNext+") right 15% no-repeat"})},function(){a(this).css({background:"transparent url("+s.imageBlank+") no-repeat"})}).show().bind("click",function(){s.activeImage=s.activeImage+1;n();return false})}}o()}function o(){a(document).keydown(function(x){e(x)})}function f(){a(document).unbind()}function e(x){if(x==null){keycode=event.keyCode;escapeKey=27}else{keycode=x.keyCode;escapeKey=x.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();if((key==s.keyToClose)||(key=="x")||(keycode==escapeKey)){b()}if((key==s.keyToPrev)||(keycode==37)){if(s.activeImage!=0){s.activeImage=s.activeImage-1;n();f()}}if((key==s.keyToNext)||(keycode==39)){if(s.activeImage!=(s.imageArray.length-1)){s.activeImage=s.activeImage+1;n();f()}}}function u(){if((s.imageArray.length-1)>s.activeImage){objNext=new Image();objNext.src=s.imageArray[s.activeImage+1][0]}if(s.activeImage>0){objPrev=new Image();objPrev.src=s.imageArray[s.activeImage-1][0]}}function b(){a("#jquery-lightbox").remove();a("#jquery-overlay").fadeOut(function(){a("#jquery-overlay").remove()});a("embed, object, select").css({visibility:"visible"})}function g(){var z,x;if(window.innerHeight&&window.scrollMaxY){z=window.innerWidth+window.scrollMaxX;x=window.innerHeight+window.scrollMaxY}else{if(document.body.scrollHeight>document.body.offsetHeight){z=document.body.scrollWidth;x=document.body.scrollHeight}else{z=document.body.offsetWidth;x=document.body.offsetHeight}}var y,A;if(self.innerHeight){if(document.documentElement.clientWidth){y=document.documentElement.clientWidth}else{y=self.innerWidth}A=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){y=document.documentElement.clientWidth;A=document.documentElement.clientHeight}else{if(document.body){y=document.body.clientWidth;A=document.body.clientHeight}}}if(x<A){pageHeight=A}else{pageHeight=x}if(z<y){pageWidth=z}else{pageWidth=y}arrayPageSize=new Array(pageWidth,pageHeight,y,A);return arrayPageSize}function j(){var y,x;if(self.pageYOffset){x=self.pageYOffset;y=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){x=document.documentElement.scrollTop;y=document.documentElement.scrollLeft}else{if(document.body){x=document.body.scrollTop;y=document.body.scrollLeft}}}arrayPageScroll=new Array(y,x);return arrayPageScroll}function q(z){var y=new Date();x=null;do{var x=new Date()}while(x-y<z)}return this.unbind("click").click(v)}})(jQuery);(function(a){a.beaconWrap=function(b){return function(g){var f=this.nodeName==="A"?a(this):a(g.target).closest("a"),e=f.attr("href"),h=f.attr("target"),d=f.length&&e&&g.which===1&&!g.metaKey&&!g.shiftKey;if(b.call(this,g)===false){d=false}if(d&&h&&h!=="_self"){d=false}if(d&&f.hasClass("no-hjack")){d=false}ted.log("beaconWrap hijack? "+(d?"YES":"NO"));if(d){window.setTimeout(function(){window.location.href=e},50);return false}else{return true}}};a.fn.beaconClick=function(b){this.on("click",a.beaconWrap(b));return this}}(jQuery));(function(a){a.nano=function(b,d){return b.replace(/\{([\w\.]*)}/g,function(h,e){var f=e.split("."),g=d[f.shift()];a.each(f,function(){g=g[this]});return g})}})(jQuery);jQuery.fn.extend({ParseClass:function(){var classes=this[0].className.split(" ");for(var i=0,c;c=classes[i];i++){c=c.replace(/'/g,'"');try{var obj=eval("("+c+")");return obj}catch(e){}}return{}}});(function(a){a.fn.popover=function(n){var h=27;var g=a.extend({id:"",openEvent:null,closeEvent:null,offsetX:0,offsetY:0,zindex:100000,padding:18,closeOnEsc:true,preventLeft:false,preventRight:false,preventTop:false,preventBottom:false,live:false},n||{});function m(o,r){var q={left:false,right:false,top:false,bottom:false};if(r.buttonOffset.top+r.buttonHeight+r.triangleSize+r.popoverHeight<=r.viewportBottom-g.padding){q.bottom=true}if(r.buttonOffset.top-r.triangleSize-r.popoverHeight>=r.viewportTop+g.padding){q.top=true}if(r.buttonOffset.left+r.buttonWidth+r.triangleSize+r.popoverWidth<=r.viewportRight-g.padding){q.right=true}if(r.buttonOffset.left-r.triangleSize-r.popoverWidth>=r.viewportLeft+g.padding){q.left=true}return q}function j(q){if(g.preventBottom){q.bottom=false}if(g.preventTop){q.top=false}if(g.preventLeft){q.left=false}if(g.preventRight){q.right=false}var o="right";if(g.preventRight){o="bottom"}if(g.preventBottom){o="top"}if(g.preventTop){o="left"}if(q.top){o="top"}else{if(q.bottom){o="bottom"}else{if(q.left){o="left"}else{if(q.right){o="right"}}}}return o}function k(o){g.popover$.css("display","block");var r={popoverDir:"bottom",popoverX:0,popoverY:0,deltaX:0,deltaY:0,triangleX:0,triangleY:0,triangleSize:12,viewportTop:a(window).scrollTop(),viewportLeft:a(window).scrollLeft(),viewportBottom:a(window).height()+a(window).scrollTop(),viewportRight:a(window).width()+a(window).scrollLeft(),docWidth:a(window).width(),docHeight:a(window).height(),popoverWidth:g.popover$.outerWidth(),popoverHeight:g.popover$.outerHeight(),buttonWidth:o.outerWidth(),buttonHeight:o.outerHeight(),buttonOffset:o.offset()};var q=m(o,r);r.popoverDir=j(q);if(r.popoverDir=="bottom"){r.popoverY=r.buttonOffset.top+r.buttonHeight+r.triangleSize}else{if(r.popoverDir=="top"){r.popoverY=r.buttonOffset.top-r.triangleSize-r.popoverHeight}else{r.popoverY=r.buttonOffset.top+(r.buttonHeight-r.popoverHeight)/2}}if((r.popoverDir=="bottom")||(r.popoverDir=="top")){r.popoverX=r.buttonOffset.left+(r.buttonWidth-r.popoverWidth)/2;if(r.popoverX<g.padding){r.deltaX=r.popoverX-g.padding}else{if(r.popoverX+r.popoverWidth>r.docWidth-g.padding){r.deltaX=r.popoverX+r.popoverWidth-r.docWidth+g.padding}}r.triangleX=r.popoverWidth/2-r.triangleSize+r.deltaX;r.triangleY=0}else{if(r.popoverDir=="right"){r.popoverX=r.buttonOffset.left+r.buttonWidth+r.triangleSize}else{r.popoverX=r.buttonOffset.left-r.triangleSize-r.popoverWidth}if(r.popoverY<g.padding){r.deltaY=r.popoverY-g.padding}else{if(r.popoverY+r.popoverHeight>r.docHeight-g.padding){r.deltaY=r.popoverY+r.popoverHeight-r.docHeight+g.padding}}r.triangleX=0;r.triangleY=r.popoverHeight/2-r.triangleSize+r.deltaY}return r}function b(o){g.triangle$.removeClass("left top right bottom");g.triangle$.addClass(o.popoverDir);if(o.triangleX>0){g.triangle$.css("left",o.triangleX)}if(o.triangleY>0){g.triangle$.css("top",o.triangleY)}g.popover$.offset({top:o.popoverY-o.deltaY+g.offsetY,left:o.popoverX-o.deltaX+g.offsetX});g.popover$.css("z-index",g.zindex).show()}function l(q,o){if(g.popover$.parent().length==0){g.popover$.appendTo("body")}if(a.fn.popover.openedPopup&&(a.fn.popover.openedPopup.get(0)===q.get(0))){if(!o){d()}return}d();g.triangle$.click(function(){q.trigger("hidePopover")});g.triangle$.attr("style","");b(k(q));setTimeout(function(){g.popover$.addClass("active")},0);if(a.isFunction(g.openEvent)){g.openEvent(q)}a.fn.popover.openedPopup=q;q.addClass("popover-on");a(document).trigger("popoverOpened")}function f(o){o.removeClass("popover-on");a(document).trigger("popoverClosed");g.popover$.removeClass("active").attr("style","").hide();if(a.isFunction(g.closeEvent)){g.closeEvent(o)}a.fn.popover.openedPopup=null}function d(){if(a.fn.popover.openedPopup!=null){a.fn.popover.openedPopup.trigger("hidePopover")}}g.popover$=a('<div class="popover" id="'+g.id+'"><div class="triangle"><div class="outer"></div><div class="inner"></div></div><div class="popover-header"></div><div class="popover-content"></div></div>');a(".popover-header",g.popover$).append(a(g.header).detach());a(".popover-content",g.popover$).append(a(g.content).detach());g.triangle$=a(".triangle",g.popover$);a.fn.popover.openedPopup=null;a(document).unbind(".popover");a(document).bind("click.popover",function(o){if((a(o.target).parents(".popover").length==0)&&(!a(o.target).hasClass("popover-button"))){d()}});a(document).bind("hideOpenPopover.popover",d);var e=this;if(g.closeOnEsc){a(document).bind("keydown",function(o){if(a.fn.popover.openedPopup==null){return}if(!o.altKey&&!o.ctrlKey&&!o.shiftKey&&(o.keyCode==h)){e.trigger("hidePopover")}})}if(!g.live){return this.each(function(){var o=a(this);o.addClass("popover-button");o.bind("click",function(){l(o);return false});o.bind("showPopover",function(){l(o,true);return false});o.bind("hidePopover",function(){f(o);return false})})}else{this.live("click",function(o){a(o.target).addClass("popover-button");l(a(o.target));return false});this.live("showPopover",function(o){a(o.target).addClass("popover-button");l(a(o.target),true);return false});this.live("hidePopover",function(o){f(a(o.target));return false});return this}}})(jQuery);(function(f){var d={},e=/\{%/;f.template=function(x,q,s,b){var u="replace",o="split",v="join",a="jquery:template",y,w,r;if(typeof x!=="boolean"){b=s;s=q;q=x;x=true}if(q in d){r=d[q]}else{if(f.trim(q).length&&!e.test(q)){f.ajax({url:q,dataType:"text",async:false,success:function(g){r=f.template(false,g);if(x){d[q]=r}}})}else{y="var __=[];__.push('"+q[u](/[\r\t\n]/g," ")[o]("{%")[v]("\t")[u](/((^|%\})[^\t]*)'/g,"$1\r")[o]("'")[v]("\\'")[u](/\t=(.*?)%\}/g,"',$1,'")[o]("\t")[v]("');")[o]("%}")[v](";__.push('")[o]("\r")[v]("\\'")+"');return __.join('');";w=new Function("__index__",y);r=function(g,j){var h=f.isArray(g)?f.map(g,function(k,l){return w.call(k,l)}).join(""):w.call(g);return j?h:c("<"+a+">"+h+"</"+a+">")};r.toString=function(){return w.toString()};if(w.toSource){r.toSource=function(){return w.toSource()}}if(x){d[q]=r}}}return s?r(s,b):r};f.fn.template=function(b,j){var h=this[0],a=h&&h.nodeName;return f.template(a&&this[a.toUpperCase()==="TEXTAREA"?"val":"html"]()||"",b,j)}})(jQuery);jQuery.fn.extend({everyTime:function(a,b,d,e){return this.each(function(){jQuery.timer.add(this,a,b,d,e)})},oneTime:function(a,b,d){return this.each(function(){jQuery.timer.add(this,a,b,d,1)})},stopTime:function(a,b){return this.each(function(){jQuery.timer.remove(this,a,b)})}});jQuery.extend({timer:{global:[],guid:1,dataKey:"jQuery.timer",regex:/^([0-9]+(?:\.[0-9]*)?)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1000,das:10000,hs:100000,ks:1000000},timeParse:function(d){if(d==undefined||d==null){return null}var a=this.regex.exec(jQuery.trim(d.toString()));if(a[2]){var b=parseFloat(a[1]);var e=this.powers[a[2]]||1;return b*e}else{return d}},add:function(e,b,d,g,j){var a=0;if(jQuery.isFunction(d)){if(!j){j=g}g=d;d=b}b=jQuery.timer.timeParse(b);if(typeof b!="number"||isNaN(b)||b<0){return}if(typeof j!="number"||isNaN(j)||j<0){j=0}j=j||0;var h=jQuery.data(e,this.dataKey)||jQuery.data(e,this.dataKey,{});if(!h[d]){h[d]={}}g.timerID=g.timerID||this.guid++;var f=function(){if((++a>j&&j!==0)||g.call(e,a)===false){jQuery.timer.remove(e,d,g)}};f.timerID=g.timerID;if(!h[d][g.timerID]){h[d][g.timerID]=window.setInterval(f,b)}this.global.push(e)},remove:function(d,b,e){var f=jQuery.data(d,this.dataKey),a;if(f){if(!b){for(b in f){this.remove(d,b,e)}}else{if(f[b]){if(e){if(e.timerID){window.clearInterval(f[b][e.timerID]);delete f[b][e.timerID]}}else{for(var e in f[b]){window.clearInterval(f[b][e]);delete f[b][e]}}for(a in f[b]){break}if(!a){a=null;delete f[b]}}}for(a in f){break}if(!a){jQuery.removeData(d,this.dataKey)}}}}});jQuery(window).bind("unload",function(){jQuery.each(jQuery.timer.global,function(a,b){jQuery.timer.remove(b)})});(function(f){var b={},m,o,r,l=f.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),a=false;f.tooltip={blocked:false,defaults:{delay:200,fade:false,showURL:true,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){f.tooltip.blocked=!f.tooltip.blocked}};f.fn.extend({tooltip:function(s){s=f.extend({},f.tooltip.defaults,s);j(s);return this.each(function(){f.data(this,"tooltip",s);this.tOpacity=b.parent.css("opacity");this.tooltipText=this.title;f(this).removeAttr("title");this.alt=""}).mouseover(n).mouseout(g).click(g)},fixPNG:l?function(){return this.each(function(){var s=f(this).css("backgroundImage");if(s.match(/^url\(["']?(.*\.png)["']?\)$/i)){s=RegExp.$1;f(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+s+"')"}).each(function(){var u=f(this).css("position");if(u!="absolute"&&u!="relative"){f(this).css("position","relative")}})}})}:function(){return this},unfixPNG:l?function(){return this.each(function(){f(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){f(this)[f(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}});function j(s){if(b.parent){return}b.parent=f('<div id="'+s.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide();if(f.fn.bgiframe){b.parent.bgiframe()}b.title=f("h3",b.parent);b.body=f("div.body",b.parent);b.url=f("div.url",b.parent)}function d(s){return f.data(s,"tooltip")}function h(s){if(d(this).delay){r=setTimeout(q,d(this).delay)}else{q()}a=!!d(this).track;f(document.body).bind("mousemove",e);e(s)}function n(){if(f.tooltip.blocked||this==m||(!this.tooltipText&&!d(this).bodyHandler)){return}m=this;o=this.tooltipText;if(d(this).bodyHandler){b.title.hide();var w=d(this).bodyHandler.call(this);if(w.nodeType||w.jquery){b.body.empty().append(w)}else{b.body.html(w)}b.body.show()}else{if(d(this).showBody){var v=o.split(d(this).showBody);b.title.html(v.shift()).show();b.body.empty();for(var u=0,s;(s=v[u]);u++){if(u>0){b.body.append("<br/>")}b.body.append(s)}b.body.hideWhenEmpty()}else{b.title.html(o).show();b.body.hide()}}if(d(this).showURL&&f(this).url()){b.url.html(f(this).url().replace("http://","")).show()}else{b.url.hide()}b.parent.addClass(d(this).extraClass);if(d(this).fixPNG){b.parent.fixPNG()}h.apply(this,arguments)}function q(){r=null;if((!l||!f.fn.bgiframe)&&d(m).fade){if(b.parent.is(":animated")){b.parent.stop().show().fadeTo(d(m).fade,m.tOpacity)}else{b.parent.is(":visible")?b.parent.fadeTo(d(m).fade,m.tOpacity):b.parent.fadeIn(d(m).fade)}}else{b.parent.show()}e()}function e(x){if(f.tooltip.blocked){return}if(x&&x.target.tagName=="OPTION"){return}if(!a&&b.parent.is(":visible")){f(document.body).unbind("mousemove",e)}if(m==null){f(document.body).unbind("mousemove",e);return}b.parent.removeClass("viewport-right").removeClass("viewport-bottom");var z=b.parent[0].offsetLeft;var y=b.parent[0].offsetTop;if(x){z=x.pageX+d(m).left;y=x.pageY+d(m).top;var u="auto";if(d(m).positionLeft){u=f(window).width()-z;z="auto"}b.parent.css({left:z,right:u,top:y})}var s=k(),w=b.parent[0];if(s.x+s.cx<w.offsetLeft+w.offsetWidth){z-=w.offsetWidth+20+d(m).left;b.parent.css({left:z+"px"}).addClass("viewport-right")}if(s.y+s.cy<w.offsetTop+w.offsetHeight){y-=w.offsetHeight+20+d(m).top;b.parent.css({top:y+"px"}).addClass("viewport-bottom")}}function k(){return{x:f(window).scrollLeft(),y:f(window).scrollTop(),cx:f(window).width(),cy:f(window).height()}}function g(v){if(f.tooltip.blocked){return}if(r){clearTimeout(r)}m=null;var u=d(this);function s(){b.parent.removeClass(u.extraClass).hide().css("opacity","")}if((!l||!f.fn.bgiframe)&&u.fade){if(b.parent.is(":animated")){b.parent.stop().fadeTo(u.fade,0,s)}else{b.parent.stop().fadeOut(u.fade,s)}}else{s()}if(d(this).fixPNG){b.parent.unfixPNG()}}})(jQuery);(function(a){a.fn.tweet=function(d){var m=a.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:"i said,",auto_join_text_ed:"i",auto_join_text_ing:"i am",auto_join_text_reply:"i replied to",auto_join_text_url:"i was looking at",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join}{text}",comparator:function(o,n){return n.tweet_time-o.tweet_time},filter:function(n){return true}},d);var b=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;function l(q,r){if(typeof q==="string"){var n=q;for(var o in r){var s=r[o];n=n.replace(new RegExp("{"+o+"}","g"),s===null?"":s)}return n}else{return q(r)}}a.extend({tweet:{t:l}});function f(o,n){return function(){var q=[];this.each(function(){q.push(this.replace(o,n))});return a(q)}}a.fn.extend({linkUrl:f(b,function(o){var n=(/^[a-z]+:/i).test(o)?o:"http://"+o;return'<a href="'+n+'">'+o+"</a>"}),linkUser:f(/@(\w+)/gi,'@<a href="http://'+m.twitter_url+'/$1">$1</a>'),linkHash:f(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="http://'+m.twitter_search_url+"/search?q=&tag=$1&lang=all"+((m.username&&m.username.length==1)?"&from="+m.username.join("%2BOR%2B"):"")+'">#$1</a>'),capAwesome:f(/\b(awesome)\b/gi,'<span class="awesome">$1</span>'),capEpic:f(/\b(epic)\b/gi,'<span class="epic">$1</span>'),makeHeart:f(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});function k(n){return Date.parse(n.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function h(n){var q=(arguments.length>1)?arguments[1]:new Date();var s=parseInt((q.getTime()-n)/1000,10);var o="";if(s<60){o=s+" seconds ago"}else{if(s<120){o="a minute ago"}else{if(s<(45*60)){o=(parseInt(s/60,10)).toString()+" minutes ago"}else{if(s<(2*60*60)){o="an hour ago"}else{if(s<(24*60*60)){o=""+(parseInt(s/3600,10)).toString()+" hours ago"}else{if(s<(48*60*60)){o="a day ago"}else{o=(parseInt(s/86400,10)).toString()+" days ago"}}}}}}return"about "+o}function g(n){if(n.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return m.auto_join_text_reply}else{if(n.match(b)){return m.auto_join_text_url}else{if(n.match(/^((\w+ed)|just) .*/im)){return m.auto_join_text_ed}else{if(n.match(/^(\w*ing) .*/i)){return m.auto_join_text_ing}else{return m.auto_join_text_default}}}}}function e(){var o=("https:"==document.location.protocol?"https:":"http:");var n=(m.fetch===null)?m.count:m.fetch;if(m.list){return o+"//"+m.twitter_api_url+"/1/"+m.username[0]+"/lists/"+m.list+"/statuses.json?page="+m.page+"&per_page="+n+"&callback=?"}else{if(m.favorites){return o+"//"+m.twitter_api_url+"/favorites/"+m.username[0]+".json?page="+m.page+"&count="+n+"&callback=?"}else{if(m.query===null&&m.username.length==1){return o+"//"+m.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+m.username[0]+"&count="+n+(m.retweets?"&include_rts=1":"")+"&page="+m.page+"&callback=?"}else{var q=(m.query||"from:"+m.username.join(" OR from:"));return o+"//"+m.twitter_search_url+"/search.json?&q="+encodeURIComponent(q)+"&rpp="+n+"&page="+m.page+"&callback=?"}}}}function j(n){var q={};q.item=n;q.source=n.source;q.screen_name=n.from_user||n.user.screen_name;q.avatar_size=m.avatar_size;q.avatar_url=n.profile_image_url||n.user.profile_image_url;q.retweet=typeof(n.retweeted_status)!="undefined";q.tweet_time=k(n.created_at);q.join_text=m.join_text=="auto"?g(n.text):m.join_text;q.tweet_id=n.id_str;q.twitter_base="http://"+m.twitter_url+"/";q.user_url=q.twitter_base+q.screen_name;q.tweet_url=q.user_url+"/status/"+q.tweet_id;q.reply_url=q.twitter_base+"intent/tweet?in_reply_to="+q.tweet_id;q.retweet_url=q.twitter_base+"intent/retweet?tweet_id="+q.tweet_id;q.favorite_url=q.twitter_base+"intent/favorite?tweet_id="+q.tweet_id;q.retweeted_screen_name=q.retweet&&n.retweeted_status.user.screen_name;q.tweet_relative_time=h(q.tweet_time);q.tweet_raw_text=q.retweet?("RT @"+q.retweeted_screen_name+" "+n.retweeted_status.text):n.text;q.tweet_text=a([q.tweet_raw_text]).linkUrl().linkUser().linkHash()[0];q.tweet_text_fancy=a([q.tweet_text]).makeHeart().capAwesome().capEpic()[0];q.user=l('<a class="tweet_user" href="{user_url}">{screen_name}</a>',q);q.join=m.join_text?l(' <span class="tweet_join">{join_text}</span> ',q):" ";q.avatar=q.avatar_size?l('<a class="tweet_avatar" href="{user_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{screen_name}\'s avatar" title="{screen_name}\'s avatar" border="0"/></a>',q):"";q.time=l('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>',q);q.text=l('<span class="tweet_text">{tweet_text_fancy}</span>',q);q.reply_action=l('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>',q);q.retweet_action=l('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>',q);q.favorite_action=l('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>',q);return q}return this.each(function(o,s){var r=a('<ul class="tweet_list">').appendTo(s);var q='<p class="tweet_intro">'+m.intro_text+"</p>";var n='<p class="tweet_outro">'+m.outro_text+"</p>";var u=a('<p class="loading">'+m.loading_text+"</p>");if(m.username&&typeof(m.username)=="string"){m.username=[m.username]}if(m.loading_text){a(s).append(u)}a(s).bind("tweet:load",function(){a.getJSON(e(),function(v){if(m.loading_text){u.remove()}if(m.intro_text){r.before(q)}r.empty();var w=a.map(v.results||v,j);w=a.grep(w,m.filter).sort(m.comparator).slice(0,m.count);r.append(a.map(w,function(x){return"<li>"+l(m.template,x)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");if(m.outro_text){r.after(n)}a(s).trigger("loaded").trigger((w.length===0?"empty":"full"));if(m.refresh_interval){window.setTimeout(function(){a(s).trigger("tweet:load")},1000*m.refresh_interval)}})}).trigger("tweet:load")})}})(jQuery);(function(a){a.fn.extend({paranoid_form:function(b){this.each(function(f,g){g=a(g);var e=g.find('input[type="submit"]');var d="Are you sure you want to leave this form without saving?";var h=function(j){var j=j||window.event;if(j){j.returnValue=d}return d};g.find("input, textarea, select").change(function(j){window.onbeforeunload=h});e.click(function(j){window.onbeforeunload=null})})}})})(jQuery);(function(){var V=this,R=V._,Y={},ab=Array.prototype,X=Object.prototype,ad=ab.slice,P=ab.unshift,M=X.toString,Z=X.hasOwnProperty,O=ab.forEach,N=ab.map,L=ab.reduce,J=ab.reduceRight,G=ab.filter,g=ab.every,d=ab.some,W=ab.indexOf,a=ab.lastIndexOf;X=Array.isArray;var K=Object.keys,T=Function.prototype.bind,ae=function(b){return new aa(b)};typeof module!=="undefined"&&module.exports?(module.exports=ae,ae._=ae):V._=ae;ae.VERSION="1.1.7";var ac=ae.each=ae.forEach=function(h,m,f){if(h!=null){if(O&&h.forEach===O){h.forEach(m,f)}else{if(h.length===+h.length){for(var l=0,j=h.length;l<j;l++){if(l in h&&m.call(f,h[l],l,h)===Y){break}}}else{for(l in h){if(Z.call(h,l)&&m.call(f,h[l],l,h)===Y){break}}}}}};ae.map=function(h,l,f){var j=[];if(h==null){return j}if(N&&h.map===N){return h.map(l,f)}ac(h,function(b,n,m){j[j.length]=l.call(f,b,n,m)});return j};ae.reduce=ae.foldl=ae.inject=function(b,l,j,h){var f=j!==void 0;b==null&&(b=[]);if(L&&b.reduce===L){return h&&(l=ae.bind(l,h)),f?b.reduce(l,j):b.reduce(l)}ac(b,function(n,m,o){f?j=l.call(h,j,n,m,o):(j=n,f=!0)});if(!f){throw new TypeError("Reduce of empty array with no initial value")}return j};ae.reduceRight=ae.foldr=function(b,j,h,f){b==null&&(b=[]);if(J&&b.reduceRight===J){return f&&(j=ae.bind(j,f)),h!==void 0?b.reduceRight(j,h):b.reduceRight(j)}b=(ae.isArray(b)?b.slice():ae.toArray(b)).reverse();return ae.reduce(b,j,h,f)};ae.find=ae.detect=function(h,l,f){var j;U(h,function(b,m,n){if(l.call(f,b,m,n)){return j=b,!0}});return j};ae.filter=ae.select=function(h,l,f){var j=[];if(h==null){return j}if(G&&h.filter===G){return h.filter(l,f)}ac(h,function(b,m,n){l.call(f,b,m,n)&&(j[j.length]=b)});return j};ae.reject=function(h,l,f){var j=[];if(h==null){return j}ac(h,function(b,m,n){l.call(f,b,m,n)||(j[j.length]=b)});return j};ae.every=ae.all=function(h,l,f){var j=!0;if(h==null){return j}if(g&&h.every===g){return h.every(l,f)}ac(h,function(b,m,n){if(!(j=j&&l.call(f,b,m,n))){return Y}});return j};var U=ae.some=ae.any=function(b,j,h){j=j||ae.identity;var f=!1;if(b==null){return f}if(d&&b.some===d){return b.some(j,h)}ac(b,function(m,l,n){if(f|=j.call(h,m,l,n)){return Y}});return !!f};ae.include=ae.contains=function(h,j){var f=!1;if(h==null){return f}if(W&&h.indexOf===W){return h.indexOf(j)!=-1}U(h,function(b){if(f=b===j){return !0}});return f};ae.invoke=function(b,h){var f=ad.call(arguments,2);return ae.map(b,function(j){return(h.call?h||j:j[h]).apply(j,f)})};ae.pluck=function(b,f){return ae.map(b,function(h){return h[f]})};ae.max=function(b,j,h){if(!j&&ae.isArray(b)){return Math.max.apply(Math,b)}var f={computed:-Infinity};ac(b,function(m,l,n){l=j?j.call(h,m,l,n):m;l>=f.computed&&(f={value:m,computed:l})});return f.value};ae.min=function(b,j,h){if(!j&&ae.isArray(b)){return Math.min.apply(Math,b)}var f={computed:Infinity};ac(b,function(m,l,n){l=j?j.call(h,m,l,n):m;l<f.computed&&(f={value:m,computed:l})});return f.value};ae.sortBy=function(b,h,f){return ae.pluck(ae.map(b,function(l,j,m){return{value:l,criteria:h.call(f,l,j,m)}}).sort(function(l,j){var n=l.criteria,m=j.criteria;return n<m?-1:n>m?1:0}),"value")};ae.groupBy=function(h,f){var j={};ac(h,function(b,m){var l=f(b,m);(j[l]||(j[l]=[])).push(b)});return j};ae.sortedIndex=function(b,n,m){m||(m=ae.identity);for(var l=0,j=b.length;l<j;){var h=l+j>>1;m(b[h])<m(n)?l=h+1:j=h}return l};ae.toArray=function(b){if(!b){return[]}if(b.toArray){return b.toArray()}if(ae.isArray(b)){return ad.call(b)}if(ae.isArguments(b)){return ad.call(b)}return ae.values(b)};ae.size=function(b){return ae.toArray(b).length};ae.first=ae.head=function(h,f,j){return f!=null&&!j?ad.call(h,0,f):h[0]};ae.rest=ae.tail=function(h,f,j){return ad.call(h,f==null||j?1:f)};ae.last=function(b){return b[b.length-1]};ae.compact=function(b){return ae.filter(b,function(f){return !!f})};ae.flatten=function(b){return ae.reduce(b,function(f,h){if(ae.isArray(h)){return f.concat(ae.flatten(h))}f[f.length]=h;return f},[])};ae.without=function(b){return ae.difference(b,ad.call(arguments,1))};ae.uniq=ae.unique=function(b,f){return ae.reduce(b,function(h,l,j){if(0==j||(f===!0?ae.last(h)!=l:!ae.include(h,l))){h[h.length]=l}return h},[])};ae.union=function(){return ae.uniq(ae.flatten(arguments))};ae.intersection=ae.intersect=function(b){var f=ad.call(arguments,1);return ae.filter(ae.uniq(b),function(h){return ae.every(f,function(j){return ae.indexOf(j,h)>=0})})};ae.difference=function(b,f){return ae.filter(b,function(h){return !ae.include(f,h)})};ae.zip=function(){for(var b=ad.call(arguments),j=ae.max(ae.pluck(b,"length")),h=Array(j),f=0;f<j;f++){h[f]=ae.pluck(b,""+f)}return h};ae.indexOf=function(b,j,h){if(b==null){return -1}var f;if(h){return h=ae.sortedIndex(b,j),b[h]===j?h:-1}if(W&&b.indexOf===W){return b.indexOf(j)}h=0;for(f=b.length;h<f;h++){if(b[h]===j){return h}}return -1};ae.lastIndexOf=function(h,f){if(h==null){return -1}if(a&&h.lastIndexOf===a){return h.lastIndexOf(f)}for(var j=h.length;j--;){if(h[j]===f){return j}}return -1};ae.range=function(j,h,o){arguments.length<=1&&(h=j||0,j=0);o=arguments[2]||1;for(var n=Math.max(Math.ceil((h-j)/o),0),m=0,l=Array(n);m<n;){l[m++]=j,j+=o}return l};ae.bind=function(h,f){if(h.bind===T&&T){return T.apply(h,ad.call(arguments,1))}var j=ad.call(arguments,2);return function(){return h.apply(f,j.concat(ad.call(arguments)))}};ae.bindAll=function(b){var f=ad.call(arguments,1);f.length==0&&(f=ae.functions(b));ac(f,function(h){b[h]=ae.bind(b[h],b)});return b};ae.memoize=function(b,h){var f={};h||(h=ae.identity);return function(){var j=h.apply(this,arguments);return Z.call(f,j)?f[j]:f[j]=b.apply(this,arguments)}};ae.delay=function(h,f){var j=ad.call(arguments,2);return setTimeout(function(){return h.apply(h,j)},f)};ae.defer=function(b){return ae.delay.apply(ae,[b,1].concat(ad.call(arguments,1)))};var S=function(h,f,l){var j;return function(){var n=this,m=arguments,b=function(){j=null;h.apply(n,m)};l&&clearTimeout(j);if(l||!j){j=setTimeout(b,f)}}};ae.throttle=function(h,f){return S(h,f,!1)};ae.debounce=function(h,f){return S(h,f,!0)};ae.once=function(h){var f=!1,j;return function(){if(f){return j}f=!0;return j=h.apply(this,arguments)}};ae.wrap=function(h,f){return function(){var b=[h].concat(ad.call(arguments));return f.apply(this,b)}};ae.compose=function(){var b=ad.call(arguments);return function(){for(var f=ad.call(arguments),h=b.length-1;h>=0;h--){f=[b[h].apply(this,f)]}return f[0]}};ae.after=function(h,f){return function(){if(--h<1){return f.apply(this,arguments)}}};ae.keys=K||function(h){if(h!==Object(h)){throw new TypeError("Invalid object")}var f=[],j;for(j in h){Z.call(h,j)&&(f[f.length]=j)}return f};ae.values=function(b){return ae.map(b,ae.identity)};ae.functions=ae.methods=function(b){var h=[],f;for(f in b){ae.isFunction(b[f])&&h.push(f)}return h.sort()};ae.extend=function(b){ac(ad.call(arguments,1),function(f){for(var h in f){f[h]!==void 0&&(b[h]=f[h])}});return b};ae.defaults=function(b){ac(ad.call(arguments,1),function(f){for(var h in f){b[h]==null&&(b[h]=f[h])}});return b};ae.clone=function(b){return ae.isArray(b)?b.slice():ae.extend({},b)};ae.tap=function(h,f){f(h);return h};ae.isEqual=function(b,m){if(b===m){return !0}var l=typeof b;if(l!=typeof m){return !1}if(b==m){return !0}if(!b&&m||b&&!m){return !1}if(b._chain){b=b._wrapped}if(m._chain){m=m._wrapped}if(b.isEqual){return b.isEqual(m)}if(m.isEqual){return m.isEqual(b)}if(ae.isDate(b)&&ae.isDate(m)){return b.getTime()===m.getTime()}if(ae.isNaN(b)&&ae.isNaN(m)){return !1}if(ae.isRegExp(b)&&ae.isRegExp(m)){return b.source===m.source&&b.global===m.global&&b.ignoreCase===m.ignoreCase&&b.multiline===m.multiline}if(l!=="object"){return !1}if(b.length&&b.length!==m.length){return !1}l=ae.keys(b);var j=ae.keys(m);if(l.length!=j.length){return !1}for(var h in b){if(!(h in m)||!ae.isEqual(b[h],m[h])){return !1}}return !0};ae.isEmpty=function(b){if(ae.isArray(b)||ae.isString(b)){return b.length===0}for(var f in b){if(Z.call(b,f)){return !1}}return !0};ae.isElement=function(b){return !!(b&&b.nodeType==1)};ae.isArray=X||function(b){return M.call(b)==="[object Array]"};ae.isObject=function(b){return b===Object(b)};ae.isArguments=function(b){return !(!b||!Z.call(b,"callee"))};ae.isFunction=function(b){return !(!b||!b.constructor||!b.call||!b.apply)};ae.isString=function(b){return !!(b===""||b&&b.charCodeAt&&b.substr)};ae.isNumber=function(b){return !!(b===0||b&&b.toExponential&&b.toFixed)};ae.isNaN=function(b){return b!==b};ae.isBoolean=function(b){return b===!0||b===!1};ae.isDate=function(b){return !(!b||!b.getTimezoneOffset||!b.setUTCFullYear)};ae.isRegExp=function(b){return !(!b||!b.test||!b.exec||!(b.ignoreCase||b.ignoreCase===!1))};ae.isNull=function(b){return b===null};ae.isUndefined=function(b){return b===void 0};ae.noConflict=function(){V._=R;return this};ae.identity=function(b){return b};ae.times=function(h,f,l){for(var j=0;j<h;j++){f.call(l,j)}};ae.mixin=function(b){ac(ae.functions(b),function(f){k(f,ae[f]=b[f])})};var e=0;ae.uniqueId=function(h){var f=e++;return h?h+f:f};ae.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};ae.template=function(b,h){var f=ae.templateSettings;f="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+b.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(f.interpolate,function(l,j){return"',"+j.replace(/\\'/g,"'")+",'"}).replace(f.evaluate||null,function(l,j){return"');"+j.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";f=new Function("obj",f);return h?f(h):f};var aa=function(b){this._wrapped=b};ae.prototype=aa.prototype;var Q=function(b,f){return f?ae(b).chain():b},k=function(b,f){aa.prototype[b]=function(){var h=ad.call(arguments);P.call(h,this._wrapped);return Q(f.apply(ae,h),this._chain)}};ae.mixin(ae);ac(["pop","push","reverse","shift","sort","splice","unshift"],function(h){var f=ab[h];aa.prototype[h]=function(){f.apply(this._wrapped,arguments);return Q(this._wrapped,this._chain)}});ac(["concat","join","slice"],function(h){var f=ab[h];aa.prototype[h]=function(){return Q(f.apply(this._wrapped,arguments),this._chain)}});aa.prototype.chain=function(){this._chain=!0;return this};aa.prototype.value=function(){return this._wrapped}})();jQuery.trackAction=function(b,a,d){jQuery.post(["/counter/actions",b,a,d].join("/"))};jQuery.can_play_video=function(d){if(d==undefined){d="video/mp4"}var a=false;var b=document.createElement("video");if(typeof(b.canPlayType)=="function"){a=b.canPlayType(d)}jQuery(b).remove();return a};var _sf_startpt=(new Date()).getTime();jQuery.fn.clear_field=function(a){var a=a||{};return jQuery(this).each(function(){var h=jQuery(this),l="clear_field_cleared";if(h.data(l)){return}var g=d(h);var j=b(h);h.focus(k);h.blur(e);h.change(e);e();function f(){j.show()}function k(){j.hide()}function e(){if(h.val()==""){f()}else{k()}}h.data(l,true)});function d(f){var e=jQuery("<div>");e.addClass("clear_container");f.wrap(e);return e}function b(f){var g=jQuery("<div>");var e=["padding-left","padding-right","padding-top","padding-bottom","margin-left","margin-right","margin-top","margin-bottom","border-left-width","border-right-width","border-top-width","border-bottom-width","font-size","font-family","font-weight","font-style","height","width","line-height","text-transform","text-align"];_.each(e,function(h){g.css(h,f.css(h))});return g.addClass("clear_overlay").on("mouseup click",function(h){f.focus()}).html(a.default_value||f.data("defaultValue")||"").hide().insertAfter(f)}};(function(b,d){var a=b.ted||{};a.collect=function(e){d.ajax({type:"POST",url:"/error_collector.php",data:{message:e}})}}(window,jQuery));(function(a,d,f){var e,g,b=new Date();e={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version"},searchString:function(l){for(var h=0;h<l.length;h++){var j=l[h].string;var k=l[h].prop;this.versionSearchString=l[h].versionSearch||l[h].identity;if(j){if(j.indexOf(l[h].subString)!=-1){return l[h].identity}}else{if(k){return l[h].identity}}}},searchVersion:function(j){var h=j.indexOf(this.versionSearchString);if(h==-1){return}return parseFloat(j.substring(h+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:d.opera,identity:"Opera"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}]};e.init();g={uri:d.location.href,client_name:e.browser,client_version:e.version};d.onerror=function(m,l,j){var k=+new Date(),h=d.ted||{};if(!j||!l.match(/^https?:\/\/(?:.*\.)?(?:ted|tedcdn)\.com\//)){return}if(!l.match(/\.js/)&&j<5){return}h.collect(f.extend({},g,{message:m,file:l,line:j,elapsed_seconds:(k-b)/1000|0,context:"js",profile_id:h.profileId||"N/A",user_agent:navigator?navigator.userAgent:"Unknown"}))}}(document,window,jQuery));jQuery.GA_trackEvent=function(d,f,a,e,g,b){if(!window._gaq){return false}_gaq=_gaq||[];_gaq.push([(b===undefined)?"_trackEvent":b+"._trackEvent",d.toString(),f.toString(),a.toString(),e==undefined?e:((isNaN(e))?undefined:parseInt(e)),g==undefined?g:g==true])};jQuery.GA_trackSocial=function(b,d,f,e,a){if(!window._gaq){return false}_gaq=_gaq||[];e=e||"";if(e.match(/^http(s)?:\/\//)){e=$.parseURL(e).relative}_gaq.push([(a===undefined)?"_trackSocial":a+"._trackSocial",b.toString(),d.toString(),f==undefined?f:f.toString(),e==undefined?e:e.toString()])};jQuery.fn.GA_trackEvent=function(d,f,h,b,g,j,e){var a=jQuery(this);var b=b||a.attr("id");a.on(d,function(k){jQuery.GA_trackEvent(f,h,b,g,j,e)})};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;var d=Number(arguments[1])||0;d=(d<0)?Math.ceil(d):Math.floor(d);if(d<0){d+=a}for(;d<a;d++){if(d in this&&this[d]===b){return d}}return -1}}jQuery.fn.in_viewport=function(){var b=jQuery(window).scrollTop();var a=jQuery(window).height();var d=jQuery(this).offset().top;return d>b&&d<b+a};(function(a){a.fn.innerfade=function(b){return this.each(function(){a.innerfade(this,b)})};a.innerfade=function(b,d){var f={animationtype:"fade",speed:"normal",type:"sequence",timeout:2000,containerheight:"auto",runningclass:"innerfade",children:null};if(d){a.extend(f,d)}if(f.children===null){var h=a(b).children()}else{var h=a(b).children(f.children)}if(h.length>1){a(b).css("position","relative").css("height",f.containerheight).addClass(f.runningclass);for(var e=0;e<h.length;e++){a(h[e]).css("z-index",String(h.length-e)).css("position","absolute").hide()}if(f.type=="sequence"){setTimeout(function(){a.innerfade.next(h,f,1,0)},f.timeout);a(h[0]).show()}else{if(f.type=="random"){var g=Math.floor(Math.random()*h.length);setTimeout(function(){do{j=Math.floor(Math.random()*h.length)}while(g==j);a.innerfade.next(h,f,j,g)},f.timeout);a(h[g]).show()}else{if(f.type=="random_start"){f.type="sequence";var j=Math.floor(Math.random()*h.length);setTimeout(function(){a.innerfade.next(h,f,(j+1)%h.length,j)},f.timeout);a(h[j]).show()}else{alert("Innerfade-Type must either be 'sequence', 'random' or 'random_start'")}}}}};a.innerfade.next=function(e,b,f,d){if(b.animationtype=="slide"){a(e[d]).slideUp(b.speed);a(e[f]).slideDown(b.speed)}else{if(b.animationtype=="fade"){a(e[d]).fadeOut(b.speed);a(e[f]).fadeIn(b.speed,function(){removeFilter(a(this)[0])})}else{alert("Innerfade-animationtype must either be 'slide' or 'fade'")}}if(b.type=="sequence"){if((f+1)<e.length){f=f+1;d=f-1}else{f=0;d=e.length-1}}else{if(b.type=="random"){d=f;while(f==d){f=Math.floor(Math.random()*e.length)}}else{alert("Innerfade-Type must either be 'sequence', 'random' or 'random_start'")}}setTimeout((function(){a.innerfade.next(e,b,f,d)}),b.timeout)}})(jQuery);function removeFilter(a){if(a.style.removeAttribute){a.style.removeAttribute("filter")}}(function(a){a.fn.addOption=function(){var j=function(r,l,n,s){var q=document.createElement("option");q.value=l,q.text=n;var u=r.options;var k=u.length;if(!r.cache){r.cache={};for(var m=0;m<k;m++){r.cache[u[m].value]=m}}if(typeof r.cache[l]=="undefined"){r.cache[l]=k}r.options[r.cache[l]]=q;if(s){q.selected=true}};var d=arguments;if(d.length==0){return this}var h=true;var b=false;var f,e,g;if(typeof(d[0])=="object"){b=true;f=d[0]}if(d.length>=2){if(typeof(d[1])=="boolean"){h=d[1]}else{if(typeof(d[2])=="boolean"){h=d[2]}}if(!b){e=d[0];g=d[1]}}this.each(function(){if(this.nodeName.toLowerCase()!="select"){return}if(b){for(var k in f){j(this,k,f[k],h)}}else{j(this,e,g,h)}});return this};a.fn.ajaxAddOption=function(e,g,b,f,d){if(typeof(e)!="string"){return this}if(typeof(g)!="object"){g={}}if(typeof(b)!="boolean"){b=true}this.each(function(){var h=this;a.getJSON(e,g,function(j){a(h).addOption(j,b);if(typeof f=="function"){if(typeof d=="object"){f.apply(h,d)}else{f.call(h)}}})});return this};a.fn.removeOption=function(){var d=arguments;if(d.length==0){return this}var f=typeof(d[0]);var e,g;if(f=="string"||f=="object"||f=="function"){e=d[0];if(e.constructor==Array){var b=e.length;for(var h=0;h<b;h++){this.removeOption(e[h],d[1])}return this}}else{if(f=="number"){g=d[0]}else{return this}}this.each(function(){if(this.nodeName.toLowerCase()!="select"){return}if(this.cache){this.cache=null}var j=false;var m=this.options;if(!!e){var k=m.length;for(var l=k-1;l>=0;l--){if(e.constructor==RegExp){if(m[l].value.match(e)){j=true}}else{if(m[l].value==e){j=true}}if(j&&d[1]===true){j=m[l].selected}if(j){m[l]=null}j=false}}else{if(d[1]===true){j=m[g].selected}else{j=true}if(j){this.remove(g)}}});return this};a.fn.sortOptions=function(d){var e=a(this).selectedValues();var b=typeof(d)=="undefined"?true:!!d;this.each(function(){if(this.nodeName.toLowerCase()!="select"){return}var h=this.options;var f=h.length;var j=[];for(var g=0;g<f;g++){j[g]={v:h[g].value,t:h[g].text}}j.sort(function(l,k){o1t=l.t.toLowerCase(),o2t=k.t.toLowerCase();if(o1t==o2t){return 0}if(b){return o1t<o2t?-1:1}else{return o1t>o2t?-1:1}});for(var g=0;g<f;g++){h[g].text=j[g].t;h[g].value=j[g].v}}).selectOptions(e,true);return this};a.fn.selectOptions=function(e,b){var d=e;var g=typeof(e);if(g=="object"&&d.constructor==Array){var f=this;a.each(d,function(){f.selectOptions(this,b)})}var h=b||false;if(g!="string"&&g!="function"&&g!="object"){return this}this.each(function(){if(this.nodeName.toLowerCase()!="select"){return this}var l=this.options;var j=l.length;for(var k=0;k<j;k++){if(d.constructor==RegExp){if(l[k].value.match(d)){l[k].selected=true}else{if(h){l[k].selected=false}}}else{if(l[k].value==d){l[k].selected=true}else{if(h){l[k].selected=false}}}}});return this};a.fn.copyOptions=function(e,d){var b=d||"selected";if(a(e).size()==0){return this}this.each(function(){if(this.nodeName.toLowerCase()!="select"){return this}var h=this.options;var f=h.length;for(var g=0;g<f;g++){if(b=="all"||(b=="selected"&&h[g].selected)){a(e).addOption(h[g].value,h[g].text)}}});return this};a.fn.containsOption=function(f,d){var e=false;var b=f;var g=typeof(b);var h=typeof(d);if(g!="string"&&g!="function"&&g!="object"){return h=="function"?this:e}this.each(function(){if(this.nodeName.toLowerCase()!="select"){return this}if(e&&h!="function"){return false}var l=this.options;var j=l.length;for(var k=0;k<j;k++){if(b.constructor==RegExp){if(l[k].value.match(b)){e=true;if(h=="function"){d.call(l[k],k)}}}else{if(l[k].value==b){e=true;if(h=="function"){d.call(l[k],k)}}}}});return h=="function"?this:e};a.fn.selectedValues=function(){var b=[];this.selectedOptions().each(function(){b[b.length]=this.value});return b};a.fn.selectedTexts=function(){var b=[];this.selectedOptions().each(function(){b[b.length]=this.text});return b};a.fn.selectedOptions=function(){return this.find("option:selected")}})(jQuery);(function(a){a.keepalive=function(){var b=setInterval(function(){a.get("/home/keepalive")},1000*60*60*23)}})(jQuery);ted=window.ted=window.ted||{};ted.languageSelector=(function(d){var b={},a;b.languages=null;b.checkLocale=(function(){var j;function h(l){var m,o,k,n=false;l=g(l);if(l[0]===j[0]){return false}m=b.languages.length;while(m--){o=b.languages[m];k=g(o.locale);if(k[0]===l[0]){if(n&&k[1]&&l[1]){if(k[1]===l[1]){n=o}}else{n=o}}}return n}function e(m){var l,k,n;for(l=-1,k=m.length;++l<k;){if(!n){n=h(m[l])}}if(n){f(n)}}function g(k){return k&&k.toLowerCase?k.toLowerCase().split("-"):false}function f(o){var n,m,k,l;m=d("<div class=language-prompt>").addClass(o.rtl?"rtl":"ltr").attr("lang",o.locale);l=d("<span>").text(" "+o.message+" ");k=d("<a>").attr("href",o.url).text(o.prompt);n=d("<a>").addClass("close").attr("href","#").text("X");n.on("click",function(){m.slideUp("fast");d.cookie("locale","X");return false});m.append(l).append(k).append(n);d("#header").after(m)}return function(){var k;j=g(d("html").attr("lang"));if(!j){return false}k=d.cookie("locale");if(k){e(k.split(","));return}d.getJSON("/language/check").success(function(l){e(l.locales);d.cookie("locale",l.locales.join(","),{expires:90})})}}());b.init=function(e){b.languages=e;b.checkLocale();a=d("#language-modal");d("#language-link").on("click",b.showLanguages);a.find("a.close").on("click",b.hideLanguages)};b.hideLanguages=function(){a.slideUp("fast");return false};b.showLanguages=function(){var f=d(document),e=d(window);if(a.is(":visible")){return false}a.animate({height:"toggle"},{duration:400,step:function(g,h){e.scrollTop(f.height())}});return false};return b}(jQuery));jQuery.loadAsyncScript=function loadAsyncScript(b){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=b;var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(a,d)};var Kicksend={mailcheck:{threshold:3,defaultDomains:"yahoo.com google.com hotmail.com gmail.com me.com aol.com mac.com live.com comcast.net googlemail.com msn.com hotmail.co.uk yahoo.co.uk facebook.com verizon.net sbcglobal.net att.net gmx.com mail.com".split(" "),defaultTopLevelDomains:"co.uk com net org info edu gov mil".split(" "),run:function(e){e.domains=e.domains||Kicksend.mailcheck.defaultDomains;e.topLevelDomains=e.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains;e.distanceFunction=e.distanceFunction||Kicksend.sift3Distance;var d=Kicksend.mailcheck.suggest(encodeURI(e.email),e.domains,e.topLevelDomains,e.distanceFunction);d?e.suggested&&e.suggested(d):e.empty&&e.empty()},suggest:function(f,e,h,g){f=f.toLowerCase();f=this.splitEmail(f);if(e=this.findClosestDomain(f.domain,e,g)){if(e!=f.domain){return{address:f.address,domain:e,full:f.address+"@"+e}}}else{if(h=this.findClosestDomain(f.topLevelDomain,h),f.domain&&h&&h!=f.topLevelDomain){return e=f.domain,e=e.substring(0,e.lastIndexOf(f.topLevelDomain))+h,{address:f.address,domain:e,full:f.address+"@"+e}}}return !1},findClosestDomain:function(j,h,o){var n,m=99,k=null;if(!j||!h){return !1}o||(o=this.sift3Distance);for(var l=0;l<h.length;l++){if(j===h[l]){return j}n=o(j,h[l]);n<m&&(m=n,k=h[l])}return m<=this.threshold&&null!==k?k:!1},sift3Distance:function(j,h){if(null==j||0===j.length){return null==h||0===h.length?0:h.length}if(null==h||0===h.length){return j.length}for(var o=0,n=0,m=0,k=0;o+n<j.length&&o+m<h.length;){if(j.charAt(o+n)==h.charAt(o+m)){k++}else{for(var l=m=n=0;5>l;l++){if(o+l<j.length&&j.charAt(o+l)==h.charAt(o)){n=l;break}if(o+l<h.length&&j.charAt(o)==h.charAt(o+l)){m=l;break}}}o++}return(j.length+h.length)/2-k},splitEmail:function(g){g=g.split("@");if(2>g.length){return !1}for(var f=0;f<g.length;f++){if(""===g[f]){return !1}}var k=g.pop(),j=k.split("."),h="";if(0==j.length){return !1}if(1==j.length){h=j[0]}else{for(f=1;f<j.length;f++){h+=j[f]+"."}2<=j.length&&(h=h.substring(0,h.length-1))}return{topLevelDomain:h,domain:k,address:g.join("@")}}}};window.jQuery&&function(b){b.fn.mailcheck=function(f){var j=this;if(f.suggested){var h=f.suggested;f.suggested=function(d){h(j,d)}}if(f.empty){var g=f.empty;f.empty=function(){g.call(null,j)}}f.email=this.val();Kicksend.mailcheck.run(f)}}(jQuery);jQuery.pad=function(b,a,d){if(d==undefined){d="0"}a-=b.toString().length;if(a>0){return new Array(a+(/\./.test(b)?2:1)).join(d)+b}return b};(function(a){a.pager=function(b){this.settings=jQuery.extend({page:1,total:1,per_page:10},b);this.next=function(){this.settings.page++};this.page=function(){return this.settings.page};this.prevPage=function(){return Math.max((this.settings.page-1),1)};this.nextPage=function(){return Math.min((this.settings.page+1),this.lastPage())};this.lastPage=function(){return Math.ceil(this.settings.total/this.settings.per_page)};this.first=function(){return Math.min((this.settings.page-1)*this.settings.per_page)+1};this.last=function(){return Math.min(this.settings.page*this.settings.per_page,this.settings.total)};this.remaining=function(){return this.settings.total-this.last()};this.isLast=function(){return this.page()==this.lastPage()};return this}})(jQuery);$.parseURL=$.parseUrl=function(d){var b=document.createElement("a");b.href=d;return{source:d,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,query:b.search,params:(function(){var f={},e=b.search.replace(/^\?/,"").split("&"),a=e.length,g=0,h;for(;g<a;g++){if(!e[g]){continue}h=e[g].split("=");f[h[0]]=h[1]}return f})(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}};jQuery.fn.selectall_field=function(){return this.each(function(){jQuery(this).click(function(){this.select()})})};jQuery.fn.setRequired=function(b,a){a=a||"required";return jQuery(this).each(function(){var d=jQuery(this);var e=d.closest("form").find("label[for="+d.attr("id")+"]");if(b){if(!e.hasClass(a)){jQuery('<em class="req">*</em>').appendTo(e)}}else{e.children("em").remove()}e.toggleClass(a,b)})};$.getShareURL=$.getShareUrl=function(d,a){if(a!=undefined){var b=$.parseURL(d);d+=(b.query?"&":"?")+"source="+a;if(typeof(addthis)=="object"&&addthis.addClickTag){d=addthis.addClickTag(d,a)}}return d};$.setupSharing=function(d){var e={pubid:"tedtalks",ct:1};var f="http://api.addthis.com/oexchange/0.8/forward/{service}/offer?";$.extend(e,d.config);var a=d.container;var b=d.object||a;a.find("[data-service]").click(function(j){j.preventDefault();element=$(this);var h=element.data("service");e.url=b.data("url");e.title=b.data("title");var k=$.extend({},e,{url:$.getShareUrl(e.url,h)});var g=b.data("twitter-text");var l=h;if(b.data(h)){k.title=b.data(h)}if(h=="twitter"){if(g&&g!==""){g+=" ";l+="_text"}else{g=""}k.shortener="awesm";k["awesm.key"]="ad779fc3a51249f0174bf5a7edd3720db7ce75454efbb554c5cf24d49646045e";k.related="TEDTalks,TEDNews,TEDChris";k.template=g+(b.data("twitter-template")||"{{title}} {{url}} #TED")}if(h=="email"){k.email_template=b.data("model")}window.open(f.replace("{service}",h)+$.param(k),"share","height=300,width=500");$.trackAction("share",b.data("model"),b.data("id"));$.GA_trackSocial(h,"share",b.data("slug"),b.data("url"));$.GA_trackEvent("share",b.data("model"),l+"|"+b.data("slug"))})};jQuery(function(b){var a=b("#quotes .share, .share_quote");if(a.length==0){return}a.popover({id:"share_popover",header:"<strong>Share this TED Quote</strong>",content:'<div class="sharebox"><a class="facebook" data-service="facebook" title="Share on Facebook" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-facebook.png" alt="Share on Facebook"/></a><a class="twitter" data-service="twitter" title="Share on Twitter" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-twitter.png" alt="Share on Twitter"/></a><a class="email" data-service="email" title="Share with email" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-email.png" alt="Share with email"/></a></div>',preventLeft:true,preventRight:true,live:true,openEvent:function(d){var e={container:b("#share_popover").find(".sharebox"),object:d.closest(".share-data")};d.data("sharing",e);b.setupSharing(e)},closeEvent:function(d){d.data("sharing").container.find("[data-service]").off("click")}})});jQuery(function(b){var a=b("#talk .share, .share_talk");if(a.length==0){return}a.popover({id:"share_popover",header:"<strong>Share this TED Talk</strong>",content:'<div class="sharebox"><a class="facebook" data-service="facebook" title="Share on Facebook" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-facebook.png" alt="Share on Facebook"/></a><a class="twitter" data-service="twitter" title="Share on Twitter" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-twitter.png" alt="Share on Twitter"/></a><a class="email" data-service="email" title="Share with email" href="#" rel="nofollow"><img src="'+ted.baseUrl+'/images/reboot/icon-email.png" alt="Share with email"/></a></div>',preventLeft:true,preventRight:true,live:true,openEvent:function(d){var e={container:b("#share_popover").find(".sharebox"),object:d.closest(".share-data")};d.data("sharing",e);b.setupSharing(e)},closeEvent:function(d){d.data("sharing").container.find("[data-service]").off("click")}})});jQuery.fn.ted_dialog=function(a){var b=jQuery.extend({autoOpen:false,draggable:false,resizable:false,modal:true,show:"fade",hide:"fade",width:450},a);return this.each(function(){jQuery(this).dialog(b)})};var ted=window.ted||{};ted.log=(function(){var a=function(){a.history=a.history||[];a.history.push(arguments);if(window.console){console.log(Array.prototype.slice.call(arguments))}};return a}());(function(b,d){var a=b.ted||{};a.visitor=function(){var e;if(a.userId){return"T"+a.userId}e=d.cookie("__utma");if(e){e=e.split(".")}if(!e||!e.length){return"R"+(""+Math.random()).substring(2,18)}return"G"+e[1]}}(window,jQuery));var viewCounter={getCount:function(){var a=$.cookie("viewCounter").split(".");return a[1]},getViews:function(){if(viewCounter.checkSession()){return viewCounter.getCount()}},addView:function(){viewCounter.checkSession();var b=viewCounter.getCount();var a=viewCounter.gaSession();if(!isNaN(parseFloat(b))&&isFinite(b)){b++}else{b=0}$.cookie("viewCounter",a+"."+b,{expires:30,path:"/"});return b},checkSession:function(){var a=viewCounter.gaSession();var d=$.cookie("viewCounter");var b=false;if(d){b=d.split(".")}if(b.length&&b[0]==a){return true}$.cookie("viewCounter",a+".0",{expires:30,path:"/"});return true},gaSession:function(){var b=$.cookie("__utma");var a=b.split(".");if(a.length&&a[5]){return a[5]}else{return""}}};var ajax_contact={options:{title:"Send your message:"},_create:function(){this.element.bind("ajax_contactsuccess",function(){jQuery(document).ajax_contact("handle_sent")}).bind("ajax_contactfailed",function(){jQuery(document).ajax_contact("handle_failed")})},init_dialog:function(){if(this.get_partial()!==null){this.dialog=jQuery(this.get_partial()).ted_dialog({title:this.options.title}).bind("dialogbeforeclose",this,function(b){var a=b.data;if(a.options.pubkey){jQuery("#recaptcha_div").html(a.options.pubkey)}a._trigger("cancelled");a.destroy();jQuery(".ui-widget-content").remove();jQuery("iframe").find(":last").remove();return true});this.result=this.dialog.find("#contact_result");this.form=this.dialog.find("#contact_form");this.form.submit(function(a){jQuery(document).ajax_contact("submit");a.preventDefault();a.stopPropagation();return false});this._setOption("pubkey",jQuery("#recaptcha_div").html())}},handle_sent:function(){this.result.html("Your message has been sent!");this.form.fadeOut("fast",function(){jQuery(".ui-widget-shadow").height(jQuery(this).parent().parent().outerHeight());setTimeout("jQuery(document).ajax_contact('close_dialog');",1500)})},handle_failed:function(f,a,d){var g="Your message could not be sent.";$("p.error").remove();$(".error").removeClass("error");for(var b in d.errors){this.form.find(":input[name*='"+b+"']").parent().addClass("error").append(jQuery('<p class="error">'+d.errors[b]+"</p>")).effect("highlight",{mode:"show"},500)}this.result.html('<span class="error">'+g+"</span>");jQuery(".ui-widget-shadow").height(jQuery(this.form).parent().parent().outerHeight());Recaptcha.reload()},show_form:function(a){if(!this.dialog){this.init_dialog()}this.open_dialog()},get_dialog:function(){return this.dialog},open_dialog:function(){this.dialog.dialog("open");var a=this.dialog;jQuery(".ui-widget-shadow").height(jQuery(".ui-widget-content").height()+140);Recaptcha.create(this.options.pubkey,"recaptcha_div",{})},close_dialog:function(){this.dialog.dialog("close");this.dialog.dialog("destroy")},set_uri:function(a){if(!this.dialog){this._setOption("uri",a)}else{this.dialog.dialog("option","uri",a)}},set_title:function(a){if(!this.dialog){this._setOption("title",a)}else{this.dialog.dialog("option","title",a)}},get_partial:function(){if(this.options.form_markup){return this.options.form_markup}jQuery.ajax({url:this.options.uri,type:"get",dataType:"json",async:false,data:{sf_format:"json"},success:function(b,a,d){this._setOption("form_markup",b.form)},error:function(d,a,b){},context:this});return this.options.form_markup},submit:function(){this._trigger("before_submit");jQuery.ajax({url:this.form.attr("action"),type:"post",dataType:"json",data:this.form.serialize(),success:function(b,a,d){if(b.status!="success"){this.handle_failed(d,a,b)}else{this.handle_sent()}},error:function(d,a,b){this.handle_failed(d,a,b)},context:this})}};jQuery.widget("ui.ajax_contact",ajax_contact);var ajax_login={options:{profileID:0,fullname:"",auth_nav:"",login_uri:"",sign_up_uri:"",width:"",height:""},_create:function(){this.element.bind("ajax_loginsuccess",function(){jQuery(document).ajax_login("handle_login")}).bind("ajax_loginfailed",function(){jQuery(document).ajax_login("handle_failed")});if(typeof window.logIn=="undefined"){window.logIn=function(a){try{jQuery(document).ajax_login("loginSuccess",$.extend(a,{status:"success"}))}catch(b){document.location.reload()}}}},show_login:function(){this.show_window(this.options.login_uri)},show_reg:function(){this.show_window(this.options.reg_uri)},show_window:function(d,b,a){if(!this.window||typeof this.window.window=="undefined"){var b=typeof b=="undefined"?this.options.width:b;var a=typeof a=="undefined"?this.options.height:a;var f=(screen.width/2)-(this.options.width/2);var e=(screen.height/2)-(this.options.height/2);this.window=window.open(d,"authPopup","menubar=no,toolbar=no,status=no,location=yes,width="+b+",height="+a+",toolbar=no,left="+f+",top="+e)}else{this.window.location=d;this.window.focus()}},logged_in:function(){return this.options.profileID!=0},get_profileID:function(){return this.options.profileID},set_title:function(a){},get_window:function(){return this.window},handle_login:function(){jQuery.get("/profiles/messageslayer",function(b,d,a){jQuery("#auth_nav").replaceWith(b)})},handle_failed:function(){},loginSuccess:function(d,a){var b=this;if(d.status=="success"){b.loginSuccessDisplay(d)}else{if(d.error_msg){b._setOption("error_msg",d.error_msg)}b._trigger("failed");b._trigger("error")}},loginSuccessDisplay:function(a){this._setOption("profileID",a.profileID);this._setOption("fullname",a.fullname);this._trigger("before_show_success");this._trigger("success")},window:false,login_status:false};jQuery.widget("ui.ajax_login",ajax_login);(function(e){e.widget("ui.carousel",{options:{btnPrev:null,btnNext:null,btnGo:null,mouseWheel:false,auto:null,speed:200,easing:null,vertical:false,circular:true,visible:3,start:0,scroll:1,beforeStart:null,afterEnd:null,data:[],itemCallback:null,readyCallback:null},_create:function(){this._div=this.element;this._ul=e("ul",this._div);this._tLi=e("li",this._ul);this._tl=this._tLi.size();this._v=this.option("visible");this.start=this.option("start");this._setup_items(this._tLi,this.option("data"));if(this.option("readyCallback")){this.option("readyCallback").call(this)}},_init:function(){this.init_circular();this.curr=this.start;this._running=false;this.init_styles();var f=this;if(this.option("btnPrev")){e(this.option("btnPrev")).bind("click",function(h){var g=f.curr-f.option("scroll");f._trigger("prev",h,g);return f.go(g)})}if(this.option("btnNext")){e(this.option("btnNext")).bind("click",function(h){var g=f.curr+f.option("scroll");f._trigger("next",h,g);return f.go(g)})}if(this.option("btnGo")){e.each(this.option("btnGo"),function(g,h){e(h).click(function(){return f.go(f.option("circular")?f._v+g:g)})})}if(this.option("mouseWheel")&&this._div.mousewheel){this._div.mousewheel(function(g,h){return h>0?f.go(f.curr-f.option("scroll")):go(f.curr+f.option("scroll"))})}if(this.option("auto")){setInterval(function(){f.go(f.curr+f.option("scroll"))},f.option("auto")+f.option("speed"))}},init_circular:function(){if(this.option("circular")){this._ul.prepend(this._tLi.slice(this._tl-this._v-1+1).clone(true)).append(this._tLi.slice(0,this._v).clone(true));this.start=this.option("start")+this._v}},init_styles:function(){this._animCss=this.option("vertical")?"top":"left";this._sizeCss=this.option("vertical")?"height":"width";this._li=e("li",this._ul);this._itemLength=this._li.size();this._div.css("visibility","visible");this._li.css({overflow:"hidden","float":this.option("vertical")?"none":"left"});this._ul.css({margin:"0",padding:"0",position:"relative","list-style-type":"none","z-index":"1"});this._div.css({overflow:"hidden",position:"relative","z-index":"2",left:"0px"});this._liSize=this.option("vertical")?a(this._li):d(this._li);this._ulSize=this._liSize*this._itemLength;this._divSize=this._liSize*this._v;this._li.css({width:this._li.width(),height:this._li.height()});this._ul.css(this._sizeCss,this._ulSize+"px").css(this._animCss,-(this.curr*this._liSize));this._div.css(this._sizeCss,this._divSize+"px")},_setup_items:function(g,h){var f=this;e(g).each(function(j){e(this).data(h[j]);if(f.option("itemCallback")){f.option("itemCallback").call(this,this,f)}})},vis:function(){return this._li.slice(this.curr).slice(0,this._v)},go:function(g){if(!this._running){if(this.option("beforeStart")){this.option("beforeStart").call(this,this.vis())}if(this.option("circular")){if(g<=this.start-this._v-1){this._ul.css(this._animCss,-((this._itemLength-(this._v*2))*this._liSize)+"px");this.curr=g==this.start-this._v-1?this._itemLength-(this._v*2)-1:this._itemLength-(this._v*2)-this.option("scroll")}else{if(g>=this._itemLength-this._v+1){this._ul.css(this._animCss,-((this._v)*this._liSize)+"px");this.curr=g==this._itemLength-this._v+1?this._v+1:this._v+this.option("scroll")}else{this.curr=g}}}else{if(g<0||g>this._itemLength-this._v){return}else{this.curr=g}}this.running=true;var f=this;this._ul.animate(this._animCss=="left"?{left:-(this.curr*this._liSize)}:{top:-(this.curr*this._liSize)},this.option("speed"),this.option("easing"),function(){if(f.option("afterEnd")){f.option("afterEnd").call(this,f.vis())}f.running=false});if(!this.option("circular")){e(this.option("btnPrev"),this.option("btnNext")).removeClass("disabled");e((this.curr-this.option("scroll")<0&&this.option("btnPrev"))||(this.curr+this.option("scroll")>this._itemLength-this._v&&this.option("btnNext"))||[]).addClass("disabled")}}return false}});function b(f,g){return parseInt(e.css(f[0],g))||0}function d(f){return f[0].offsetWidth+b(f,"marginLeft")+b(f,"marginRight")}function a(f){return f[0].offsetHeight+b(f,"marginTop")+b(f,"marginBottom")}})(jQuery);var ted_comment_loader={options:{currentCommentPage:1,commentsLoaded:0,commentsPerPage:30,preloaded:false,up_vote:"Great contribution!",down_vote:"Click to remove your vote.",add_flag:"Flag as abuse",flagged:"A notification has been sent to our moderation team."},_create:function(){this._setOption("sortOrder",this.element.find(".sort-comments").val());this.element.find(".sort-comments").bind("change",this,this.sort_comments);this.element.find("a.signin").bind("click",this,this.ask_login);this.element.find(".commentAddForm").ted_comment_editor({forum:this.options.forum});this.element.bind("ted_comment_editor_done",this,this.add_comment);this.comment_container=this.element.find(".comment-container");if(!this.options.preloaded){this.load_comments()}else{if(this.options.comment!=undefined){$("html,body").animate({scrollTop:$("#id-"+this.options.comment).offset().top-100},{duration:300})}this.receive_comments()}jQuery(document).one("ajax_loginsuccess",this,this.logged_in)},load_comments:function(d,a){var b;if(d!=undefined){b=d.data}else{b=this}var e={forum:b.options.forum,commentsLoaded:b.options.commentsLoaded,limit:a||b.options.commentsPerPage,sortby:b.options.sortOrder};if(b.options.comment!=undefined){e.c=b.options.comment}jQuery.ajax({type:"GET",url:"/comments/viewRPC",dataType:"html",data:e,success:b.receive_comments,error:b.receive_error,context:b});b.show_loader()},sort_comments:function(b){var a=b.data;a._setOption("sortOrder",jQuery(this).val());a._setOption("commentsLoaded",0);a.load_comments(b);$.cookie("commentSort",a.options.sortOrder,{expires:365,path:document.location.pathname.split("/").slice(0,2).join("/")})},receive_comments:function(b,a){this.element.find(".sortLoader").hide();var d=this.options.commentsLoaded;if(b!=undefined){if(d==0){this.comment_container.html(b)}else{this.element.find(".commentLoader").replaceWith(b)}this.element.find(".tedcred, .flair").tooltip({showURL:false,extraClass:"tip"})}this._setOption("commentsLoaded",this.options.commentsLoaded+this.options.commentsPerPage);this.element.find("div.comment").ted_comment({loader:this.element});if(!this.element.find(".commentLoader").hasClass("empty")){this.element.find(".loadComments").bind("click",this,this.load_comments)}this._trigger("_comments_loaded")},receive_error:function(d,a,b){this.element.find(".loadComments").html("Could not load comments. Try refreshing this page.")},add_comment:function(b,d){var a=b.data;if(d!=undefined&&d.comment){jQuery(d.comment).prependTo(a.comment_container.children(":first")).find("div.comment").ted_comment({loader:a.element});if(!a.comment_container.in_viewport()){jQuery("html,body").animate({scrollTop:a.comment_container.offset().top-100},{duration:300})}}},ask_login:function(a){if(a){a.preventDefault()}jQuery(document).ajax_login("set_title","Sign in to comment on this talk!").ajax_login("show_login")},logged_in:function(d){var a=d.data;var b=a.options.commentsLoaded;a._setOption("commentsLoaded",0);a.load_comments(d,b);jQuery("body").removeClass("signed-out");a.element.find(".username-profile-link").html(jQuery(document).ajax_login("option","fullname")).attr("href","http://www.ted.com/profiles/"+jQuery(document).ajax_login("option","profileID"))},show_loader:function(){this.element.find(".commentLoader").html('<img src="'+ted.baseUrl+'/images/ajax-loader.gif" />');this.element.find(".sortLoader").show()},get_form_markup:function(a){if(this.options.form_markup){return this.options.form_markup}jQuery.ajax({url:"/comments/commentForm",type:"get",dataType:"json",async:false,data:{context:a,forum:this.options.forum},success:function(d,b,e){this._setOption("form_markup",d.form)},error:function(f,b,d){},context:this});return this.options.form_markup}};jQuery.widget("ui.ted_comment_loader",ted_comment_loader);var ted_comment={options:{id:0,ups:0,downs:0,replying:false,editing:false,max_characters:2000,hidden:false,conversation:false},_create:function(){var b=this;if(this.options.id==0){this._setOption("id",parseInt(this.element.parent().attr("id").split("-")[1]));this._setOption("level",parseInt(this.element.closest("ul").attr("class").split("-")[1]))}else{this._setOption("conversation",true)}if(this.options.hidden==undefined){this._setOption("hidden",this.element.hasClass("disabled"))}this.reply_button=this.element.find(".reply").bind("click",this,this.reply);this.edit_button=this.element.find(".edit").bind("click",this,this.edit);this.delete_button=this.element.find(".delete").bind("click",this,this.delete_comment);this.up_button=this.element.find(".voteUp").bind("click",this,this.vote);var a=b.options.up_vote?b.options.up_vote:b.options.loader.ted_comment_loader("option","up_vote");this.up_button.tooltip({showURL:false,extraClass:"tip",bodyHandler:function(){return b.up_button.parent().hasClass("up")?b.options.loader.ted_comment_loader("option","down_vote"):a}});this.flag_button=this.element.find(".flag").bind("click",this,this.flag);this.flag_button.tooltip({showURL:false,extraClass:"tip",bodyHandler:function(){return b.flag_button.hasClass("flagged")?b.options.loader.ted_comment_loader("option","flagged"):b.options.loader.ted_comment_loader("option","add_flag")}});this.score_element=this.element.find(".score");var d=data_editable.indexOf(this.options.id)>=0;if(data_moderator||d){this.element.addClass("editable");this._setOption("editable",true)}if(d){this.element.addClass("owner");this._setOption("owner",true)}if(data_scores.indexOf(this.options.id)>=0){this.up_button.parent().addClass("up")}this.set_score(data_allScores[this.options.id]);if(data_flags.indexOf(this.options.id)>=0){this.set_flagged()}if(data_moderator&&this.options.level===0){this.move_button=jQuery("<a>").addClass("move").html("Move").bind("click",this,this.move).appendTo(this.element.find("div.commentBody"))}jQuery(".expireClock").bind("expire",this,this.disable)},ask_login:function(f,e){var d=this;var a=d.options.loader;a.ted_comment_loader("ask_login");var b=function(){a.one("ted_comment_loader_comments_loaded",function(){jQuery("#id-"+d.options.id+" div.comment:first").ted_comment(f,e)})};jQuery(document).one("ajax_loginsuccess",b);jQuery(document).bind("ajax_logincancelled",function(){jQuery(document).unbind("ajax_loginsuccess",b)})},reply:function(f){var b=f&&!f.isDefaultPrevented()?f.data:this;if(f){f.preventDefault()}if(!jQuery(document).ajax_login("logged_in")){b.ask_login("reply");return}if(b.element.hasClass("owner")){alert("You can't reply to your own comment");return false}if(b.options.replying||b.reply_button.length==0){return false}else{b._setOption("replying",true)}b.reply_button.html("Replying...").addClass("disabled");var e=b.element.siblings("ul");if(e.length==0){e=jQuery("<ul>").addClass("l-"+(b.options.level+1)).appendTo(b.element.parent())}var d=b.options.loader.ted_comment_loader("get_form_markup","reply");var a=jQuery("<li>").addClass("reply comment").hide().html(d).appendTo(e).slideDown(function(){var g=function(){a.ted_comment_editor("focus")};if(!a.in_viewport()){jQuery("html,body").animate({scrollTop:a.offset().top-100},{duration:300,complete:g})}else{g.call()}});a.ted_comment_editor({parent_id:b.options.id,forum:b.options.forum});a.one("ted_comment_editor_done",function(g,h){g.stopPropagation();a.slideUp(function(){a.remove();if(h!=undefined&&h.comment){var j=jQuery(h.comment).hide();j.appendTo(e).slideDown().find("div.comment").ted_comment({loader:b.options.loader})}});b.reply_button.html("Reply").removeClass("disabled");b._setOption("replying",false)})},edit:function(f){if(f){f.preventDefault()}var d=f?f.data:this;if(!jQuery(document).ajax_login("logged_in")){return}if(d.options.editing){return false}else{d._setOption("editing",true)}var g=d.element.find("div.commentBody");var b=g.find("span.commentText").text();var a=g.clone();var e=d.options.loader.ted_comment_loader("get_form_markup","edit");g.slideUp(function(){g.html(e);g.find("textarea").val();g.ted_comment_editor({id:d.options.id,text:b.replace(/<br>/ig,"\r")});d.element.one("ted_comment_editor_done",function(h,j){h.stopPropagation();g.slideUp(function(){if(j!=undefined&&j.comment){g.html(j.comment);g.slideDown()}else{g.html(a.html())}g.slideDown();g.ted_comment_editor("destroy")});d._setOption("editing",false)});g.slideDown(function(){g.ted_comment_editor("focus")})})},delete_comment:function(e){if(e){e.preventDefault()}var d=e?e.data:this;var b=function(){var f=jQuery(this).find("form").serializeArray();f.push({name:"id",value:d.options.id});jQuery.ajax({type:"POST",url:"/comments/delete",dataType:"json",data:f,beforeSend:function(){$(".ui-dialog-buttonset").prepend('<img src="'+ted.baseUrl+'/images/ajax-loader.gif" id="comment-delete-working" />');$(".ui-dialog-buttonset button span").first().html("Deleting Comment...")},success:function(h,g){if(h.status=="success"){d.element.find("div.commentBody").add(d.element.find("div.flairWrap")).slideUp(function(){d.element.find("h4").html("This post has been removed.").addClass("deleted");d.element.addClass("deleted disabled");d.element.confirmation_dialog("close")})}else{alert("Could not delete comment")}},error:function(){alert("Could not delete comment")}})};var a=function(f){if(d.options.editable&&!d.options.owner){jQuery.get("/comments/moderationForm",{comment:d.options.id},function(g){f(g)})}else{f("<form>Are you sure you want to delete this comment?<br />This action cannot be undone</form>")}};a(function(f){d.element.confirmation_dialog({title:"Delete this comment?",description:f,confirm:{title:"Delete",method:b}})})},vote:function(b){var a=b&&!b.isDefaultPrevented()?b.data:this;if(b){b.preventDefault()}if(!jQuery(document).ajax_login("logged_in")){a.ask_login("vote",b);return}if(a.options.voting==true){return}a._setOption("voting",true);jQuery.ajax({type:"POST",url:"/comments/vote",dataType:"json",data:{comment:a.options.id,up:a.up_button.parent().hasClass("up")?0:1},success:function(e,d){if(e.status=="success"){var f=parseInt(a.score_element.html())+e.score;a.set_score(f);a.up_button.parent().toggleClass("up",e.score==1)}else{alert(e.reason||"Could not rate this comment")}a._setOption("voting",false);if(a.options.conversation){$.GA_trackEvent("conversations","thumbs up","commentid="+a.options.id)}else{$.GA_trackEvent("comment","thumbs up","commentid="+a.options.id)}},error:a.receive_error,context:a})},set_score:function(a){if(a==undefined){return}this.score_element.html(a==0?a:"+"+a).toggleClass("pos",a>0)},flag:function(b){var a=b&&!b.isDefaultPrevented()?b.data:this;if(b){b.preventDefault()}if(!jQuery(document).ajax_login("logged_in")){a.ask_login("flag",b);return}if(a.options.flagged){return}jQuery("<div>").ted_dialog({title:a.options.conversation?"Flag this conversation":"Flag this comment?",buttons:{Flag:function(){var d=jQuery(this);var e=d.find("input[name=flag]:checked").val();if(e==undefined){d.find("p.error").html("You must select a reason for flagging this comment");return}jQuery.ajax({type:"POST",url:"/comments/flag",dataType:"json",data:{id:a.options.id,type:e},success:function(g,f){d.dialog("close");a.set_flagged();if(a.options.conversation){$.GA_trackEvent("conversations","flag","commentid="+a.options.id)}else{$.GA_trackEvent("comment","flag","commentid="+a.options.id)}},error:function(){alert("Could not flag comment")}})},Cancel:function(){jQuery(this).dialog("close")}}}).html('<p>Flagging a comment or conversation sends a notification to our moderation team. They will review the message and take the appropriate action.</p><p>This action cannot be undone.</p><form><p><input type="radio" name="flag" id="flag_spam" value="2" /> <label for="flag_spam">Flag as spam</label></p><p><input type="radio" name="flag" value="1" id="flag_inappropriate" /> <label for="flag_inappropriate">Flag as inappropriate</label></p><p class="error"></p></form>').dialog("open")},set_flagged:function(b){var a=b?b.data:this;a.flag_button.addClass("flagged");a._setOption("flagged",true)},move:function(b){var a=b&&!b.isDefaultPrevented()?b.data:this;if(b){b.preventDefault()}jQuery("<div>").ted_dialog({title:"Move comment thread",buttons:{Move:function(){var e=jQuery(this);var d=e.find("input[name=forum]").val();if(d==""){e.find("p.error").html("You must provide a forum to move this to.");return}jQuery.ajax({type:"POST",url:"/comments/move",dataType:"json",data:{comment:a.options.id,forum:d},success:function(g,f){if(g.status=="success"){e.dialog("close");alert("This comment has been moved!")}else{alert("Could not move this comment")}},error:function(){alert("Could not move this comment")}})},Cancel:function(){jQuery(this).dialog("close")}}}).html('<p>Move this comment thread to another conversation. Enter the Forum ID of the new conversation, which is displayed at the bottom of the conversation page.</p><form><p><input type="text" name="forum" value="" /></p><p class="error"></p></form>').dialog("open")},hide:function(b){if(b){b.preventDefault()}var a=b?b.data:this;a.element.find("div.commentBody").slideUp().andSelf().addClass("disabled");a.element.find("div.flairWrap").slideUp();a.element.parent().addClass("disabled");if(a.options.replying){a.element.trigger("ted_comment_editor_done")}a._setOption("hidden",true)},disable:function(b){if(b){b.preventDefault()}var a=b?b.data:this;a.reply_button.add(a.edit_button).add(a.delete_button).hide()},receive_error:function(d,a,b){alert("Could not vote on this comment");self._setOption("voting",false)}};jQuery.widget("ui.ted_comment",ted_comment);var ted_comment_editor={options:{max_characters:2000,replying:false,editing:false,voting:false,parent_id:0,ajax:true},_create:function(){this.textarea=this.element.find("textarea");if(this.options.text!=undefined){this.textarea.html(this.options.text)}this.char_count=this.element.find(".charactersUsed em");this.submit_button=this.element.find("input[type=submit]");this.cancel_button=this.element.find("input[type=reset]");this.submit_button.bind("click",this,this.submit);this.cancel_button.bind("click",this,this.cancel);this.textarea.bind("keyup",this,this.check_length).trigger("keyup");jQuery(".expireClock").bind("expire",this,this.disable)},submit:function(b){var a=b.data;if(a.options.ajax){b.preventDefault();if(!a.options.busy){a._setOption("busy",true);var e="add";var d={comment:a.textarea.val()};if(a.options.id!=undefined){e="edit";d.id=a.options.id}else{d.parent=a.options.parent_id;d.forum=a.options.forum}d.timeStamp=window.ted.timeStamp;jQuery.ajax({type:"POST",url:"/comments/"+e,dataType:"html",data:d,success:a.comment_added,error:a.error,context:a});if(a.options.conversation){$.GA_trackEvent("conversations","reply","commentid="+a.options.parent_id)}else{$.GA_trackEvent("comment","reply","commentid="+a.options.parent_id)}}}},comment_added:function(b,a){this.textarea.val("");this._setOption("busy",false);this.char_count.html(this.options.max_characters);this._trigger("_done",0,{comment:b})},error:function(d,a,b){this._setOption("busy",false);alert("Could not add comment")},cancel:function(b){var a=b?b.data:this;if(b){b.stopPropagation();b.preventDefault()}a._setOption("busy",false);a._trigger("_done")},disable:function(b){var a=b.data;if(a.textarea.val()==""){a.textarea.prop("disabled",true);a.element.slideUp()}a.submit_button.add(a.cancel_button).hide()},focus:function(){this.textarea.focus()},check_length:function(f){var b=f.data;var a=b.options.max_characters;var g=a-10;var d=a-100;var e=b.textarea.val().length;if(e>a){b.textarea.val(b.textarea.val().substring(0,a));e=a}b.char_count.html(a-e).toggleClass("commentOK",e<d).toggleClass("commentWarning",e>=d&&e<g).toggleClass("commentCritical",e>=g)}};jQuery.widget("ui.ted_comment_editor",ted_comment_editor);var confirmation_dialog={options:{title:"Are you sure?",description:"",open:true,dialog_element:jQuery("<div>"),confirm:{title:"OK"},cancel:{title:"Cancel"}},_create:function(){var d={};var b=this;var e=this.options.cancel.method||function(){b.close()};var a=this.options.confirm.method||function(){b.close()};d[this.options.confirm.title]=a;d[this.options.cancel.title]=e;this.dialog=this.options.dialog_element.ted_dialog({title:this.options.title,buttons:d}).html(this.options.description).bind("dialogclose",function(){b.end()});if(this.options.open){this.dialog.dialog("open")}},close:function(){this.dialog.dialog("close")},end:function(){this.dialog.dialog("destroy");this.destroy()}};jQuery.widget("ui.confirmation_dialog",confirmation_dialog);jQuery.widget("ui.emptyCheckbox",{options:{monitor:null,dateWidget:null},_create:function(){this.options.monitor.bind("change",this,function(a){a.data.changed()});if(this.options.dateWidget){this.options.dateWidget.bind("change",this,function(a){a.data.changed()})}this.element.bind("change",function(){jQuery(this).emptyCheckbox("checked")})},changed:function(){if(this.element.prop("checked")&&this.hasValue(this.options.monitor)){this.element.prop("checked",false)}},checked:function(){if(this.element.prop("checked")){this.options.monitor.val(null)}},hasValue:function(b){var a=jQuery.map(b,function(f,d){var e=$(f).val();return((e!==null&&e.length>0)?e:null)});return(a.length>0)}});var favorite_button={options:{favorited:false,post_data:{id:0,type:"talks"}},_create:function(){this.button=this.element;this.button.click(function(){jQuery(this).favorite_button("toggle")})},getFavorited:function(){return this.options.favorited},_setFavorited:function(a){if(a!=this.options.favorited){jQuery.ajax({type:"POST",url:a?"/profiles/addfavorites":"/profiles/removefavorites",dataType:"json",data:this.options.post_data,success:this.favoriteSuccess,error:this.favoriteError,context:this})}},toggle:function(){if(jQuery(document).ajax_login("logged_in")){this._setFavorited(!this.getFavorited())}else{var a=function(d){var b=d.data;b.favorite_button("toggle")};jQuery(document).ajax_login("set_title","Sign in to favorite this talk!").ajax_login("show_login").one("ajax_loginsuccess",this.element,a).one("ajax_logincancelled",this.element,function(b){jQuery(document).unbind("ajax_loginsuccess",b.data)})}},favoriteError:function(d,a,b){},favoriteSuccess:function(d,a){var b=this;if(d==""||d.status!="success"){}else{if(d.is_favorite){b.element.addClass("favorited").removeClass("favorite")}else{b.element.removeClass("favorited").addClass("favorite")}b._setOption("favorited",d.is_favorite)}}};jQuery.widget("ui.favorite_button",favorite_button);var filter_form={options:{ajax:false,hack_page_number:true,defaults:{}},_create:function(){var a=this;this.form=this.element.find("form");this.element.find(".radio_buttons li a").each(function(){jQuery(this).data("value",jQuery(this).attr("title"));jQuery(this).data("field",a.form.find("input[name="+jQuery(this).closest(".radio_buttons").attr("title")+"]"));jQuery(this).removeAttr("title")}).bind("click",function(b){b.preventDefault();(jQuery(this).data("field")).val(jQuery(this).data("value"));a.form.find("input[name=page]").val(1);a.submit()});this.element.find(".radio_buttons").removeAttr("title");this.form.find("select").bind("change",function(b){a.form.find("input[name=page]").val(1);a.submit()});if(this.options.hack_page_number){this.element.find(".pagination li a").bind("click",function(d){d.preventDefault();var b=jQuery(this).attr("href").match(/page(\/|\=)(\d+)/).pop();if(!isNaN(b)){a.form.find("input[name=page]").val(b)}a.submit()})}},submit:function(){var a=this;var b=jQuery.param(jQuery.map(this.form.serializeArray(),function(f,e){var d=a.options.defaults[f.name]||"";if(f.value==d){return null}else{return f}}));if(b.length>1){window.location.search=b}else{window.location=window.location.pathname}}};jQuery.widget("ui.filter_form",filter_form);var html5_video_player={options:{id:0,layout:"",thumbnail:"",playing:false,muted:false,current_time:0,duration:0,has_ended:false,stalled:false,trackTimes:{0:false,30:false,60:false,90:false,120:false,240:false,360:false,480:false,600:false,720:false,840:false}},_create:function(){alert("creating video");this.element;this.element.empty().addClass("html5_video_player").append(this.options.layout);this.video=this.element.find("video");this.video_dom=this.video.get(0);var a=navigator.userAgent.toLowerCase();this.is_iphone=(a.indexOf("iphone;")!=-1)||(a.indexOf("ipod;")!=-1);this.is_ipad=(a.indexOf("ipad;")!=-1);if(this.is_iphone){this.video.attr("poster",this.options.thumbnail)}if(this.is_ipad){this.video.removeAttr("controls")}this.images=this.element.find(".content_container img");this.images.bind("click",this,this.play_pause);this.high_res=this.element.find("source.high-res");this.standard_res=this.element.find("source.standard");this.should_load=false;if($.cookie("html5_video_high_res")=="high"){this.set_source(this.high_res.get(0).src,true)}this.quality_switch=$("#quality_switch").touch_switch({on:$.cookie("html5_video_high_res")=="high"}).bind("touch_switch_switched",this,this.change_quality);this.video.bind("durationchange",this,function(d){var b=d.data;b._setOption("duration",b.video_dom.duration)}).bind("timeupdate",this,this._ontimeupdate).bind("play",this,this._onplay).one("play",this,this._first_play).bind("pause",this,this._onpause).bind("ended",this,this._onended).bind("waiting",this,this._onwaiting).bind("mouseover",this,function(){alert("mouseover happened")}).bind("click",this,function(){alert("click happened")});$("#html5_subtitles").change(function(){var d=$(this).val();var b=d?"/talks/lang/"+$(this).val()+"/":"/talks/";document.location.href=document.location.href.replace(/\/talks\/(lang\/\w+\/)?/,b)});this._trigger("_loaded")},play_pause:function(b){var a=b.data;if(a.options.playing){a.pause()}else{a.play()}},get_time:function(){return self.options.current_time},set_time:function(a){this.video_dom.currentTime=a},pause:function(){this.video_dom.pause()},play:function(){if(this.should_load){this.video_dom.load();this.should_load=false}this.video_dom.play()},set_source:function(f,e){var h=this.options.current_time;var d=this.options.playing;var g=this.video.attr("controls");var b=this;this.video_dom.src=f;this.video.removeAttr("controls");if(g){$.GA_trackEvent(analyticsCategory,"view_switch",e?"high":"standard");var a=$("<div/>").addClass("spinner");this.element.find(".content_container").append(a);this.video_dom.load();this.video.one("canplaythrough",this,function(j){b.set_time(h);a.remove();if(d){b.play()}else{b.video.attr("controls","controls")}})}else{this.should_load=true}return this},_onplay:function(b){var a=b.data;a._setOption("playing",true);a.video.attr("controls","controls");a.images.hide()},_first_play:function(b){var a=b.data;$.GA_trackEvent(analyticsCategory,"view",a.quality_switch.touch_switch("getOn")?"high":"standard")},_onpause:function(b){var a=b.data;a._setOption("playing",false);alert("onpause")},_onended:function(b){var a=b.data;a.pause();if(!a.options.has_ended){$.GA_trackEvent(analyticsCategory,"complete",a.options.id);a._setOption("has_ended",true)}},_ontimeupdate:function(e){var a=e.data;var d=a.video_dom.currentTime;a._setOption("current_time",d);var b=a.options.trackTimes;for(key in b){if(!b[key]){if(d>key){$.GA_trackEvent(analyticsCategory,key,a.options.id);b[key]=true}}}},_onwaiting:function(b){var a=b.data;if(a.options.stalled){$.GA_trackEvent(analyticsCategory,"stalled",a.options.id)}else{a._setOption("stalled",true)}},change_quality:function(b,d){var a=b.data;$.cookie("html5_video_high_res",d.state?"high":"low");if(d.state){a.set_source(a.high_res.get(0).src,d.state)}else{a.set_source(a.standard_res.get(0).src,d.state)}}};$.widget("ui.html5_video_player",html5_video_player);(function(b){var a={_create:function(){this.edit_url="";this.delete_url="";this.element.addClass(this.widgetBaseClass);this._attach_event_listeners();this._trigger("_update",null,["new",this])},_attach_event_listeners:function(){var e=this;var f=this.element.find("a:contains('Edit')").bind("click",function(h){h.preventDefault();if(!e.options.disabled){e.edit()}});if(f.length){e.edit_url=f.attr("href")}var g=this.element.find("a:contains('Delete')");if(g.length&&g.attr("onclick")){this._csrf_token=g.attr("onclick").toString().match(/(\w){32}/)[0];this.delete_url=g.attr("href");g.removeAttr("onclick").bind("click",function(h){h.preventDefault();if(!e.options.disabled){e.rm()}})}e.element.bind("list_item_enable",function(){e.enable()});e.element.bind("list_item_disable",function(){e.disable()})},edit:function(){var e=this;b.ajax({type:"GET",url:e.edit_url,data:null,success:function(g,f){if("success"==g.status){e._trigger("_edit_item",null,[e,g])}},beforeSend:function(){e._trigger("_ajax",null,"start")},complete:function(){e._trigger("_ajax",null,"end")},dataType:"json"});return this},rm:function(){var e=this;b.post(e.delete_url,{sf_method:"delete",_csrf_token:e._csrf_token},function(g,f){if("success"==g.status){e.element.fadeOut(500,function(){e.element.removeClass(this.widgetBaseClass);e._trigger("_update",null,["delete",e]);e.element.remove()})}},"json")},disable:function(){b.Widget.prototype.disable.call(this);this.element.addClass(this.options.disabled_class);this.element.find("a").each(function(){link=b(this);link.data("_href",link.attr("href")).removeAttr("href")});return this},enable:function(){b.Widget.prototype.enable.call(this);this.element.removeClass(this.options.disabled_class);this.element.find("a").each(function(){link=b(this);link.attr("href",link.data("_href"))});return this}};b.widget("ui.list_item",a);b.ui.list_item.defaults={disabled_class:"",list_item_container:null};var d={_create:function(){this.list_items=[];this.active_item=null;this.element.addClass(this.widgetBaseClass);this._attach_event_listeners();this.list_items=this.element.children().list_item();if(this.options.sortable){this.element.sortable()}},_attach_event_listeners:function(){var e=this;var f=b(e.options.form);this.element.bind("list_item_edit_item",function(h,g){e.activate_item(g)});this.element.bind("list_item_update",function(j,h,g){e.list_items=e.element.find(".ui-list_item");e.check_limit()});if(f.length){this.element.bind("list_item_edit_item",function(j,h,g){f.trigger("virtual_form_set_state",["edit",g.object,g.update_url])});this.element.bind("list_item_container_limit",function(h,g){if("over"==g){f.trigger("virtual_form_hide")}else{f.trigger("virtual_form_show")}});f.bind("virtual_form_state_change",function(h,g){if("edit"==g){f.trigger("virtual_form_show")}else{if("add"==g){e.deactivate_item();e.check_limit()}}});f.bind("virtual_form_submit_success",function(h,g){e.update_items(g);f.trigger("virtual_form_set_state","add")})}},get_items:function(){return this.list_items},get_active_item:function(){return this.active_item},activate_item:function(e){if(this.active_item){this.active_item._trigger("_enable")}e._trigger("_disable");this.active_item=e},deactivate_item:function(){if(this.active_item){this.active_item._trigger("_enable");this.active_item=null}},check_limit:function(){var e=this.options.limit;if(e){if(this.list_items.length<e){this._trigger("_limit",null,"under")}else{if(this.list_items.length>=e){this._trigger("_limit",null,"over")}}}},update_items:function(g){var f=this;var e=f.active_item?f.active_item.element:b("<div/>").appendTo(f.element);var h=b(b.nano(f.options.markup,g.template_values));e.replaceWith(h);h.list_item().effect("highlight",{mode:"show"},500);if(f.active_item){f.active_item.destroy()}}};b.widget("ui.list_item_container",d);b.ui.list_item_container.defaults={markup:"",limit:null,form:null,sortable:false}})(jQuery);$.widget("ui.mapAddress",{options:{insert_after:null,address_inputs:[],required_inputs:[],lat_input:null,lng_input:null},_create:function(){var b=this;this._address_inputs=this.options.address_inputs;this._required_inputs=this.options.required_inputs;this._insert_after=this.options.insert_after;this._lat_input=this.options.lat_input;this._lng_input=this.options.lng_input;this._status_container=jQuery("<div></div>");this._map_container=jQuery("<div></div>");this._map_container.css({height:"200px",width:"520px"});var d=(this._insert_after!=null)?this._insert_after:this.element;d.append(this._status_container);this._status_container.after(this._map_container);if(this._defaultIsEmpty()){this._setDefaults()}jQuery.each(this._address_inputs,function(){this.bind("change",function(){b.fieldChanged()})});this._geocoder=new google.maps.Geocoder();this._map=new google.maps.Map(this._map_container.get(0),{disableDefaultUI:true,center:new google.maps.LatLng(0,0),keyboardShortcuts:false,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:1,minZoom:1});if(this._lat_input.val()!=0&&this._lng_input.val()!=0){var a=new google.maps.LatLng(this._lat_input.val(),this._lng_input.val());this._plotCoordinates(a)}},_setDefaults:function(){jQuery.each(this._required_inputs,function(){this.data("default_value",this.val())})},_allDefaultsChanged:function(){if(this._all_modified_once){return this._all_modified_once}var a=[];jQuery.each(this._required_inputs,function(){if(this.data("default_value")==this.val()){return false}a.push(this)});return this._all_modified_once=(this._required_inputs.length==a.length)},_defaultIsEmpty:function(){var a=jQuery.map(this._required_inputs,function(b){if(b.val()!==""){return b.val()}});return a.length==0},fieldChanged:function(){if(this._allDefaultsChanged()){this.geoCode()}},_getAddressInput:function(){var a=jQuery.map(this._address_inputs,function(b){if(b.val()!==""){return(b.get(0).tagName.toLowerCase()!="select")?b.val():jQuery("option:selected",b).text()}});return a.join(" ")},geoCode:function(){var a=this;this._geocoder.geocode({address:this._getAddressInput()},function(d,b){if(b!=google.maps.GeocoderStatus.OK||d[0].partial_match){a._geoCodeError(b)}else{a._geoCodeResult(d)}})},_geoCodeResult:function(b){var a=b[0];this._status_container.text("Showing: "+a.formatted_address);this._setLatLong(a.geometry);this._plotCoordinates(a.geometry.location)},_geoCodeError:function(a){this._status_container.html('<p class="error">We\'re unable to locate: '+this._getAddressInput()+"<br>Please check the address and try again.</p>")},_setLatLong:function(a){this._lat_input.val(a.location.lat());this._lng_input.val(a.location.lng())},_plotCoordinates:function(a){if(!this._marker){this._marker=new google.maps.Marker({map:this._map})}this._marker.setPosition(a);this._map.setCenter(a);this._map.setZoom(15)}});(function(a){a.widget("ui.paginate",{options:{more:"<span>Load <span class='notranslate nostyle'>{per_page}</span> more {type} (Showing <span class='notranslate nostyle'>1 - {last}</span> of <span class='notranslate nostyle'>{total}</span>)</span>",loading:"<span><img src='"+ted.baseUrl+"/images/reboot/loader.gif' /> Loading&#133;</span>",done:"<p class='show-more'>Showing all results</p>",on_page:null,form:null,pager_options:{}},_create:function(){this.element.addClass(this.widgetBaseClass);this.pager=a.pager(this.options.pager_options);this.form=a(this.options.form);this.click_event={click:jQuery.proxy(this,"_page")};this.element.bind(this.click_event);this.element.bind("paginate_handle_loading",jQuery.proxy(this,"handle_loading"));this.element.bind("paginate_handle_complete",jQuery.proxy(this,"handle_complete"));this.element.ajaxSend(jQuery.proxy(function(d,f,b){if(d.target==this.element.get(0)){this._trigger("_handle_loading")}},this));this.element.ajaxComplete(jQuery.proxy(function(d,f,b){if(d.target==this.element.get(0)){this._trigger("_handle_complete")}},this))},_page:function(f){this.form.triggerHandler("submit");var d=a.param(a.merge(this.form.serializeArray(),[{name:"page",value:this.pager.nextPage()}]));f.preventDefault();var b=this.form.length!==0?this.form.attr("action"):"";a.get(b+"?"+d,jQuery.proxy(function(e){this.pager.next();this.options.on_page(e);this._trigger("_handle_success")},this))},handle_loading:function(b){this.element.html(a(this.options.loading)).unbind(this.click_event).removeAttr("href")},handle_complete:function(b){if(this.pager.isLast()){this.element.replaceWith(this.options.done);this._trigger("_done")}else{this.element.attr("href","#").bind(this.click_event).html(a.nano(this.options.more,{last:this.pager.last(),per_page:Math.min(this.pager.remaining(),this.pager.settings.per_page),total:this.pager.settings.total,type:this.pager.settings.type}))}},_setOption:function(b,d){a.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){a.Widget.prototype.destroy.call(this);this.element.remove()}})}(jQuery));var rater={options:{max_ratings:3,rated:0,ratings:[],id:0,url_submit:"/talks/ratetalk",url_update:"/talks/ratings",userRatings:[],NUMBER_OF_TAG_SIZES:5},_create:function(){this.checkboxes=this.element.find("input:checkbox");this.checkboxes.bind("click",this,this._allow_rating);this.labels=this.element.find("label");this.labels.bind("click",this,this._allow_rating);this.element.find("a.submit").bind("click",this,this.submit);this.element.find("a.reset").bind("click",this,this.reset);this.tabs=jQuery("#rate_tabs").bind("tabsselect",this,this._show_ratings).tabs();jQuery("#ratings_dialog").one("dialogopen",this,this._update_ratings)},_allow_rating:function(e){var a=e.data;var d=jQuery(this);var b="";if(b=d.prop("for")){var f=a.checkboxes.filter("[name="+a._escape_attr(b)+"]:enabled:last");f=f.get(0);f.checked=!f.checked}else{var f=this}if(f.checked&&a._can_rate()){e.preventDefault();e.stopPropagation();f.checked=!f.checked;return false}else{a._handle_rating(f);f.blur()}},_handle_rating:function(a){this._setOption("rated",this.checkboxes.filter(":checked").size());var d=this.options.ratings;if(a.checked){d.push(a.value);this.checkboxes.filter("[name="+this._escape_attr(a.name)+"]:disabled:first").prop("disabled",false)}else{for(var b=0;b<3;b++){if(d[b]==a.value){d.splice(b,1)}}var e=this.checkboxes.filter("[name="+this._escape_attr(a.name)+"]")}this._set_state(e)},_can_rate:function(){return this.options.rated>=this.options.max_ratings},_set_state:function(){var a=this;if(a.options.rated==a.options.max_ratings){a.checkboxes.filter(":not(:checked)").prop("disabled",true)}else{a.labels.each(function(){var e=jQuery("input[name="+a._escape_attr(jQuery(this).prop("for"))+"]");var d=e.filter(":checked").size();var b=d+1;e.each(function(g,f){if(d>0){jQuery(f).prop("checked",true);d--}else{jQuery(f).prop("checked",false)}if(b>0){jQuery(f).prop("disabled",false);b--}else{jQuery(f).prop("disabled",true)}})})}},_escape_attr:function(a){return a.replace(/(\[|\])/g,"\\$1")},submit:function(b){self=b.data;var a=self.options.ratings.join(",");jQuery.ajax({type:"POST",url:self.options.url_submit,dataType:"json",data:{wordids:a,talkid:self.options.id},success:self._rate_success,error:self._rate_error,context:self});return false},reset:function(a){self=a.data;self.checkboxes.filter(":checked").prop("checked",false);self._setOption("rated",0);self._setOption("ratings",[]);self._set_state();return false},_rate_success:function(d,a){var b=this;if(d!=""&&d.status=="success"){b._update_data(d)}b._prevent_rating()},_rate_error:function(e,a,d){var b=this;b._prevent_rating()},_prevent_rating:function(){this.tabs.tabs("select",1);this.element.find("a[href=#rate_ratings]").html("You already rated this talk").css("color","#666");this.tabs.tabs("disable",0)},_update_ratings:function(b,d){var a=b.data;jQuery.ajax({type:"POST",url:a.options.url_update,dataType:"json",data:{id:a.options.id},success:a._get_ratings,error:a._get_ratings_error,context:a})},_update_data:function(b){jQuery("#num_ratings").html(b.totalRatings);this._setOption("userRatings",b.userRatings);this._determine_ratings_distribution();var a=this;jQuery.each(b.userRatings,function(){var d="";if(this.count==a.options.min_rating){d="tag1"}else{if(this.count==a.options.max_rating){d="tag5"}else{if(this.count>=(a.options.min_rating+(a.options.distribution*2))){d="tag4"}else{if(this.count>=(a.options.min_rating+a.options.distribution)){d="tag3"}else{d="tag2"}}}}jQuery("#word_result_"+this.id).get(0).className=d});if(b.alreadyRated){this._prevent_rating()}},_get_ratings:function(d,a){var b=this;if(d!=""&&d.status=="success"){b._update_data(d)}},_get_ratings_error:function(d,a,b){},_determine_ratings_distribution:function(){var b=this.options.userRatings;b.sort(function(g,f){return g.count-f.count});var d=b[0].count;var e=b[b.length-1].count;var a=(e-d)/this.options.NUMBER_OF_TAG_SIZES;this._setOption("min_rating",d);this._setOption("max_rating",e);this._setOption("distribution",a)},_show_ratings:function(d,e){var b=d.data;if(e.index==1){var a=jQuery(e.panel);jQuery(e.panel).find("span").each(function(f){var g=jQuery(this).css("font-size").split("px")[0];jQuery(this).css("font-size",0+"px").animate({fontSize:g*1.4+"px"},{duration:340,easing:"easeInOutQuad"}).animate({fontSize:g*0.95+"px"},{duration:360}).animate({fontSize:g*1.05+"px"},{duration:380,easing:"easeInOutQuad"}).animate({fontSize:g*0.98+"px"},{duration:400}).animate({fontSize:g+"px"},{duration:333,easing:"easeInOutQuad"})})}}};jQuery.widget("ui.rater",rater);$.widget("ui.showHideFields",{options:{conditionFunction:null,clearInputs:true},_create:function(){var a=this;a.first_run=true;a.nodes=[];$(a.options.dependents).each(function(b,d){a.nodes[a.nodes.length]={node:$(d.node),show:d.show}});a.element.bind("change",function(b){a.activate()});a.activate();a.first_run=false},_clearInput:function(a){$(a).find(":input").val("").prop("disabled",true)},_show:function(a){$(a).find(":input").prop("disabled",false);$(a).show(1,function(){$(this).find(":input").effect("highlight",{},2000)})},_hide:function(a){$(a).hide(1);if(this.options.clearInputs&&!this.first_run){this._clearInput(a)}},activate:function(){var a=this;var b=a.condition(a.element.val());$(a.nodes).each(function(){if(this.show==b){a._show(this.node)}else{a._hide(this.node)}})},condition:function(a){return this.options.conditionFunction(a)}});var sponsor_popover={options:{image_width:306,image_height:91,image_height_full:245,adSpace_height:104,dialog_position_element:"#maincontent",dialog_width:900,dialog_height:435,player_element:"#streamingPlayerSWF"},_create:function(){this.element.height(this.options.adSpace_height);this.payload=this.options.payload;this.setup_img();this.setup_tracking();if(this.payload.video.length){this.setup_popover()}},destroy:function(){this.element.removeAttr("style");this.element.children().remove();this.img.unbind();this.img=null;if(this.dialog){this.dialog.unbind();this.dialog=null}return $.Widget.prototype.destroy.call(this)},click:function(f){var b=f.data;if(b.payload.video.length==0){window.open(b.payload.click_url)}else{if(jQuery(window).scrollTop()>b.position.top){jQuery("html,body").animate({scrollTop:0},{duration:300})}b.track(b.payload.click_url);if(b.player.isVideoPlaying()){b.player.pauseVideo();b.dialog.one("dialogclose",function(g,h){b.player.playVideo()})}if(jQuery.browser.msie){b.write_swf()}var a=Math.random()*100000000000000000;var d="http://ad.doubleclick.net/ad/tconf.ted/popover;tile=1;sz=1x1;companion="+b.payload.companion_key+";ord="+a+"?";var e="http://ad.doubleclick.net/jump/tconf.ted/popover;tile=1;sz=1x1;companion="+b.payload.companion_key+";ord="+a+"?";b.track(d);if(b.payload.popover_impression_url!=""){b.track(b.payload.popover_impression_url)}b._setOption("popover_click_url",e);b.dialog_right.unbind("click");b.dialog_right.bind("click",function(g){g.stopPropagation();g.preventDefault();window.open(b.options.popover_click_url);return false});b.dialog.dialog("open")}},setup_img:function(){var b=this;b.element.hide();var a=b.img=jQuery("<div>");a.data("full_height",false);a.addClass("sponsor_rollover");a.css({backgroundImage:"url("+b.payload.creative+")"});a.width(b.options.image_width);a.height(b.options.image_height);a.bind("click",b,b.click);a.mouseover(function(d){a.oneTime(150,function(){a.data("full_height",true);a.animate({height:b.options.image_height_full},{duration:400,easing:"easeInExpo",queue:false});jQuery.GA_trackEvent("popover","companion-rollover",b.payload.title)})});a.mouseout(function(d){a.stopTime();a.stop().animate({height:b.options.image_height},{duration:200,easing:"easeInExpo",queue:false});a.data("full_height",false)});b.element.append(a);b.element.fadeIn()},setup_tracking:function(){if(this.payload.secondary_impression_url!=""){if(typeof(this.payload.secondary_impression_url)=="object"){var a=this;jQuery.each(this.payload.secondary_impression_url,function(d,b){a.track(b)})}else{this.track(this.payload.secondary_impression_url)}}},setup_popover:function(){this.player=jQuery(this.options.player_element).get(0);this.position=jQuery(this.options.dialog_position_element).position();this.dialog=jQuery("<div>").attr("id","sponsor_dialog").ted_dialog({absolute_position:true,position:[this.position.left,this.position.top],width:this.options.dialog_width,height:this.options.dialog_height}).bind("dialogbeforeclose",function(a,b){jQuery("#sponsor_player").get(0).sendEvent("PLAY","false")});this.dialog_left=jQuery("<div>").addClass("left_column").appendTo(this.dialog);this.dialog_right=jQuery("<div>").addClass("right_column").appendTo(this.dialog);this.dialog_left.append(jQuery("<div>").attr("id","sponsor_player"));this.write_swf();this.dialog_right.append(jQuery("<img>").addClass("sponsor_image").attr("src",this.payload.logo)).append(jQuery("<p>").addClass("sponsor_text").html(this.payload.popover_primary_text)).append(jQuery("<p>").addClass("sponsor_secondary_text").html(this.payload.popover_secondary_text))},track:function(b){var a=document.createElement("img");a.src=b;this.images.push(a)},write_swf:function(){var d={allowscriptaccess:"always",allowfullscreen:"true"};var a={file:this.payload.video,image:this.payload.video_poster,streamer:"rtmp://streaming.ted.com/ondemand&playlist=none&autostart=true&stretching=uniform&width=512&height=288"};var b=this;swfobject.embedSWF("http://video.ted.com/assets/player/jwplayer/5.10/player.swf","sponsor_player","512","312","9.0.124",null,a,d,{},function(f){b.swfobject=f.ref})},is_displayed:function(){return this.dialog.dialog("isOpen")},images:[]};jQuery.widget("ui.sponsor_popover",sponsor_popover);var touch_switch={options:{on:false,off_position:-43,on_position:0,hover_position:-21},_create:function(){if(this.getOn()){this.setBackgroundPosition(this.options.on_position)}this.element.bind("click",this,this.click).bind("touchstart",this,this.start_swipe).bind("touchmove",this,this.continue_swipe).bind("touchend",this,this.end_swipe)},getOn:function(){return this.options.on},setOn:function(a){if(this.getOn()!=a){this._setOption("on",a);this._trigger("_switched",undefined,{state:a})}return this},getBackgroundPosition:function(){return parseInt(this.element.css("backgroundPositionX").split("px")[0])},setBackgroundPosition:function(a){if(a<this.options.off_position){a=this.options.off_position}if(a>this.options.on_position){a=this.options.on_position}this.element.css({backgroundPositionX:a});return this},click:function(d){var a=d.data;var b=a.getOn();a.element.animate({backgroundPositionX:a.options[(b?"off":"on")+"_position"]});a.setOn(!b)},start_swipe:function(b){b.preventDefault();var a=b.data;var d=b.originalEvent.touches[0];a.touch_start=d.pageX;a.background_position_start=a.getBackgroundPosition();a.element.css({backgroundPositionY:a.options.hover_position});a.moved=false},continue_swipe:function(b){b.preventDefault();var a=b.data;a.moved=true;return a.move_switch(b.originalEvent.touches[0])},end_swipe:function(b){b.preventDefault();var a=b.data;a.element.css({backgroundPositionY:0});if(a.moved){var e=a.getBackgroundPosition();var d=e<(a.options.off_position-a.options.on_position)/2;a.element.animate({backgroundPositionX:a.options[(d?"off":"on")+"_position"]},{duration:50});a.setOn(!d)}else{a.click(b)}},move_switch:function(b){var a=b.pageX-this.touch_start;this.setBackgroundPosition(this.background_position_start+a)}};jQuery.widget("ui.touch_switch",touch_switch);var twitter_feed={options:{params:{},template:'<div><p class="text"><a href="http://twitter.com/{from_user}" target="_blank">{from_user}</a></b>: {text}<br/>{created_at}<br /><br /></p></div>',frequency:10000},_create:function(){jQuery.fn.reverse=Array.prototype.reverse;this.data=$.extend({},this.defaults,this.options.params);this.max_display=this.data.rpp;this.getTweets()},getTweets:function(){var a=this.url+"?"+$.param(this.data);var b=this;$.getJSON(a+"&callback=?",function(d){$(d.results).reverse().each(function(){var f=new Date(this.created_at);var e=$.extend({},this,{text:b.linkify(this.text),created_at:f.toLocaleString()});var h=$.nano(b.options.template,e);var g=b.element.children();if(g.length+1>b.max_display){$(g[g.length-1]).remove()}b.element.prepend(h).hide().fadeIn("slow")});b.data=$.extend({},b.data,{rpp:1,since_id:d.max_id});setTimeout(function(){b.getTweets()},b.options.frequency)})},linkify:function(a){a=a.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/g,function(b){return b.link(b)});a=a.replace(/[@]+[A-Za-z0-9-_]+/g,function(b){var d=b.replace("@","");return b.link("http://twitter.com/"+d)});return a.replace(/[#]+[A-Za-z0-9-_]+/g,function(d){var b=d.replace("#","%23");return d.link("http://search.twitter.com/search?q="+b)})},url:"http://search.twitter.com/search.json",defaults:{q:"",rpp:2,lang:"en",since_id:0}};jQuery.widget("ui.twitter_feed",twitter_feed);(function(a){var b={options:{update_url:null,url:null,show_errors:true,initial_state:"add",clear_fields:true,button_markup:'<input type="submit" value="{type}"/>',error_markup:'<ul class="error_list"><li>{error}</li></ul>',loading_img:"/images/ajax-loader.gif"},_create:function(){this.fields_to_clear=a();this.form_input_defaults=a();this.form_errors=[];this.add_button=null;this.edit_button=null;this.cancel_button=null;this.loading_img=null;var d=this;d.element.bind("keypress",function(f){if((f.keyCode?f.keyCode:f.which)==a.ui.keyCode.ENTER){f.preventDefault();d.form_submit()}});d.store_defaults();d.clear_fields();d._init_submit_button();d._init_edit_button();d._init_loading_indicator();d.set_state(d.options.initial_state);d._attach_event_listeners()},_attach_event_listeners:function(){var d=this;this.element.bind("virtual_form_hide",function(){d.hide()});this.element.bind("virtual_form_show",function(){d.show()});this.element.bind("virtual_form_set_state",function(j,h,f,g){d.set_state(h,f,g)})},_init_submit_button:function(){var d=this;d.add_button=d.element.find(":input:[type=submit]:[value='Add']");if(!d.add_button.length){d.add_button=a(a.nano(d.options.button_markup,{type:"Add"})).appendTo(a(d.options.button_container))}d.add_button.bind("click",d,function(f){f.preventDefault();d.form_submit()})},_init_edit_button:function(){var d=this;d.edit_button=d.element.find(":input:[type='submit']:[value='Update']");if(!d.edit_button.length){d.edit_button=a(a.nano(d.options.button_markup,{type:"Update"})).insertAfter(d.add_button)}d.cancel_button=d.cancel_button||a(a.nano(d.options.button_markup,{type:"Cancel"})).insertBefore(d.edit_button);a(d.edit_button).bind("click",d,function(f){f.preventDefault();d.form_submit()});a(d.cancel_button).bind("click",d,function(f){f.preventDefault();d.set_state("add")})},_init_loading_indicator:function(){var d=a("<img>").attr("src",this.options.loading_img).attr("style","display:none; float:left; margin-right: 10px; padding:3px 0;").insertBefore(self.add_button);this.element.bind("virtual_form_ajax",function(g,f){if("start"==f){d.show()}else{d.hide()}})},set_state:function(f,d,e){this._state=f;this.form_reset();if("add"==f){this.cancel_button.hide();this.edit_button.hide();this.add_button.show()}else{if("edit"==f){this.cancel_button.show();this.edit_button.show();this.add_button.hide();if(d!=undefined){this.form_populate(d)}if(e!=undefined){this._setOption("update_url",e)}}}this._trigger("_state_change",null,f)},form_submit:function(){var d=this;var f=d.element.find(":input");if("add"==d._state){var e=d.options.url}else{if("edit"==d._state){var e=d.options.update_url;f=f.add(a("<input>").attr("name","sf_method").attr("value","put"))}}a.ajax({type:"POST",url:e,data:a(f).serialize(),success:function(h,g){if("success"==h.status){d._trigger("_submit_success",null,h)}else{d.handle_error(h)}},beforeSend:function(){d._trigger("_ajax",null,"start")},complete:function(){d._trigger("_ajax",null,"end")},dataType:"json"})},handle_error:function(e){this.element.trigger("form_error",[e]);if(this.options.show_errors){this.reset_errors();for(var f in e.errors){var d=a(a.nano(this.options.error_markup,{error:e.errors[f]}));this.form_errors.push(d);this.element.find(":input[name*='"+f+"']").parent().addClass("error").append(d.get(0)).effect("highlight",{mode:"show"},500)}}},form_populate:function(d){for(var e in d){var f=this.element.find(":input").filter(function(){if("autocomplete"==e&&a(this).hasClass("ac_input")){return true}var g=new RegExp("\\["+e+"\\]");return g.test(a(this).attr("name"))});if(f.is(":checkbox")){f.prop("checked",d[e])}else{f.val(d[e])}f.trigger("change")}},form_reset:function(){this.reset_inputs();this.reset_errors()},reset_errors:function(){for(error in this.form_errors){a(this.form_errors[error]).remove();a(this.form_errors[error]).parent().removeClass("error")}this.form_errors=[]},store_defaults:function(){var d=this;d.form_input_defaults=d.element.find(":input").each(function(){var e=a(this);e.data("form_default_value",e.is(":checkbox")?e.is(":checked"):e.val())})},reset_inputs:function(){this.form_input_defaults.each(function(){var d=a(this);if(d.is(":checkbox")){d.prop("checked",d.data("form_default_value"))}else{d.val(d.data("form_default_value"))}d.trigger("change")})},clear_fields:function(){var d=this;if(true==d.options.clear_fields){d.fields_to_clear=d.element.find("input:text, textarea").clear_field()}},show:function(){if(!this.element.is(":visible")){this.element.fadeIn()}},hide:function(){if(this.element.is(":visible")){this.element.fadeOut()}}};a.widget("ui.virtual_form",b)})(jQuery);(function(a){a.widget("ui.xhrVerifyField",{options:{form:null,values:{},link_text:"Verify Field",link_markup:'<span class="button"><span><input type="submit" name="check" value="{link_text}"></span></span>',error_class:"error_list",loading_image:"/images/ajax-loader.gif",success_image:"/images/silk_icons/accept.png"},_create:function(){this._link=a(a.nano(this.options.link_markup,{link_text:this.options.link_text})).insertAfter(this.element.get(0)).bind("click",this,function(b){b.preventDefault();b.data.verify()});this._loading_indicator=a(a.nano('<img alt="loading..." src="{src}"/>',{src:this.options.loading_image})).insertAfter(this._link).hide();this._success_indicator=a(a.nano('<img alt="verified" src="{src}"/>',{src:this.options.success_image})).insertAfter(this._link).hide();this._findErrorElement()},_findErrorElement:function(){if(!this._error_element){this._error_element=a(this.element).parent().next("."+this.options.error_class);if(this._error_element.length==0){this._error_element=a("<ul />").attr("style","display:none").addClass(this.options.error_class).insertAfter(a(this.element.parent()))}}},verify:function(){this._error_element.hide();this._success_indicator.hide();this._loading_indicator.show();var d=a.extend({},this.options.values,{name:this.element.val()});var e={tedx_group:d};var b=this;jQuery.ajax({type:"get",url:this.options.url,dataType:"json",data:a.param(e),success:function(g,f){b.displaySucess(g,f)},error:function(g,f,h){b.displayError(g,f,h)}})},displayError:function(d,b,e){this._loading_indicator.hide();if(b!="error"){var f=this._error_element.empty();a(e).each(function(){a(a.nano("<li>{error}</li>",{error:this})).appendTo(f)});this._error_element.show();this._error_element.parent().addClass("error")}else{}},displaySucess:function(d,b){this._loading_indicator.hide();if(d.status!="success"){this.displayError(d,b,d.error)}else{this._error_element.parent().removeClass("error");this._success_indicator.show()}}})})(jQuery);ted=window.ted||{};if(ted.baseUrl===undefined){ted.baseUrl="//assets.tedcdn.com"}jQuery(function(a){a("#newsletterSignup_email_address, #search input[name=q]").clear_field();a(".tedcred, .flair, .tip").tooltip({showURL:false,extraClass:"tip"})});jQuery(function(e){var b=[{re:/^https?:\/\/(?:.*\.)tedprize\.org(.*)/,cat:"ted prize"},{re:/^https?:\/\/ed\.ted\.com(.*)/,cat:"ted ed"},{re:/^https?:\/\/tedfellows\.posterous\.com(.*)/,cat:"ted fellows blog"},{re:/^https?:\/\/(?:.*\.)universalsubtitles\.org(.*)/,cat:"translator dashboard"},{re:/^https?:\/\/(?:.*\.)feedburner\.com(.*)/,cat:"rss feed"},{re:/^https?:\/\//,cat:"other"}],d=b.length,a=e.beaconWrap(e.noop);function f(g){for(var h=-1;++h<d;){if(g.match(b[h].re)){return b[h].cat}}}e("body").on("click","a[href]",function(j){var h=e(this).attr("href"),g=f(h);if(!g){return true}e.GA_trackEvent("outbound click",g,h);return a.call(this,j)})});jQuery(function(h){var j,b=["http://www.surveywriter.net/in/survey/survey860/ted005.asp?data=",encodeURIComponent(window.location.href),"~~uri~1&data=",(window.ted.loggedIn?"1":"0"),"~~login~2"].join(""),g=h(["<div class=slideup>","<div class=slideup-main>","Please take this short survey to share your thoughts!","<a class='slideup-btn slideup-toggle' href="+b+">Not now</a>","<a class='slideup-btn slideup-action' href="+b+" target=_blank>Start survey</a>","</div>","<div class=slideup-tab>","<a class='slideup-tab-link slideup-toggle' href=#>","Help us improve TED.com","<span class=slideup-tab-logo></span>","</a>","<a class='slideup-tab-hide slideup-kill' href=# title='Close this popup and never show it again.'></a>","</div>","</div>"].join("")),f=g.find("div.slideup-main"),m=g.find("div.slideup-tab"),o=document.getElementsByTagName("head"),l=document.createElement("link"),k=ted.baseUrl+"/css/reboot/slideup.css",e=h.cookie("slideup"),d=new Date();function n(){a("0");g.children().fadeOut().promise().done(function(){g.remove()});return false}function a(q){h.cookie("slideup",q,{expires:90})}if(window.location.hostname&&!window.location.hostname.match(/^(dev|www)?\.?ted\.com/)){return}if(window.location.href.match(/\.php/)){return}if(d<new Date(2012,11,22)||d>new Date(2012,11,24)){return}if(document.documentElement.clientWidth<=900){return}if(e==="0"){return}if(e===null){j=Math.random()*100/15|0;if(j!==1){a("0");return}a("1")}if(!o||!o.length){return}o=o[0];l.setAttribute("rel","stylesheet");l.setAttribute("type","text/css");l.setAttribute("href",k);o.appendChild(l);f.hide();g.find("a.slideup-toggle").click(function(){f[f.is(":visible")?"slideUp":"slideDown"](200);return false});g.find("a.slideup-kill").on("click",n);m.hide();g.appendTo("body");window.setTimeout(function(){m.fadeIn("slow");window.setTimeout(function(){if(!f.is(":visible")){f.slideDown(500)}},1000)},1000*3)});